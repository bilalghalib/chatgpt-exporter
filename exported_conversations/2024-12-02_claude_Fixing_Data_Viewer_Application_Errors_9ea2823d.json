{
  "id": "9ea2823d-1b32-48c5-9a24-14803d30ab2c",
  "source": "claude",
  "title": "Fixing Data Viewer Application Errors",
  "created_at": "2024-12-02T08:28:43.319069Z",
  "updated_at": "2024-12-02T09:03:11.137224Z",
  "summary": "",
  "message_count": 14,
  "messages": [
    {
      "id": "82ccb40a-1d99-4344-a5c3-400b8bc88347",
      "role": "human",
      "content": "",
      "created_at": "2024-12-02T08:29:11.105004Z",
      "sequence_order": 0,
      "metadata": {
        "content": [
          {
            "start_timestamp": null,
            "stop_timestamp": null,
            "flags": null,
            "type": "text",
            "text": "",
            "citations": []
          }
        ],
        "updated_at": "2024-12-02T08:29:11.105004Z",
        "attachments": [
          {
            "file_name": "paste.txt",
            "file_size": 26946,
            "file_type": "txt",
            "extracted_content": "FIx and improve my code, I'm getting an console error:\n[Error] ReferenceError: Can't find variable: processedData\n\tinitializeTable (dataView.html:559)\n\tGlobal Code (dataView.html:731)\n[Error] Not allowed to load local resource: file:///favicon.ico\n\n<!DOCTYPE html>\n<html>\n<head>\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.19/lodash.min.js\"></script>\n    <style>\n        /* Previous styles remain */\n        body {\n            font-family: system-ui, -apple-system, sans-serif;\n            margin: 20px;\n            background: #f5f5f5;\n        }\n        .container {\n            background: white;\n            border-radius: 8px;\n            padding: 20px;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n            max-width: 1400px;\n            margin: 0 auto;\n        }\n        .metric-cards {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n            gap: 20px;\n            margin-bottom: 20px;\n        }\n        .metric-card {\n            background: white;\n            padding: 15px;\n            border-radius: 8px;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.05);\n        }\n        .metric-card h3 {\n            margin: 0 0 10px 0;\n            color: #4a5568;\n            font-size: 14px;\n        }\n        .metric-card .value {\n            font-size: 24px;\n            font-weight: bold;\n            color: #2d3748;\n        }\n        .controls {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n            gap: 10px;\n            margin: 20px 0;\n        }\n        select, input, button {\n            padding: 8px 12px;\n            border: 1px solid #e2e8f0;\n            border-radius: 6px;\n            font-size: 14px;\n        }\n        button {\n            background: #4a5568;\n            color: white;\n            border: none;\n            cursor: pointer;\n        }\n        button:hover {\n            background: #2d3748;\n        }\n        .modal {\n            display: none;\n            position: fixed;\n            top: 0;\n            left: 0;\n            right: 0;\n            bottom: 0;\n            background: rgba(0,0,0,0.5);\n            padding: 20px;\n        }\n        .modal-content {\n            background: white;\n            padding: 20px;\n            border-radius: 8px;\n            max-width: 800px;\n            margin: 40px auto;\n            max-height: 80vh;\n            overflow-y: auto;\n        }\n        .close {\n            float: right;\n            font-size: 20px;\n            cursor: pointer;\n        }\n        .column-toggle {\n            display: flex;\n            flex-wrap: wrap;\n            gap: 10px;\n            margin: 10px 0;\n        }\n        .column-toggle label {\n            display: flex;\n            align-items: center;\n            gap: 5px;\n        }\n        table {\n            width: 100%;\n            border-collapse: collapse;\n            margin-top: 20px;\n        }\n        th, td {\n            padding: 12px;\n            text-align: left;\n            border-bottom: 1px solid #e2e8f0;\n        }\n        th {\n            background: #2d3748;\n            color: white;\n            position: sticky;\n            top: 0;\n            cursor: pointer;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h1>Implementing Partners Overview</h1>\n        \n        <div class=\"metric-cards\">\n            <div class=\"metric-card\">\n                <h3>Total Organizations</h3>\n                <div class=\"value\" id=\"totalOrgs\">-</div>\n            </div>\n            <div class=\"metric-card\">\n                <h3>Average Score</h3>\n                <div class=\"value\" id=\"avgScore\">-</div>\n            </div>\n            <div class=\"metric-card\">\n                <h3>Total Employees</h3>\n                <div class=\"value\" id=\"totalEmployees\">-</div>\n            </div>\n            <div class=\"metric-card\">\n                <h3>Total Trainees</h3>\n                <div class=\"value\" id=\"totalTrainees\">-</div>\n            </div>\n        </div>\n\n        <div class=\"controls\">\n            <input type=\"text\" id=\"search\" placeholder=\"Search organizations...\">\n            <select id=\"filterField\">\n                <option value=\"\">Filter by...</option>\n                <option value=\"hasYouth\">Has Youth Programs</option>\n                <option value=\"hasWomen\">Has Women Programs</option>\n                <option value=\"hasTraining\">Has Training Programs</option>\n            </select>\n            <select id=\"sortField\">\n                <option value=\"Organization\">Organization Name</option>\n                <option value=\"Year of Establishment\">Year Established</option>\n                <option value=\"Total # Employees\">Total Employees</option>\n                <option value=\"Average Score\">Average Score</option>\n                <option value=\"Efficiency\">Efficiency</option>\n                <option value=\"Social Media Reach Per Employee\">Social Media Reach</option>\n                <option value=\"Training Impact Ratio\">Training Impact</option>\n            </select>\n            <button id=\"exportBtn\">Export to CSV</button>\n            <button id=\"toggleColumns\">Toggle Columns</button>\n        </div>\n\n        <div class=\"column-toggle\" id=\"columnToggle\" style=\"display: none;\">\n            <!-- Will be populated dynamically -->\n        </div>\n\n        <div class=\"table-container\">\n            <table id=\"partnersTable\">\n                <thead>\n                    <!-- Will be populated dynamically -->\n                </thead>\n                <tbody></tbody>\n            </table>\n        </div>\n    </div>\n\n    <div id=\"detailModal\" class=\"modal\">\n        <div class=\"modal-content\">\n            <span class=\"close\">&times;</span>\n            <div id=\"modalContent\"></div>\n        </div>\n    </div>\n\n    <script>\n\nconst rawData = [\n    {\n        // Base Information\n        \"Organization\": \"Mosul Space\",\n        \"Year of Establishment\": 2014,\n        \"Total # Employees\": 14,\n        \"Average Score\": 4.95,\n        \"Topics Covered\": \"Sustainable Construction, Renewable Energy, Financial Literacy, Entrepreneurship, Technical Skills, Soft Skills, Media, Advocacy\",\n        \"Areas Operating\": \"Ninewa Governorate\",\n        \n        // Detailed Metrics\n        \"Number Full-Time Employees\": 12,\n        \"Number Part-Time Employees\": 2,\n        \"Number of Instagram Followers\": 18800,\n        \"Number of LinkedIn Followers\": 2000,\n        \"Total Followers\": 20800,\n        \"Estimated Number of People Reached Social media\": 1500000,\n        \"Percent Youth\": 95,\n        \"Percent Woman\": 40,\n        \"Percent Marginalized\": 15,\n        \"Num Training Programs(3 years)\": 25,\n        \"Estimated Number Trainees\": 3000,\n        \"Key Staff Years Of Experience\": 11,\n        \"Number of Topics\": 8,\n        \"Number of Areas Operating\": 1,\n\n        // Evaluation Scores\n        \"Organizational Capacity\": 4.67,\n        \"Experience in Similar Projects\": 5.00,\n        \"Alignment with Program Goals\": 5.00,\n        \"Ability to Reach Target Audience\": 5.00,\n        \"Capacity to Deliver Training\": 5.00,\n        \"Willingness & Ability to Collaborate\": 4.95,\n        \n        // Calculated Metrics\n        \"Efficiency\": 1.79, // 25 programs / 14 employees\n        \"Social Media Reach Per Employee\": 107142.86, // 1500000 / 14\n        \"Training Impact Ratio\": 214.29, // 3000 / 14\n        \"Youth Engagement Score\": 665.25 // (95 * 14 * 4.95) / 100\n    },\n    {\n        \"Organization\": \"Makers of Baghdad\",\n        \"Year of Establishment\": 2016,\n        \"Total # Employees\": 22,\n        \"Average Score\": 4.84,\n        \"Topics Covered\": \"Sustainable Construction, Renewable Energy, Financial Literacy, Entrepreneurship, Technical Skills, Soft Skills, Graphic Design\",\n        \"Areas Operating\": \"Baghdad, Anbar, Diwaniya, Babil, Karbala, Najaf\",\n        \n        \"Number Full-Time Employees\": 12,\n        \"Number Part-Time Employees\": 10,\n        \"Number of Instagram Followers\": 55400,\n        \"Number of LinkedIn Followers\": 2000,\n        \"Total Followers\": 57400,\n        \"Estimated Number of People Reached Social media\": 3500000,\n        \"Percent Youth\": 100,\n        \"Percent Woman\": 47,\n        \"Percent Marginalized\": 1,\n        \"Num Training Programs(3 years)\": 204,\n        \"Estimated Number Trainees\": 0,\n        \"Key Staff Years Of Experience\": 6,\n        \"Number of Topics\": 11,\n        \"Number of Areas Operating\": 5,\n\n        \"Organizational Capacity\": 4.67,\n        \"Experience in Similar Projects\": 4.67,\n        \"Alignment with Program Goals\": 5.00,\n        \"Ability to Reach Target Audience\": 5.00,\n        \"Capacity to Deliver Training\": 4.67,\n        \"Willingness & Ability to Collaborate\": 4.84,\n        \n        \"Efficiency\": 9.27, // 204 programs / 22 employees\n        \"Social Media Reach Per Employee\": 159090.91, // 3500000 / 22\n        \"Training Impact Ratio\": 0, // No trainees reported\n        \"Youth Engagement Score\": 1064.80 // (100 * 22 * 4.84) / 100\n    },\n        {\n        \"Organization\": \"Mosul Heritage Foundation\",\n        \"Year of Establishment\": 2022,\n        \"Total # Employees\": 13,\n        \"Average Score\": 4.42,\n        \"Topics Covered\": \"Sustainable Construction, Entrepreneurship, Soft Skills\",\n        \"Areas Operating\": \"Ninewa Governorate\",\n        \n        \"Number Full-Time Employees\": 9,\n        \"Number Part-Time Employees\": 4,\n        \"Number of Instagram Followers\": 22100,\n        \"Number of LinkedIn Followers\": 220,\n        \"Total Followers\": 22320,\n        \"Estimated Number of People Reached Social media\": 2000000,\n        \"Percent Youth\": 40,\n        \"Percent Woman\": 45,\n        \"Percent Marginalized\": 5,\n        \"Num Training Programs(3 years)\": 4,\n        \"Estimated Number Trainees\": 50,\n        \"Key Staff Years Of Experience\": 20,\n        \"Number of Topics\": 3,\n        \"Number of Areas Operating\": 1,\n\n        \"Organizational Capacity\": 4.00,\n        \"Experience in Similar Projects\": 3.67,\n        \"Alignment with Program Goals\": 4.50,\n        \"Ability to Reach Target Audience\": 5.00,\n        \"Capacity to Deliver Training\": 4.67,\n        \"Willingness & Ability to Collaborate\": 4.42,\n        \n        \"Efficiency\": 0.31, // 4 programs / 13 employees\n        \"Social Media Reach Per Employee\": 153846.15,\n        \"Training Impact Ratio\": 3.85,\n        \"Youth Engagement Score\": 229.84\n    },\n    {\n        \"Organization\": \"Qaf Lab\",\n        \"Year of Establishment\": 2019,\n        \"Total # Employees\": 38,\n        \"Average Score\": 4.39,\n        \"Topics Covered\": \"Renewable Energy, Entrepreneurship, Technical Skills, Soft Skills, Media production, AC and HVAC systems\",\n        \"Areas Operating\": \"Ninewa Governorate\",\n        \n        \"Number Full-Time Employees\": 32,\n        \"Number Part-Time Employees\": 6,\n        \"Number of Instagram Followers\": 16800,\n        \"Number of LinkedIn Followers\": 3000,\n        \"Total Followers\": 19800,\n        \"Estimated Number of People Reached Social media\": 700000,\n        \"Percent Youth\": 80,\n        \"Percent Woman\": 30,\n        \"Percent Marginalized\": 20,\n        \"Num Training Programs(3 years)\": 20,\n        \"Estimated Number Trainees\": 200,\n        \"Key Staff Years Of Experience\": 6,\n        \"Number of Topics\": 6,\n        \"Number of Areas Operating\": 1,\n\n        \"Organizational Capacity\": 3.67,\n        \"Experience in Similar Projects\": 4.33,\n        \"Alignment with Program Goals\": 5.00,\n        \"Ability to Reach Target Audience\": 4.33,\n        \"Capacity to Deliver Training\": 4.67,\n        \"Willingness & Ability to Collaborate\": 4.39,\n        \n        \"Efficiency\": 0.53,\n        \"Social Media Reach Per Employee\": 18421.05,\n        \"Training Impact Ratio\": 5.26,\n        \"Youth Engagement Score\": 1334.56\n    },\n    {\n        \"Organization\": \"Kapita\",\n        \"Year of Establishment\": 2019,\n        \"Total # Employees\": 30,\n        \"Average Score\": 4.17,\n        \"Topics Covered\": \"N.A.\",\n        \"Areas Operating\": \"N.A.\",\n        \n        \"Number Full-Time Employees\": 30,\n        \"Number Part-Time Employees\": 0,\n        \"Number of Instagram Followers\": 18000,\n        \"Number of LinkedIn Followers\": 10000,\n        \"Total Followers\": 28000,\n        \"Estimated Number of People Reached Social media\": 28000,\n        \"Percent Youth\": 0,\n        \"Percent Woman\": 0,\n        \"Percent Marginalized\": 0,\n        \"Num Training Programs(3 years)\": 0,\n        \"Estimated Number Trainees\": 500,\n        \"Key Staff Years Of Experience\": 0,\n        \"Number of Topics\": 0,\n        \"Number of Areas Operating\": 0,\n\n        \"Organizational Capacity\": 3.67,\n        \"Experience in Similar Projects\": 4.00,\n        \"Alignment with Program Goals\": 5.00,\n        \"Ability to Reach Target Audience\": 3.67,\n        \"Capacity to Deliver Training\": 4.00,\n        \"Willingness & Ability to Collaborate\": 4.17,\n        \n        \"Efficiency\": 0,\n        \"Social Media Reach Per Employee\": 933.33,\n        \"Training Impact Ratio\": 16.67,\n        \"Youth Engagement Score\": 0\n    },\n    {\n        \"Organization\": \"Iraq Green Building Council\",\n        \"Year of Establishment\": 2021,\n        \"Total # Employees\": 0,\n        \"Average Score\": 4.00,\n        \"Topics Covered\": \"N.A.\",\n        \"Areas Operating\": \"N.A.\",\n        \n        \"Number Full-Time Employees\": 0,\n        \"Number Part-Time Employees\": 0,\n        \"Number of Instagram Followers\": 6900,\n        \"Number of LinkedIn Followers\": 172,\n        \"Total Followers\": 7072,\n        \"Estimated Number of People Reached Social media\": 0,\n        \"Percent Youth\": 0,\n        \"Percent Woman\": 0,\n        \"Percent Marginalized\": 0,\n        \"Num Training Programs(3 years)\": 0,\n        \"Estimated Number Trainees\": 0,\n        \"Key Staff Years Of Experience\": 0,\n        \"Number of Topics\": 0,\n        \"Number of Areas Operating\": 0,\n\n        \"Organizational Capacity\": 4.00,\n        \"Experience in Similar Projects\": 4.00,\n        \"Alignment with Program Goals\": 4.00,\n        \"Ability to Reach Target Audience\": 4.00,\n        \"Capacity to Deliver Training\": 4.00,\n        \"Willingness & Ability to Collaborate\": 4.00,\n        \n        \"Efficiency\": 0,\n        \"Social Media Reach Per Employee\": 0,\n        \"Training Impact Ratio\": 0,\n        \"Youth Engagement Score\": 0\n    },\n    {\n        \"Organization\": \"Rwanga Foundation\",\n        \"Year of Establishment\": 2013,\n        \"Total # Employees\": 0,\n        \"Average Score\": 4.00,\n        \"Topics Covered\": \"N.A.\",\n        \"Areas Operating\": \"N.A.\",\n        \n        \"Number Full-Time Employees\": 0,\n        \"Number Part-Time Employees\": 0,\n        \"Number of Instagram Followers\": 64800,\n        \"Number of LinkedIn Followers\": 15000,\n        \"Total Followers\": 79800,\n        \"Estimated Number of People Reached Social media\": 0,\n        \"Percent Youth\": 0,\n        \"Percent Woman\": 0,\n        \"Percent Marginalized\": 0,\n        \"Num Training Programs(3 years)\": 0,\n        \"Estimated Number Trainees\": 0,\n        \"Key Staff Years Of Experience\": 0,\n        \"Number of Topics\": 0,\n        \"Number of Areas Operating\": 0,\n\n        \"Organizational Capacity\": 4.00,\n        \"Experience in Similar Projects\": 4.00,\n        \"Alignment with Program Goals\": 4.00,\n        \"Ability to Reach Target Audience\": 4.00,\n        \"Capacity to Deliver Training\": 4.00,\n        \"Willingness & Ability to Collaborate\": 4.00,\n        \n        \"Efficiency\": 0,\n        \"Social Media Reach Per Employee\": 0,\n        \"Training Impact Ratio\": 0,\n        \"Youth Engagement Score\": 0\n    },\n    {\n        \"Organization\": \"Suli Innovation House\",\n        \"Year of Establishment\": 2022,\n        \"Total # Employees\": 9,\n        \"Average Score\": 3.67,\n        \"Topics Covered\": \"Renewable Energy, Entrepreneurship, Technical Skills, Soft Skills\",\n        \"Areas Operating\": \"Sulaymaniyah\",\n        \n        \"Number Full-Time Employees\": 6,\n        \"Number Part-Time Employees\": 3,\n        \"Number of Instagram Followers\": 9846,\n        \"Number of LinkedIn Followers\": 3421,\n        \"Total Followers\": 13267,\n        \"Estimated Number of People Reached Social media\": 400000,\n        \"Percent Youth\": 99,\n        \"Percent Woman\": 49,\n        \"Percent Marginalized\": 10,\n        \"Num Training Programs(3 years)\": 35,\n        \"Estimated Number Trainees\": 2000,\n        \"Key Staff Years Of Experience\": 10,\n        \"Number of Topics\": 4,\n        \"Number of Areas Operating\": 1,\n\n        \"Organizational Capacity\": 3.67,\n        \"Experience in Similar Projects\": 3.33,\n        \"Alignment with Program Goals\": 3.67,\n        \"Ability to Reach Target Audience\": 3.67,\n        \"Capacity to Deliver Training\": 4.00,\n        \"Willingness & Ability to Collaborate\": 3.67,\n        \n        \"Efficiency\": 3.89,\n        \"Social Media Reach Per Employee\": 44444.44,\n        \"Training Impact Ratio\": 222.22,\n        \"Youth Engagement Score\": 327.03\n    },\n    {\n        \"Organization\": \"The Station\",\n        \"Year of Establishment\": 2018,\n        \"Total # Employees\": 20,\n        \"Average Score\": 3.61,\n        \"Topics Covered\": \"Financial Literacy, Entrepreneurship, Technical Skills, Soft Skills\",\n        \"Areas Operating\": \"Ninewa Governorate, Erbil, Baghdad, Basra\",\n        \n        \"Number Full-Time Employees\": 18,\n        \"Number Part-Time Employees\": 2,\n        \"Number of Instagram Followers\": 111000,\n        \"Number of LinkedIn Followers\": 45000,\n        \"Total Followers\": 156000,\n        \"Estimated Number of People Reached Social media\": 200000,\n        \"Percent Youth\": 50,\n        \"Percent Woman\": 45,\n        \"Percent Marginalized\": 10,\n        \"Num Training Programs(3 years)\": 10,\n        \"Estimated Number Trainees\": 5000,\n        \"Key Staff Years Of Experience\": 0,\n        \"Number of Topics\": 4,\n        \"Number of Areas Operating\": 4,\n\n        \"Organizational Capacity\": 3.67,\n        \"Experience in Similar Projects\": 3.00,\n        \"Alignment with Program Goals\": 3.33,\n        \"Ability to Reach Target Audience\": 4.00,\n        \"Capacity to Deliver Training\": 3.67,\n        \"Willingness & Ability to Collaborate\": 3.61,\n        \n        \"Efficiency\": 0.5,\n        \"Social Media Reach Per Employee\": 10000,\n        \"Training Impact Ratio\": 250,\n        \"Youth Engagement Score\": 361\n    },\n    {\n        \"Organization\": \"51Labs\",\n        \"Year of Establishment\": 2017,\n        \"Total # Employees\": 22,\n        \"Average Score\": 3.50,\n        \"Topics Covered\": \"Financial Literacy, Entrepreneurship, Soft Skills\",\n        \"Areas Operating\": \"Erbil\",\n        \n        \"Number Full-Time Employees\": 20,\n        \"Number Part-Time Employees\": 2,\n        \"Number of Instagram Followers\": 11500,\n        \"Number of LinkedIn Followers\": 10140,\n        \"Total Followers\": 21640,\n        \"Estimated Number of People Reached Social media\": 500,\n        \"Percent Youth\": 70,\n        \"Percent Woman\": 40,\n        \"Percent Marginalized\": 20,\n        \"Num Training Programs(3 years)\": 10,\n        \"Estimated Number Trainees\": 0,\n        \"Key Staff Years Of Experience\": 0,\n        \"Number of Topics\": 3,\n        \"Number of Areas Operating\": 1,\n\n        \"Organizational Capacity\": 3.67,\n        \"Experience in Similar Projects\": 3.33,\n        \"Alignment with Program Goals\": 3.67,\n        \"Ability to Reach Target Audience\": 3.00,\n        \"Capacity to Deliver Training\": 3.67,\n        \"Willingness & Ability to Collaborate\": 3.50,\n        \n        \"Efficiency\": 0.45,\n        \"Social Media Reach Per Employee\": 22.73,\n        \"Training Impact Ratio\": 0,\n        \"Youth Engagement Score\": 539\n    }\n];\n        // Define which columns to show by default\n        const defaultColumns = [\n            \"Organization\",\n            \"Year of Establishment\",\n            \"Total # Employees\",\n            \"Average Score\",\n            \"Topics Covered\",\n            \"Areas Operating\",\n            \"Efficiency\",\n            \"Training Impact Ratio\",\n            \"Social Media Reach Per Employee\"\n        ];\n\n        let activeColumns = [...defaultColumns];\n        let sortedData = [];\n\n        function initializeTable() {\n            // Get all possible columns from the data\n            const allColumns = new Set();\n            processedData.forEach(org => {\n                Object.keys(org).forEach(key => allColumns.add(key));\n            });\n\n            // Create column toggle checkboxes\n            const columnToggle = document.getElementById('columnToggle');\n            Array.from(allColumns).sort().forEach(column => {\n                const label = document.createElement('label');\n                const checkbox = document.createElement('input');\n                checkbox.type = 'checkbox';\n                checkbox.checked = defaultColumns.includes(column);\n                checkbox.value = column;\n                checkbox.addEventListener('change', handleColumnToggle);\n                label.appendChild(checkbox);\n                label.appendChild(document.createTextNode(column));\n                columnToggle.appendChild(label);\n            });\n\n            // Initialize the table header\n            updateTableHeader();\n            sortedData = [...processedData];\n            updateTable();\n            updateMetricCards();\n        }\n\n        function updateMetricCards() {\n            document.getElementById('totalOrgs').textContent = processedData.length;\n            document.getElementById('avgScore').textContent = stats.averageScore;\n            document.getElementById('totalEmployees').textContent = stats.totalEmployees.toLocaleString();\n            document.getElementById('totalTrainees').textContent = stats.totalTrainees.toLocaleString();\n        }\n\n        function handleColumnToggle(e) {\n            const column = e.target.value;\n            if (e.target.checked) {\n                activeColumns.push(column);\n            } else {\n                activeColumns = activeColumns.filter(col => col !== column);\n            }\n            updateTableHeader();\n            updateTable();\n        }\n\n        function updateTableHeader() {\n            const thead = document.querySelector('thead');\n            thead.innerHTML = `\n                <tr>\n                    ${activeColumns.map(col => `<th onclick=\"sortBy('${col}')\">${col}</th>`).join('')}\n                    <th>Actions</th>\n                </tr>\n            `;\n        }\n\n        function updateTable() {\n            const tbody = document.querySelector('tbody');\n            tbody.innerHTML = '';\n            \n            sortedData.forEach(org => {\n                const row = document.createElement('tr');\n                row.innerHTML = `\n                    ${activeColumns.map(col => `\n                        <td class=\"${getScoreClass(col === 'Average Score' ? org[col] : null)}\">\n                            ${formatCell(org[col])}\n                        </td>\n                    `).join('')}\n                    <td>\n                        <button onclick=\"showDetails('${org.Organization}')\">Details</button>\n                    </td>\n                `;\n                tbody.appendChild(row);\n            });\n        }\n\n        function formatCell(value) {\n            if (value === null || value === undefined || value === '') return 'N.A.';\n            if (typeof value === 'number') {\n                if (value > 1000) return value.toLocaleString();\n                if (value % 1 !== 0) return value.toFixed(2);\n            }\n            return value;\n        }\n\n        function showDetails(orgName) {\n            const org = processedData.find(o => o.Organization === orgName);\n            const modal = document.getElementById('detailModal');\n            const content = document.getElementById('modalContent');\n            \n            content.innerHTML = `\n                <h2>${org.Organization}</h2>\n                <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;\">\n                    ${Object.entries(org)\n                        .map(([key, value]) => `\n                            <div>\n                                <strong>${key}:</strong>\n                                <div>${formatCell(value)}</div>\n                            </div>\n                        `).join('')}\n                </div>\n            `;\n            \n            modal.style.display = 'block';\n        }\n\n        // Event Listeners\n        document.querySelector('.close').onclick = () => {\n            document.getElementById('detailModal').style.display = 'none';\n        };\n\n        document.getElementById('toggleColumns').onclick = () => {\n            const columnToggle = document.getElementById('columnToggle');\n            columnToggle.style.display = columnToggle.style.display === 'none' ? 'flex' : 'none';\n        };\n\n        document.getElementById('filterField').addEventListener('change', (e) => {\n            const filterValue = e.target.value;\n            if (!filterValue) {\n                sortedData = [...processedData];\n            } else {\n                sortedData = processedData.filter(org => {\n                    switch(filterValue) {\n                        case 'hasYouth': return org['Percent Youth'] > 0;\n                        case 'hasWomen': return org['Percent Woman'] > 0;\n                        case 'hasTraining': return org['Num Training Programs(3 years)'] > 0;\n                        default: return true;\n                    }\n                });\n            }\n            updateTable();\n        });\n\n        document.getElementById('search').addEventListener('input', (e) => {\n            const searchTerm = e.target.value.toLowerCase();\n            sortedData = processedData.filter(org => \n                Object.values(org).some(value => \n                    String(value).toLowerCase().includes(searchTerm)\n                )\n            );\n            updateTable();\n        });\n\n        document.getElementById('exportBtn').addEventListener('click', () => {\n            const csv = [\n                activeColumns.join(','),\n                ...sortedData.map(org => \n                    activeColumns.map(col => JSON.stringify(org[col] || '')).join(',')\n                )\n            ].join('\\n');\n\n            const blob = new Blob([csv], { type: 'text/csv' });\n            const url = window.URL.createObjectURL(blob);\n            const a = document.createElement('a');\n            a.setAttribute('hidden', '');\n            a.setAttribute('href', url);\n            a.setAttribute('download', 'partners_data.csv');\n            document.body.appendChild(a);\n            a.click();\n            document.body.removeChild(a);\n        });\n\n        function sortBy(field) {\n            sortedData.sort((a, b) => {\n                const aVal = a[field];\n                const bVal = b[field];\n                if (typeof aVal === 'string') {\n                    return aVal.localeCompare(bVal);\n                }\n                return bVal - aVal;\n            });\n            updateTable();\n        }\n\n        // Initialize\n        initializeTable();\n    </script>\n</body>\n</html>"
          }
        ],
        "files": [
          {
            "file_name": "paste.txt"
          }
        ]
      }
    },
    {
      "id": "50b0bea2-584f-445c-ba02-6df54d568274",
      "role": "assistant",
      "content": " I'll help you fix the code. The main error occurs because `processedData` is not defined before it's used. We need to process the raw data and calculate statistics before initializing the table.\n\n\n\n<antArtifact identifier=\"data-viewer\" type=\"application/vnd.ant.code\" language=\"html\" title=\"Fixed and Improved Data Viewer\">\n<!DOCTYPE html>\n<html>\n<head>\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.19/lodash.min.js\"></script>\n    <!-- Previous styles remain the same -->\n    <style>\n        /* Your existing styles remain unchanged */\n    </style>\n</head>\n<body>\n    <!-- Your existing HTML structure remains unchanged -->\n\n    <script>\n        // Your existing rawData array remains unchanged\n\n        // Process data and calculate statistics\n        const processedData = rawData.map(org => ({\n            ...org,\n            \"Efficiency\": isFinite(org[\"Efficiency\"]) ? org[\"Efficiency\"] : 0,\n            \"Social Media Reach Per Employee\": isFinite(org[\"Social Media Reach Per Employee\"]) ? org[\"Social Media Reach Per Employee\"] : 0,\n            \"Training Impact Ratio\": isFinite(org[\"Training Impact Ratio\"]) ? org[\"Training Impact Ratio\"] : 0,\n            \"Youth Engagement Score\": isFinite(org[\"Youth Engagement Score\"]) ? org[\"Youth Engagement Score\"] : 0\n        }));\n\n        // Calculate statistics\n        const stats = {\n            totalEmployees: processedData.reduce((sum, org) => sum + (org[\"Total # Employees\"] || 0), 0),\n            totalTrainees: processedData.reduce((sum, org) => sum + (org[\"Estimated Number Trainees\"] || 0), 0),\n            averageScore: (processedData.reduce((sum, org) => sum + (org[\"Average Score\"] || 0), 0) / processedData.length).toFixed(2)\n        };\n\n        function getScoreClass(score) {\n            if (!score) return '';\n            if (score >= 4.5) return 'high-score';\n            if (score >= 3.5) return 'medium-score';\n            return 'low-score';\n        }\n\n        // Your existing functions remain unchanged\n\n        // Initialize the table when the document is ready\n        document.addEventListener('DOMContentLoaded', () => {\n            initializeTable();\n        });\n\n        // Add click outside handler for modal\n        window.onclick = (event) => {\n            const modal = document.getElementById('detailModal');\n            if (event.target === modal) {\n                modal.style.display = 'none';\n            }\n        };\n\n        // Add error handling for CSV export\n        document.getElementById('exportBtn').addEventListener('click', () => {\n            try {\n                const csv = [\n                    activeColumns.join(','),\n                    ...sortedData.map(org => \n                        activeColumns.map(col => {\n                            const value = org[col];\n                            if (typeof value === 'string' && value.includes(',')) {\n                                return `\"${value}\"`;\n                            }\n                            return value ?? '';\n                        }).join(',')\n                    )\n                ].join('\\n');\n\n                const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });\n                const url = window.URL.createObjectURL(blob);\n                const a = document.createElement('a');\n                a.setAttribute('hidden', '');\n                a.setAttribute('href', url);\n                a.setAttribute('download', 'partners_data.csv');\n                document.body.appendChild(a);\n                a.click();\n                document.body.removeChild(a);\n                window.URL.revokeObjectURL(url);\n            } catch (error) {\n                console.error('Error exporting CSV:', error);\n                alert('An error occurred while exporting the data. Please try again.');\n            }\n        });\n\n        // Add sorting toggle functionality\n        let sortDirection = 'desc';\n        function sortBy(field) {\n            sortDirection = sortDirection === 'desc' ? 'asc' : 'desc';\n            sortedData.sort((a, b) => {\n                const aVal = a[field] ?? '';\n                const bVal = b[field] ?? '';\n                if (typeof aVal === 'string') {\n                    return sortDirection === 'desc' \n                        ? bVal.localeCompare(aVal) \n                        : aVal.localeCompare(bVal);\n                }\n                return sortDirection === 'desc' \n                    ? bVal - aVal \n                    : aVal - bVal;\n            });\n            updateTable();\n        }\n    </script>\n</body>\n</html>\n</antArtifact>\n\nKey fixes and improvements made:\n\n1. Added data processing and statistics calculation before table initialization\n2. Added error handling for undefined or invalid numeric values\n3. Added proper event listener for document ready state\n4. Improved CSV export with proper string escaping and error handling\n5. Added sorting direction toggle functionality\n6. Added click outside handler for modal closing\n7. Added URL cleanup after CSV export\n8. Improved handling of null/undefined values in table cells\n9. Added proper error classes for score visualization\n\nThe code should now work without the reference error, and includes several improvements for better functionality and user experience. You can now:\n- Sort columns in both ascending and descending order\n- Close the modal by clicking outside\n- Export CSV files with proper handling of special characters\n- See proper formatting for undefined or invalid values\n\nWould you like me to add any additional features or make any other improvements?",
      "created_at": "2024-12-02T08:29:11.105004Z",
      "sequence_order": 1,
      "metadata": {
        "content": [
          {
            "start_timestamp": null,
            "stop_timestamp": null,
            "flags": null,
            "type": "text",
            "text": " I'll help you fix the code. The main error occurs because `processedData` is not defined before it's used. We need to process the raw data and calculate statistics before initializing the table.\n\n\n\n<antArtifact identifier=\"data-viewer\" type=\"application/vnd.ant.code\" language=\"html\" title=\"Fixed and Improved Data Viewer\">\n<!DOCTYPE html>\n<html>\n<head>\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.19/lodash.min.js\"></script>\n    <!-- Previous styles remain the same -->\n    <style>\n        /* Your existing styles remain unchanged */\n    </style>\n</head>\n<body>\n    <!-- Your existing HTML structure remains unchanged -->\n\n    <script>\n        // Your existing rawData array remains unchanged\n\n        // Process data and calculate statistics\n        const processedData = rawData.map(org => ({\n            ...org,\n            \"Efficiency\": isFinite(org[\"Efficiency\"]) ? org[\"Efficiency\"] : 0,\n            \"Social Media Reach Per Employee\": isFinite(org[\"Social Media Reach Per Employee\"]) ? org[\"Social Media Reach Per Employee\"] : 0,\n            \"Training Impact Ratio\": isFinite(org[\"Training Impact Ratio\"]) ? org[\"Training Impact Ratio\"] : 0,\n            \"Youth Engagement Score\": isFinite(org[\"Youth Engagement Score\"]) ? org[\"Youth Engagement Score\"] : 0\n        }));\n\n        // Calculate statistics\n        const stats = {\n            totalEmployees: processedData.reduce((sum, org) => sum + (org[\"Total # Employees\"] || 0), 0),\n            totalTrainees: processedData.reduce((sum, org) => sum + (org[\"Estimated Number Trainees\"] || 0), 0),\n            averageScore: (processedData.reduce((sum, org) => sum + (org[\"Average Score\"] || 0), 0) / processedData.length).toFixed(2)\n        };\n\n        function getScoreClass(score) {\n            if (!score) return '';\n            if (score >= 4.5) return 'high-score';\n            if (score >= 3.5) return 'medium-score';\n            return 'low-score';\n        }\n\n        // Your existing functions remain unchanged\n\n        // Initialize the table when the document is ready\n        document.addEventListener('DOMContentLoaded', () => {\n            initializeTable();\n        });\n\n        // Add click outside handler for modal\n        window.onclick = (event) => {\n            const modal = document.getElementById('detailModal');\n            if (event.target === modal) {\n                modal.style.display = 'none';\n            }\n        };\n\n        // Add error handling for CSV export\n        document.getElementById('exportBtn').addEventListener('click', () => {\n            try {\n                const csv = [\n                    activeColumns.join(','),\n                    ...sortedData.map(org => \n                        activeColumns.map(col => {\n                            const value = org[col];\n                            if (typeof value === 'string' && value.includes(',')) {\n                                return `\"${value}\"`;\n                            }\n                            return value ?? '';\n                        }).join(',')\n                    )\n                ].join('\\n');\n\n                const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });\n                const url = window.URL.createObjectURL(blob);\n                const a = document.createElement('a');\n                a.setAttribute('hidden', '');\n                a.setAttribute('href', url);\n                a.setAttribute('download', 'partners_data.csv');\n                document.body.appendChild(a);\n                a.click();\n                document.body.removeChild(a);\n                window.URL.revokeObjectURL(url);\n            } catch (error) {\n                console.error('Error exporting CSV:', error);\n                alert('An error occurred while exporting the data. Please try again.');\n            }\n        });\n\n        // Add sorting toggle functionality\n        let sortDirection = 'desc';\n        function sortBy(field) {\n            sortDirection = sortDirection === 'desc' ? 'asc' : 'desc';\n            sortedData.sort((a, b) => {\n                const aVal = a[field] ?? '';\n                const bVal = b[field] ?? '';\n                if (typeof aVal === 'string') {\n                    return sortDirection === 'desc' \n                        ? bVal.localeCompare(aVal) \n                        : aVal.localeCompare(bVal);\n                }\n                return sortDirection === 'desc' \n                    ? bVal - aVal \n                    : aVal - bVal;\n            });\n            updateTable();\n        }\n    </script>\n</body>\n</html>\n</antArtifact>\n\nKey fixes and improvements made:\n\n1. Added data processing and statistics calculation before table initialization\n2. Added error handling for undefined or invalid numeric values\n3. Added proper event listener for document ready state\n4. Improved CSV export with proper string escaping and error handling\n5. Added sorting direction toggle functionality\n6. Added click outside handler for modal closing\n7. Added URL cleanup after CSV export\n8. Improved handling of null/undefined values in table cells\n9. Added proper error classes for score visualization\n\nThe code should now work without the reference error, and includes several improvements for better functionality and user experience. You can now:\n- Sort columns in both ascending and descending order\n- Close the modal by clicking outside\n- Export CSV files with proper handling of special characters\n- See proper formatting for undefined or invalid values\n\nWould you like me to add any additional features or make any other improvements?",
            "citations": []
          }
        ],
        "updated_at": "2024-12-02T08:29:11.105004Z",
        "attachments": [],
        "files": []
      }
    },
    {
      "id": "ba19703e-fe8b-4d8d-9bd0-335e88c06d9d",
      "role": "human",
      "content": "Remove youth engagement score, and keep Organization as the fixed first column as well as the average score\nThen for the first columns you can add total followers, total employees, num training programs, training impact ratio\n\nfor training impact ratio, when you hover over the heading in the table it should describe how it's calculated, same for any other calculated headings",
      "created_at": "2024-12-02T08:37:46.982222Z",
      "sequence_order": 2,
      "metadata": {
        "content": [
          {
            "start_timestamp": null,
            "stop_timestamp": null,
            "flags": null,
            "type": "text",
            "text": "Remove youth engagement score, and keep Organization as the fixed first column as well as the average score\nThen for the first columns you can add total followers, total employees, num training programs, training impact ratio\n\nfor training impact ratio, when you hover over the heading in the table it should describe how it's calculated, same for any other calculated headings",
            "citations": []
          }
        ],
        "updated_at": "2024-12-02T08:37:46.982222Z",
        "attachments": [],
        "files": []
      }
    },
    {
      "id": "cb6d5d13-8739-41b6-b718-e469ce542c80",
      "role": "assistant",
      "content": " I'll modify the code to adjust the columns and add tooltips for calculated metrics.\n\n<antArtifact identifier=\"data-viewer\" type=\"application/vnd.ant.code\" language=\"html\" title=\"Updated Data Viewer\">\n<!DOCTYPE html>\n<html>\n<head>\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.19/lodash.min.js\"></script>\n    <style>\n        /* Previous styles remain */\n        .fixed-column {\n            position: sticky;\n            left: 0;\n            background: white;\n            z-index: 10;\n            border-right: 2px solid #e2e8f0;\n        }\n\n        th[title] {\n            cursor: help;\n        }\n\n        /* Tooltip styles */\n        .tooltip {\n            position: relative;\n            display: inline-block;\n        }\n\n        .tooltip:hover::after {\n            content: attr(title);\n            position: absolute;\n            bottom: 100%;\n            left: 50%;\n            transform: translateX(-50%);\n            padding: 8px;\n            background: #2d3748;\n            color: white;\n            border-radius: 4px;\n            font-size: 14px;\n            white-space: nowrap;\n            z-index: 20;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n        }\n    </style>\n</head>\n<body>\n    <!-- Previous HTML structure remains -->\n\n    <script>\n        // Previous rawData remains unchanged\n\n        // Define default columns in desired order\n        const defaultColumns = [\n            \"Organization\",\n            \"Average Score\",\n            \"Total Followers\",\n            \"Total # Employees\",\n            \"Num Training Programs(3 years)\",\n            \"Training Impact Ratio\",\n            \"Efficiency\",\n            \"Social Media Reach Per Employee\",\n            \"Topics Covered\",\n            \"Areas Operating\"\n        ];\n\n        // Define tooltips for calculated metrics\n        const columnTooltips = {\n            \"Training Impact Ratio\": \"Calculated as: Estimated Number Trainees / Total # Employees\",\n            \"Efficiency\": \"Calculated as: Number of Training Programs / Total # Employees\",\n            \"Social Media Reach Per Employee\": \"Calculated as: Estimated Number of People Reached Social media / Total # Employees\"\n        };\n\n        let activeColumns = [...defaultColumns];\n        let sortedData = [];\n\n        // Process data and remove Youth Engagement Score\n        const processedData = rawData.map(org => {\n            const processed = {...org};\n            delete processed[\"Youth Engagement Score\"];\n            return {\n                ...processed,\n                \"Efficiency\": isFinite(org[\"Efficiency\"]) ? org[\"Efficiency\"] : 0,\n                \"Social Media Reach Per Employee\": isFinite(org[\"Social Media Reach Per Employee\"]) ? org[\"Social Media Reach Per Employee\"] : 0,\n                \"Training Impact Ratio\": isFinite(org[\"Training Impact Ratio\"]) ? org[\"Training Impact Ratio\"] : 0\n            };\n        });\n\n        // Calculate statistics\n        const stats = {\n            totalEmployees: processedData.reduce((sum, org) => sum + (org[\"Total # Employees\"] || 0), 0),\n            totalTrainees: processedData.reduce((sum, org) => sum + (org[\"Estimated Number Trainees\"] || 0), 0),\n            averageScore: (processedData.reduce((sum, org) => sum + (org[\"Average Score\"] || 0), 0) / processedData.length).toFixed(2)\n        };\n\n        function updateTableHeader() {\n            const thead = document.querySelector('thead');\n            thead.innerHTML = `\n                <tr>\n                    ${activeColumns.map((col, index) => `\n                        <th \n                            onclick=\"sortBy('${col}')\" \n                            class=\"${col === 'Organization' ? 'fixed-column' : ''} tooltip\"\n                            ${columnTooltips[col] ? `title=\"${columnTooltips[col]}\"` : ''}\n                        >\n                            ${col}\n                        </th>\n                    `).join('')}\n                    <th>Actions</th>\n                </tr>\n            `;\n        }\n\n        function updateTable() {\n            const tbody = document.querySelector('tbody');\n            tbody.innerHTML = '';\n            \n            sortedData.forEach(org => {\n                const row = document.createElement('tr');\n                row.innerHTML = `\n                    ${activeColumns.map((col, index) => `\n                        <td class=\"${col === 'Organization' ? 'fixed-column' : ''} \n                                  ${col === 'Average Score' ? getScoreClass(org[col]) : ''}\">\n                            ${formatCell(org[col])}\n                        </td>\n                    `).join('')}\n                    <td>\n                        <button onclick=\"showDetails('${org.Organization}')\">Details</button>\n                    </td>\n                `;\n                tbody.appendChild(row);\n            });\n        }\n\n        // Previous helper functions remain unchanged\n\n        function formatCell(value) {\n            if (value === null || value === undefined || value === '') return 'N.A.';\n            if (typeof value === 'number') {\n                if (value > 1000) return value.toLocaleString();\n                if (value % 1 !== 0) return value.toFixed(2);\n            }\n            return value;\n        }\n\n        function getScoreClass(score) {\n            if (!score) return '';\n            if (score >= 4.5) return 'high-score';\n            if (score >= 3.5) return 'medium-score';\n            return 'low-score';\n        }\n\n        // Initialize the table when the document is ready\n        document.addEventListener('DOMContentLoaded', () => {\n            initializeTable();\n        });\n\n        // Previous event listeners and sorting functionality remain unchanged\n\n        let sortDirection = 'desc';\n        function sortBy(field) {\n            sortDirection = sortDirection === 'desc' ? 'asc' : 'desc';\n            sortedData.sort((a, b) => {\n                const aVal = a[field] ?? '';\n                const bVal = b[field] ?? '';\n                if (typeof aVal === 'string') {\n                    return sortDirection === 'desc' \n                        ? bVal.localeCompare(aVal) \n                        : aVal.localeCompare(bVal);\n                }\n                return sortDirection === 'desc' \n                    ? bVal - aVal \n                    : aVal - bVal;\n            });\n            updateTable();\n        }\n    </script>\n</body>\n</html>\n</antArtifact>\n\nKey changes made:\n\n1. Removed Youth Engagement Score from the data\n2. Reorganized default columns in the specified order:\n   - Organization (fixed first column)\n   - Average Score\n   - Total Followers\n   - Total # Employees\n   - Num Training Programs(3 years)\n   - Training Impact Ratio\n   - Plus other metrics\n3. Added tooltips for calculated metrics that appear on hover\n4. Made the Organization column sticky/fixed on the left\n5. Added proper styling for the fixed column and tooltips\n\nThe tooltips will now appear when hovering over the calculated metric headers, explaining how each metric is calculated. The Organization column will stay fixed on the left side when scrolling horizontally.\n\nWould you like me to make any adjustments to the tooltips or the column order?",
      "created_at": "2024-12-02T08:37:46.982222Z",
      "sequence_order": 3,
      "metadata": {
        "content": [
          {
            "start_timestamp": null,
            "stop_timestamp": null,
            "flags": null,
            "type": "text",
            "text": " I'll modify the code to adjust the columns and add tooltips for calculated metrics.\n\n<antArtifact identifier=\"data-viewer\" type=\"application/vnd.ant.code\" language=\"html\" title=\"Updated Data Viewer\">\n<!DOCTYPE html>\n<html>\n<head>\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.19/lodash.min.js\"></script>\n    <style>\n        /* Previous styles remain */\n        .fixed-column {\n            position: sticky;\n            left: 0;\n            background: white;\n            z-index: 10;\n            border-right: 2px solid #e2e8f0;\n        }\n\n        th[title] {\n            cursor: help;\n        }\n\n        /* Tooltip styles */\n        .tooltip {\n            position: relative;\n            display: inline-block;\n        }\n\n        .tooltip:hover::after {\n            content: attr(title);\n            position: absolute;\n            bottom: 100%;\n            left: 50%;\n            transform: translateX(-50%);\n            padding: 8px;\n            background: #2d3748;\n            color: white;\n            border-radius: 4px;\n            font-size: 14px;\n            white-space: nowrap;\n            z-index: 20;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n        }\n    </style>\n</head>\n<body>\n    <!-- Previous HTML structure remains -->\n\n    <script>\n        // Previous rawData remains unchanged\n\n        // Define default columns in desired order\n        const defaultColumns = [\n            \"Organization\",\n            \"Average Score\",\n            \"Total Followers\",\n            \"Total # Employees\",\n            \"Num Training Programs(3 years)\",\n            \"Training Impact Ratio\",\n            \"Efficiency\",\n            \"Social Media Reach Per Employee\",\n            \"Topics Covered\",\n            \"Areas Operating\"\n        ];\n\n        // Define tooltips for calculated metrics\n        const columnTooltips = {\n            \"Training Impact Ratio\": \"Calculated as: Estimated Number Trainees / Total # Employees\",\n            \"Efficiency\": \"Calculated as: Number of Training Programs / Total # Employees\",\n            \"Social Media Reach Per Employee\": \"Calculated as: Estimated Number of People Reached Social media / Total # Employees\"\n        };\n\n        let activeColumns = [...defaultColumns];\n        let sortedData = [];\n\n        // Process data and remove Youth Engagement Score\n        const processedData = rawData.map(org => {\n            const processed = {...org};\n            delete processed[\"Youth Engagement Score\"];\n            return {\n                ...processed,\n                \"Efficiency\": isFinite(org[\"Efficiency\"]) ? org[\"Efficiency\"] : 0,\n                \"Social Media Reach Per Employee\": isFinite(org[\"Social Media Reach Per Employee\"]) ? org[\"Social Media Reach Per Employee\"] : 0,\n                \"Training Impact Ratio\": isFinite(org[\"Training Impact Ratio\"]) ? org[\"Training Impact Ratio\"] : 0\n            };\n        });\n\n        // Calculate statistics\n        const stats = {\n            totalEmployees: processedData.reduce((sum, org) => sum + (org[\"Total # Employees\"] || 0), 0),\n            totalTrainees: processedData.reduce((sum, org) => sum + (org[\"Estimated Number Trainees\"] || 0), 0),\n            averageScore: (processedData.reduce((sum, org) => sum + (org[\"Average Score\"] || 0), 0) / processedData.length).toFixed(2)\n        };\n\n        function updateTableHeader() {\n            const thead = document.querySelector('thead');\n            thead.innerHTML = `\n                <tr>\n                    ${activeColumns.map((col, index) => `\n                        <th \n                            onclick=\"sortBy('${col}')\" \n                            class=\"${col === 'Organization' ? 'fixed-column' : ''} tooltip\"\n                            ${columnTooltips[col] ? `title=\"${columnTooltips[col]}\"` : ''}\n                        >\n                            ${col}\n                        </th>\n                    `).join('')}\n                    <th>Actions</th>\n                </tr>\n            `;\n        }\n\n        function updateTable() {\n            const tbody = document.querySelector('tbody');\n            tbody.innerHTML = '';\n            \n            sortedData.forEach(org => {\n                const row = document.createElement('tr');\n                row.innerHTML = `\n                    ${activeColumns.map((col, index) => `\n                        <td class=\"${col === 'Organization' ? 'fixed-column' : ''} \n                                  ${col === 'Average Score' ? getScoreClass(org[col]) : ''}\">\n                            ${formatCell(org[col])}\n                        </td>\n                    `).join('')}\n                    <td>\n                        <button onclick=\"showDetails('${org.Organization}')\">Details</button>\n                    </td>\n                `;\n                tbody.appendChild(row);\n            });\n        }\n\n        // Previous helper functions remain unchanged\n\n        function formatCell(value) {\n            if (value === null || value === undefined || value === '') return 'N.A.';\n            if (typeof value === 'number') {\n                if (value > 1000) return value.toLocaleString();\n                if (value % 1 !== 0) return value.toFixed(2);\n            }\n            return value;\n        }\n\n        function getScoreClass(score) {\n            if (!score) return '';\n            if (score >= 4.5) return 'high-score';\n            if (score >= 3.5) return 'medium-score';\n            return 'low-score';\n        }\n\n        // Initialize the table when the document is ready\n        document.addEventListener('DOMContentLoaded', () => {\n            initializeTable();\n        });\n\n        // Previous event listeners and sorting functionality remain unchanged\n\n        let sortDirection = 'desc';\n        function sortBy(field) {\n            sortDirection = sortDirection === 'desc' ? 'asc' : 'desc';\n            sortedData.sort((a, b) => {\n                const aVal = a[field] ?? '';\n                const bVal = b[field] ?? '';\n                if (typeof aVal === 'string') {\n                    return sortDirection === 'desc' \n                        ? bVal.localeCompare(aVal) \n                        : aVal.localeCompare(bVal);\n                }\n                return sortDirection === 'desc' \n                    ? bVal - aVal \n                    : aVal - bVal;\n            });\n            updateTable();\n        }\n    </script>\n</body>\n</html>\n</antArtifact>\n\nKey changes made:\n\n1. Removed Youth Engagement Score from the data\n2. Reorganized default columns in the specified order:\n   - Organization (fixed first column)\n   - Average Score\n   - Total Followers\n   - Total # Employees\n   - Num Training Programs(3 years)\n   - Training Impact Ratio\n   - Plus other metrics\n3. Added tooltips for calculated metrics that appear on hover\n4. Made the Organization column sticky/fixed on the left\n5. Added proper styling for the fixed column and tooltips\n\nThe tooltips will now appear when hovering over the calculated metric headers, explaining how each metric is calculated. The Organization column will stay fixed on the left side when scrolling horizontally.\n\nWould you like me to make any adjustments to the tooltips or the column order?",
            "citations": []
          }
        ],
        "updated_at": "2024-12-02T08:37:46.982222Z",
        "attachments": [],
        "files": []
      }
    },
    {
      "id": "b4d491a1-ae1c-453c-b102-87d984b7e331",
      "role": "human",
      "content": "this is the code I like, can you add a toggle all, toggle all selection criteria (and those would be): \"1. Organizational Capacity\n2 Experience in Similar Projects\n3 Alignment with Program Goals\n4Ability to Reach and Engage the Target Audience\n5 Capacity to Deliver Training Effectively to the Target Audience\n6 Willingness and Ability to Collaborate\"\n\nWhat is an elegant way we can handle a table that extends beyond the limits of the screen, right now it goes and goes into a gray background which is weird",
      "created_at": "2024-12-02T08:51:52.755940Z",
      "sequence_order": 4,
      "metadata": {
        "content": [
          {
            "start_timestamp": null,
            "stop_timestamp": null,
            "flags": null,
            "type": "text",
            "text": "this is the code I like, can you add a toggle all, toggle all selection criteria (and those would be): \"1. Organizational Capacity\n2 Experience in Similar Projects\n3 Alignment with Program Goals\n4Ability to Reach and Engage the Target Audience\n5 Capacity to Deliver Training Effectively to the Target Audience\n6 Willingness and Ability to Collaborate\"\n\nWhat is an elegant way we can handle a table that extends beyond the limits of the screen, right now it goes and goes into a gray background which is weird",
            "citations": []
          }
        ],
        "updated_at": "2024-12-02T08:51:52.755940Z",
        "attachments": [
          {
            "file_name": "paste.txt",
            "file_size": 29473,
            "file_type": "txt",
            "extracted_content": "<!DOCTYPE html>\n<html>\n<head>\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.19/lodash.min.js\"></script>\n    <style>\n        /* Previous styles remain */\n        body {\n            font-family: system-ui, -apple-system, sans-serif;\n            margin: 20px;\n            background: #f5f5f5;\n        }\n        .container {\n            background: white;\n            border-radius: 8px;\n            padding: 20px;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n            max-width: 1400px;\n            margin: 0 auto;\n        }\n        .metric-cards {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n            gap: 20px;\n            margin-bottom: 20px;\n        }\n        .metric-card {\n            background: white;\n            padding: 15px;\n            border-radius: 8px;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.05);\n        }\n        .metric-card h3 {\n            margin: 0 0 10px 0;\n            color: #4a5568;\n            font-size: 14px;\n        }\n        .metric-card .value {\n            font-size: 24px;\n            font-weight: bold;\n            color: #2d3748;\n        }\n        .controls {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n            gap: 10px;\n            margin: 20px 0;\n        }\n        select, input, button {\n            padding: 8px 12px;\n            border: 1px solid #e2e8f0;\n            border-radius: 6px;\n            font-size: 14px;\n        }\n        button {\n            background: #4a5568;\n            color: white;\n            border: none;\n            cursor: pointer;\n        }\n        button:hover {\n            background: #2d3748;\n        }\n        .modal {\n            display: none;\n            position: fixed;\n            top: 0;\n            left: 0;\n            right: 0;\n            bottom: 0;\n            background: rgba(0,0,0,0.5);\n            padding: 20px;\n        }\n        .modal-content {\n            background: white;\n            padding: 20px;\n            border-radius: 8px;\n            max-width: 800px;\n            margin: 40px auto;\n            max-height: 80vh;\n            overflow-y: auto;\n        }\n        .close {\n            float: right;\n            font-size: 20px;\n            cursor: pointer;\n        }\n        .column-toggle {\n            display: flex;\n            flex-wrap: wrap;\n            gap: 10px;\n            margin: 10px 0;\n        }\n        .column-toggle label {\n            display: flex;\n            align-items: center;\n            gap: 5px;\n        }\n        table {\n            width: 100%;\n            border-collapse: collapse;\n            margin-top: 20px;\n        }\n        th, td {\n            padding: 12px;\n            text-align: left;\n            border-bottom: 1px solid #e2e8f0;\n        }\n        th {\n            background: #2d3748;\n            color: white;\n            position: sticky;\n            top: 0;\n            cursor: pointer;\n        }\n\n\n        .fixed-column {\n            position: sticky;\n            left: 0;\n            background: white;\n            z-index: 10;\n            border-right: 2px solid #e2e8f0;\n        }\n\n        th[title] {\n            cursor: help;\n        }\n\n        .tooltip:hover::after {\n            content: attr(title);\n            position: absolute;\n            bottom: 100%;\n            left: 50%;\n            transform: translateX(-50%);\n            padding: 8px;\n            background: #2d3748;\n            color: white;\n            border-radius: 4px;\n            font-size: 14px;\n            white-space: nowrap;\n            z-index: 20;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h1>Implementing Partners Overview</h1>\n        \n        <div class=\"metric-cards\">\n            <div class=\"metric-card\">\n                <h3>Total Organizations</h3>\n                <div class=\"value\" id=\"totalOrgs\">-</div>\n            </div>\n            <div class=\"metric-card\">\n                <h3>Average Score</h3>\n                <div class=\"value\" id=\"avgScore\">-</div>\n            </div>\n            <div class=\"metric-card\">\n                <h3>Total Employees</h3>\n                <div class=\"value\" id=\"totalEmployees\">-</div>\n            </div>\n            <div class=\"metric-card\">\n                <h3>Total Trainees</h3>\n                <div class=\"value\" id=\"totalTrainees\">-</div>\n            </div>\n        </div>\n\n        <div class=\"controls\">\n            <input type=\"text\" id=\"search\" placeholder=\"Search organizations...\">\n            <button id=\"exportBtn\">Export to CSV</button>\n            <button id=\"toggleColumns\">Toggle Columns</button>\n        </div>\n\n        <div class=\"column-toggle\" id=\"columnToggle\" style=\"display: none;\">\n            <!-- Will be populated dynamically -->\n        </div>\n\n        <div class=\"table-container\">\n            <table id=\"partnersTable\">\n                <thead>\n                    <!-- Will be populated dynamically -->\n                </thead>\n                <tbody></tbody>\n            </table>\n        </div>\n    </div>\n\n    <div id=\"detailModal\" class=\"modal\">\n        <div class=\"modal-content\">\n            <span class=\"close\">&times;</span>\n            <div id=\"modalContent\"></div>\n        </div>\n    </div>\n\n    <script>\n\nconst rawData = [\n    {\n        // Base Information\n        \"Organization\": \"Mosul Space\",\n        \"Year of Establishment\": 2014,\n        \"Total # Employees\": 14,\n        \"Average Score\": 4.95,\n        \"Topics Covered\": \"Sustainable Construction, Renewable Energy, Financial Literacy, Entrepreneurship, Technical Skills, Soft Skills, Media, Advocacy\",\n        \"Areas Operating\": \"Ninewa Governorate\",\n        \n        // Detailed Metrics\n        \"Number Full-Time Employees\": 12,\n        \"Number Part-Time Employees\": 2,\n        \"Number of Instagram Followers\": 18800,\n        \"Number of LinkedIn Followers\": 2000,\n        \"Total Followers\": 20800,\n        \"Estimated Number of People Reached Social media\": 1500000,\n        \"Percent Youth\": 95,\n        \"Percent Woman\": 40,\n        \"Percent Marginalized\": 15,\n        \"Num Training Programs(3 years)\": 25,\n        \"Estimated Number Trainees\": 3000,\n        \"Key Staff Years Of Experience\": 11,\n        \"Number of Topics\": 8,\n        \"Number of Areas Operating\": 1,\n\n        // Evaluation Scores\n        \"Organizational Capacity\": 4.67,\n        \"Experience in Similar Projects\": 5.00,\n        \"Alignment with Program Goals\": 5.00,\n        \"Ability to Reach Target Audience\": 5.00,\n        \"Capacity to Deliver Training\": 5.00,\n        \"Willingness & Ability to Collaborate\": 4.95,\n        \n        // Calculated Metrics\n        \"Efficiency\": 1.79, // 25 programs / 14 employees\n        \"Social Media Reach Per Employee\": 107142.86, // 1500000 / 14\n        \"Training Impact Ratio\": 214.29, // 3000 / 14\n        \"Youth Engagement Score\": 665.25 // (95 * 14 * 4.95) / 100\n    },\n    {\n        \"Organization\": \"Makers of Baghdad\",\n        \"Year of Establishment\": 2016,\n        \"Total # Employees\": 22,\n        \"Average Score\": 4.84,\n        \"Topics Covered\": \"Sustainable Construction, Renewable Energy, Financial Literacy, Entrepreneurship, Technical Skills, Soft Skills, Graphic Design\",\n        \"Areas Operating\": \"Baghdad, Anbar, Diwaniya, Babil, Karbala, Najaf\",\n        \n        \"Number Full-Time Employees\": 12,\n        \"Number Part-Time Employees\": 10,\n        \"Number of Instagram Followers\": 55400,\n        \"Number of LinkedIn Followers\": 2000,\n        \"Total Followers\": 57400,\n        \"Estimated Number of People Reached Social media\": 3500000,\n        \"Percent Youth\": 100,\n        \"Percent Woman\": 47,\n        \"Percent Marginalized\": 1,\n        \"Num Training Programs(3 years)\": 204,\n        \"Estimated Number Trainees\": 0,\n        \"Key Staff Years Of Experience\": 6,\n        \"Number of Topics\": 11,\n        \"Number of Areas Operating\": 5,\n\n        \"Organizational Capacity\": 4.67,\n        \"Experience in Similar Projects\": 4.67,\n        \"Alignment with Program Goals\": 5.00,\n        \"Ability to Reach Target Audience\": 5.00,\n        \"Capacity to Deliver Training\": 4.67,\n        \"Willingness & Ability to Collaborate\": 4.84,\n        \n        \"Efficiency\": 9.27, // 204 programs / 22 employees\n        \"Social Media Reach Per Employee\": 159090.91, // 3500000 / 22\n        \"Training Impact Ratio\": 0, // No trainees reported\n        \"Youth Engagement Score\": 1064.80 // (100 * 22 * 4.84) / 100\n    },\n        {\n        \"Organization\": \"Mosul Heritage Foundation\",\n        \"Year of Establishment\": 2022,\n        \"Total # Employees\": 13,\n        \"Average Score\": 4.42,\n        \"Topics Covered\": \"Sustainable Construction, Entrepreneurship, Soft Skills\",\n        \"Areas Operating\": \"Ninewa Governorate\",\n        \n        \"Number Full-Time Employees\": 9,\n        \"Number Part-Time Employees\": 4,\n        \"Number of Instagram Followers\": 22100,\n        \"Number of LinkedIn Followers\": 220,\n        \"Total Followers\": 22320,\n        \"Estimated Number of People Reached Social media\": 2000000,\n        \"Percent Youth\": 40,\n        \"Percent Woman\": 45,\n        \"Percent Marginalized\": 5,\n        \"Num Training Programs(3 years)\": 4,\n        \"Estimated Number Trainees\": 50,\n        \"Key Staff Years Of Experience\": 20,\n        \"Number of Topics\": 3,\n        \"Number of Areas Operating\": 1,\n\n        \"Organizational Capacity\": 4.00,\n        \"Experience in Similar Projects\": 3.67,\n        \"Alignment with Program Goals\": 4.50,\n        \"Ability to Reach Target Audience\": 5.00,\n        \"Capacity to Deliver Training\": 4.67,\n        \"Willingness & Ability to Collaborate\": 4.42,\n        \n        \"Efficiency\": 0.31, // 4 programs / 13 employees\n        \"Social Media Reach Per Employee\": 153846.15,\n        \"Training Impact Ratio\": 3.85,\n        \"Youth Engagement Score\": 229.84\n    },\n    {\n        \"Organization\": \"Qaf Lab\",\n        \"Year of Establishment\": 2019,\n        \"Total # Employees\": 38,\n        \"Average Score\": 4.39,\n        \"Topics Covered\": \"Renewable Energy, Entrepreneurship, Technical Skills, Soft Skills, Media production, AC and HVAC systems\",\n        \"Areas Operating\": \"Ninewa Governorate\",\n        \n        \"Number Full-Time Employees\": 32,\n        \"Number Part-Time Employees\": 6,\n        \"Number of Instagram Followers\": 16800,\n        \"Number of LinkedIn Followers\": 3000,\n        \"Total Followers\": 19800,\n        \"Estimated Number of People Reached Social media\": 700000,\n        \"Percent Youth\": 80,\n        \"Percent Woman\": 30,\n        \"Percent Marginalized\": 20,\n        \"Num Training Programs(3 years)\": 20,\n        \"Estimated Number Trainees\": 200,\n        \"Key Staff Years Of Experience\": 6,\n        \"Number of Topics\": 6,\n        \"Number of Areas Operating\": 1,\n\n        \"Organizational Capacity\": 3.67,\n        \"Experience in Similar Projects\": 4.33,\n        \"Alignment with Program Goals\": 5.00,\n        \"Ability to Reach Target Audience\": 4.33,\n        \"Capacity to Deliver Training\": 4.67,\n        \"Willingness & Ability to Collaborate\": 4.39,\n        \n        \"Efficiency\": 0.53,\n        \"Social Media Reach Per Employee\": 18421.05,\n        \"Training Impact Ratio\": 5.26,\n        \"Youth Engagement Score\": 1334.56\n    },\n    {\n        \"Organization\": \"Kapita\",\n        \"Year of Establishment\": 2019,\n        \"Total # Employees\": 30,\n        \"Average Score\": 4.17,\n        \"Topics Covered\": \"N.A.\",\n        \"Areas Operating\": \"N.A.\",\n        \n        \"Number Full-Time Employees\": 30,\n        \"Number Part-Time Employees\": 0,\n        \"Number of Instagram Followers\": 18000,\n        \"Number of LinkedIn Followers\": 10000,\n        \"Total Followers\": 28000,\n        \"Estimated Number of People Reached Social media\": 28000,\n        \"Percent Youth\": 0,\n        \"Percent Woman\": 0,\n        \"Percent Marginalized\": 0,\n        \"Num Training Programs(3 years)\": 0,\n        \"Estimated Number Trainees\": 500,\n        \"Key Staff Years Of Experience\": 0,\n        \"Number of Topics\": 0,\n        \"Number of Areas Operating\": 0,\n\n        \"Organizational Capacity\": 3.67,\n        \"Experience in Similar Projects\": 4.00,\n        \"Alignment with Program Goals\": 5.00,\n        \"Ability to Reach Target Audience\": 3.67,\n        \"Capacity to Deliver Training\": 4.00,\n        \"Willingness & Ability to Collaborate\": 4.17,\n        \n        \"Efficiency\": 0,\n        \"Social Media Reach Per Employee\": 933.33,\n        \"Training Impact Ratio\": 16.67,\n        \"Youth Engagement Score\": 0\n    },\n    {\n        \"Organization\": \"Iraq Green Building Council\",\n        \"Year of Establishment\": 2021,\n        \"Total # Employees\": 3,\n        \"Average Score\": 4.00,\n        \"Topics Covered\": \"N.A.\",\n        \"Areas Operating\": \"N.A.\",\n        \n        \"Number Full-Time Employees\": 0,\n        \"Number Part-Time Employees\": 0,\n        \"Number of Instagram Followers\": 6900,\n        \"Number of LinkedIn Followers\": 172,\n        \"Total Followers\": 7072,\n        \"Estimated Number of People Reached Social media\": 0,\n        \"Percent Youth\": 0,\n        \"Percent Woman\": 0,\n        \"Percent Marginalized\": 0,\n        \"Num Training Programs(3 years)\": 0,\n        \"Estimated Number Trainees\": 0,\n        \"Key Staff Years Of Experience\": 0,\n        \"Number of Topics\": 0,\n        \"Number of Areas Operating\": 0,\n\n        \"Organizational Capacity\": 4.00,\n        \"Experience in Similar Projects\": 4.00,\n        \"Alignment with Program Goals\": 4.00,\n        \"Ability to Reach Target Audience\": 4.00,\n        \"Capacity to Deliver Training\": 4.00,\n        \"Willingness & Ability to Collaborate\": 4.00,\n        \n        \"Efficiency\": 0,\n        \"Social Media Reach Per Employee\": 0,\n        \"Training Impact Ratio\": 0,\n        \"Youth Engagement Score\": 0\n    },\n    {\n        \"Organization\": \"Rwanga Foundation\",\n        \"Year of Establishment\": 2013,\n        \"Total # Employees\": 93,\n        \"Average Score\": 4.00,\n        \"Topics Covered\": \"N.A.\",\n        \"Areas Operating\": \"N.A.\",\n        \n        \"Number Full-Time Employees\": 0,\n        \"Number Part-Time Employees\": 0,\n        \"Number of Instagram Followers\": 64800,\n        \"Number of LinkedIn Followers\": 15000,\n        \"Total Followers\": 79800,\n        \"Estimated Number of People Reached Social media\": 0,\n        \"Percent Youth\": 0,\n        \"Percent Woman\": 0,\n        \"Percent Marginalized\": 0,\n        \"Num Training Programs(3 years)\": 0,\n        \"Estimated Number Trainees\": 0,\n        \"Key Staff Years Of Experience\": 0,\n        \"Number of Topics\": 0,\n        \"Number of Areas Operating\": 0,\n\n        \"Organizational Capacity\": 4.00,\n        \"Experience in Similar Projects\": 4.00,\n        \"Alignment with Program Goals\": 4.00,\n        \"Ability to Reach Target Audience\": 4.00,\n        \"Capacity to Deliver Training\": 4.00,\n        \"Willingness & Ability to Collaborate\": 4.00,\n        \n        \"Efficiency\": 0,\n        \"Social Media Reach Per Employee\": 0,\n        \"Training Impact Ratio\": 0,\n        \"Youth Engagement Score\": 0\n    },\n    {\n        \"Organization\": \"Suli Innovation House\",\n        \"Year of Establishment\": 2022,\n        \"Total # Employees\": 9,\n        \"Average Score\": 3.67,\n        \"Topics Covered\": \"Renewable Energy, Entrepreneurship, Technical Skills, Soft Skills\",\n        \"Areas Operating\": \"Sulaymaniyah\",\n        \n        \"Number Full-Time Employees\": 6,\n        \"Number Part-Time Employees\": 3,\n        \"Number of Instagram Followers\": 9846,\n        \"Number of LinkedIn Followers\": 3421,\n        \"Total Followers\": 13267,\n        \"Estimated Number of People Reached Social media\": 400000,\n        \"Percent Youth\": 99,\n        \"Percent Woman\": 49,\n        \"Percent Marginalized\": 10,\n        \"Num Training Programs(3 years)\": 35,\n        \"Estimated Number Trainees\": 2000,\n        \"Key Staff Years Of Experience\": 10,\n        \"Number of Topics\": 4,\n        \"Number of Areas Operating\": 1,\n\n        \"Organizational Capacity\": 3.67,\n        \"Experience in Similar Projects\": 3.33,\n        \"Alignment with Program Goals\": 3.67,\n        \"Ability to Reach Target Audience\": 3.67,\n        \"Capacity to Deliver Training\": 4.00,\n        \"Willingness & Ability to Collaborate\": 3.67,\n        \n        \"Efficiency\": 3.89,\n        \"Social Media Reach Per Employee\": 44444.44,\n        \"Training Impact Ratio\": 222.22,\n        \"Youth Engagement Score\": 327.03\n    },\n    {\n        \"Organization\": \"The Station\",\n        \"Year of Establishment\": 2018,\n        \"Total # Employees\": 20,\n        \"Average Score\": 3.61,\n        \"Topics Covered\": \"Financial Literacy, Entrepreneurship, Technical Skills, Soft Skills\",\n        \"Areas Operating\": \"Ninewa Governorate, Erbil, Baghdad, Basra\",\n        \n        \"Number Full-Time Employees\": 18,\n        \"Number Part-Time Employees\": 2,\n        \"Number of Instagram Followers\": 111000,\n        \"Number of LinkedIn Followers\": 45000,\n        \"Total Followers\": 156000,\n        \"Estimated Number of People Reached Social media\": 200000,\n        \"Percent Youth\": 50,\n        \"Percent Woman\": 45,\n        \"Percent Marginalized\": 10,\n        \"Num Training Programs(3 years)\": 10,\n        \"Estimated Number Trainees\": 5000,\n        \"Key Staff Years Of Experience\": 0,\n        \"Number of Topics\": 4,\n        \"Number of Areas Operating\": 4,\n\n        \"Organizational Capacity\": 3.67,\n        \"Experience in Similar Projects\": 3.00,\n        \"Alignment with Program Goals\": 3.33,\n        \"Ability to Reach Target Audience\": 4.00,\n        \"Capacity to Deliver Training\": 3.67,\n        \"Willingness & Ability to Collaborate\": 3.61,\n        \n        \"Efficiency\": 0.5,\n        \"Social Media Reach Per Employee\": 10000,\n        \"Training Impact Ratio\": 250,\n        \"Youth Engagement Score\": 361\n    },\n    {\n        \"Organization\": \"51Labs\",\n        \"Year of Establishment\": 2017,\n        \"Total # Employees\": 22,\n        \"Average Score\": 3.50,\n        \"Topics Covered\": \"Financial Literacy, Entrepreneurship, Soft Skills\",\n        \"Areas Operating\": \"Erbil\",\n        \n        \"Number Full-Time Employees\": 20,\n        \"Number Part-Time Employees\": 2,\n        \"Number of Instagram Followers\": 11500,\n        \"Number of LinkedIn Followers\": 10140,\n        \"Total Followers\": 21640,\n        \"Estimated Number of People Reached Social media\": 500,\n        \"Percent Youth\": 70,\n        \"Percent Woman\": 40,\n        \"Percent Marginalized\": 20,\n        \"Num Training Programs(3 years)\": 10,\n        \"Estimated Number Trainees\": 0,\n        \"Key Staff Years Of Experience\": 0,\n        \"Number of Topics\": 3,\n        \"Number of Areas Operating\": 1,\n\n        \"Organizational Capacity\": 3.67,\n        \"Experience in Similar Projects\": 3.33,\n        \"Alignment with Program Goals\": 3.67,\n        \"Ability to Reach Target Audience\": 3.00,\n        \"Capacity to Deliver Training\": 3.67,\n        \"Willingness & Ability to Collaborate\": 3.50,\n        \n        \"Efficiency\": 0.45,\n        \"Social Media Reach Per Employee\": 22.73,\n        \"Training Impact Ratio\": 0,\n        \"Youth Engagement Score\": 539\n    }\n];\n        // Process data and remove Youth Engagement Score\n        const processedData = rawData.map(org => {\n            const processed = {...org};\n            delete processed[\"Youth Engagement Score\"];\n            return {\n                ...processed,\n                \"Efficiency\": isFinite(org[\"Efficiency\"]) ? org[\"Efficiency\"] : 0,\n                \"Social Media Reach Per Employee\": isFinite(org[\"Social Media Reach Per Employee\"]) ? org[\"Social Media Reach Per Employee\"] : 0,\n                \"Training Impact Ratio\": isFinite(org[\"Training Impact Ratio\"]) ? org[\"Training Impact Ratio\"] : 0\n            };\n        });\n\n        // Calculate statistics\n  const stats = {\n            totalEmployees: processedData.reduce((sum, org) => sum + (org[\"Total # Employees\"] || 0), 0),\n            totalTrainees: processedData.reduce((sum, org) => sum + (org[\"Estimated Number Trainees\"] || 0), 0),\n            averageScore: (processedData.reduce((sum, org) => sum + (org[\"Average Score\"] || 0), 0) / processedData.length).toFixed(2)\n        };\n        function formatCell(value) {\n            if (value === null || value === undefined || value === '') return 'N.A.';\n            if (typeof value === 'number') {\n                if (value > 1000) return value.toLocaleString();\n                if (value % 1 !== 0) return value.toFixed(2);\n            }\n            return value;\n        }\n\n        function getScoreClass(score) {\n            if (!score) return '';\n            if (score >= 4.5) return 'high-score';\n            if (score >= 3.5) return 'medium-score';\n            return 'low-score';\n        }\n\n        // Initialize the table when the document is ready\n        document.addEventListener('DOMContentLoaded', () => {\n            initializeTable();\n        });\n\n        // Define which columns to show by default\n        const defaultColumns = [\n            \"Organization\",\n            \"Average Score\",\n            \"Total Followers\",\n            \"Total # Employees\",\n            \"Num Training Programs(3 years)\",\n            \"Training Impact Ratio\",\n            \"Efficiency\",\n            \"Social Media Reach Per Employee\",\n            \"Topics Covered\",\n            \"Areas Operating\"\n        ];\n\n        // Define tooltips for calculated metrics\n        const columnTooltips = {\n            \"Training Impact Ratio\": \"Calculated as: Estimated Number Trainees / Total # Employees\",\n            \"Efficiency\": \"Calculated as: Number of Training Programs / Total # Employees\",\n            \"Social Media Reach Per Employee\": \"Calculated as: Estimated Number of People Reached Social media / Total # Employees\"\n        };\n\n        let activeColumns = [...defaultColumns];\n        let sortedData = [];\n\n        function initializeTable() {\n            // Get all possible columns from the data\n            const allColumns = new Set();\n            processedData.forEach(org => {\n                Object.keys(org).forEach(key => allColumns.add(key));\n            });\n\n            // Create column toggle checkboxes\n            const columnToggle = document.getElementById('columnToggle');\n            Array.from(allColumns).sort().forEach(column => {\n                const label = document.createElement('label');\n                const checkbox = document.createElement('input');\n                checkbox.type = 'checkbox';\n                checkbox.checked = defaultColumns.includes(column);\n                checkbox.value = column;\n                checkbox.addEventListener('change', handleColumnToggle);\n                label.appendChild(checkbox);\n                label.appendChild(document.createTextNode(column));\n                columnToggle.appendChild(label);\n            });\n\n            // Initialize the table header\n            updateTableHeader();\n            sortedData = [...processedData];\n            updateTable();\n            updateMetricCards();\n        }\n\n        function updateMetricCards() {\n            document.getElementById('totalOrgs').textContent = processedData.length;\n            document.getElementById('avgScore').textContent = stats.averageScore;\n            document.getElementById('totalEmployees').textContent = stats.totalEmployees.toLocaleString();\n            document.getElementById('totalTrainees').textContent = stats.totalTrainees.toLocaleString();\n        }\n\n        function handleColumnToggle(e) {\n            const column = e.target.value;\n            if (e.target.checked) {\n                activeColumns.push(column);\n            } else {\n                activeColumns = activeColumns.filter(col => col !== column);\n            }\n            updateTableHeader();\n            updateTable();\n        }\n\n\n        function updateTableHeader() {\n            const thead = document.querySelector('thead');\n            thead.innerHTML = `\n                <tr>\n                    ${activeColumns.map((col, index) => `\n                        <th \n                            onclick=\"sortBy('${col}')\" \n                            class=\"${col === 'Organization' ? 'fixed-column' : ''} tooltip\"\n                            ${columnTooltips[col] ? `title=\"${columnTooltips[col]}\"` : ''}\n                        >\n                            ${col}\n                        </th>\n                    `).join('')}\n                    <th>Actions</th>\n                </tr>\n            `;\n        }\n\n        function updateTable() {\n            const tbody = document.querySelector('tbody');\n            tbody.innerHTML = '';\n            \n            sortedData.forEach(org => {\n                const row = document.createElement('tr');\n                row.innerHTML = `\n                    ${activeColumns.map((col, index) => `\n                        <td class=\"${col === 'Organization' ? 'fixed-column' : ''} \n                                  ${col === 'Average Score' ? getScoreClass(org[col]) : ''}\">\n                            ${formatCell(org[col])}\n                        </td>\n                    `).join('')}\n                    <td>\n                        <button onclick=\"showDetails('${org.Organization}')\">Details</button>\n                    </td>\n                `;\n                tbody.appendChild(row);\n            });\n        }\n\n\n        function showDetails(orgName) {\n            const org = processedData.find(o => o.Organization === orgName);\n            const modal = document.getElementById('detailModal');\n            const content = document.getElementById('modalContent');\n            \n            content.innerHTML = `\n                <h2>${org.Organization}</h2>\n                <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;\">\n                    ${Object.entries(org)\n                        .map(([key, value]) => `\n                            <div>\n                                <strong>${key}:</strong>\n                                <div>${formatCell(value)}</div>\n                            </div>\n                        `).join('')}\n                </div>\n            `;\n            \n            modal.style.display = 'block';\n        }\n\n        // Event Listeners\n        document.querySelector('.close').onclick = () => {\n            document.getElementById('detailModal').style.display = 'none';\n        };\n\n        document.getElementById('toggleColumns').onclick = () => {\n            const columnToggle = document.getElementById('columnToggle');\n            columnToggle.style.display = columnToggle.style.display === 'none' ? 'flex' : 'none';\n        };\n\n        document.getElementById('filterField').addEventListener('change', (e) => {\n            const filterValue = e.target.value;\n            if (!filterValue) {\n                sortedData = [...processedData];\n            } else {\n                sortedData = processedData.filter(org => {\n                    switch(filterValue) {\n                        case 'hasYouth': return org['Percent Youth'] > 0;\n                        case 'hasWomen': return org['Percent Woman'] > 0;\n                        case 'hasTraining': return org['Num Training Programs(3 years)'] > 0;\n                        default: return true;\n                    }\n                });\n            }\n            updateTable();\n        });\n\n        document.getElementById('search').addEventListener('input', (e) => {\n            const searchTerm = e.target.value.toLowerCase();\n            sortedData = processedData.filter(org => \n                Object.values(org).some(value => \n                    String(value).toLowerCase().includes(searchTerm)\n                )\n            );\n            updateTable();\n        });\n\n        document.getElementById('exportBtn').addEventListener('click', () => {\n            const csv = [\n                activeColumns.join(','),\n                ...sortedData.map(org => \n                    activeColumns.map(col => JSON.stringify(org[col] || '')).join(',')\n                )\n            ].join('\\n');\n\n            const blob = new Blob([csv], { type: 'text/csv' });\n            const url = window.URL.createObjectURL(blob);\n            const a = document.createElement('a');\n            a.setAttribute('hidden', '');\n            a.setAttribute('href', url);\n            a.setAttribute('download', 'partners_data.csv');\n            document.body.appendChild(a);\n            a.click();\n            document.body.removeChild(a);\n        });\n\n        function sortBy(field) {\n            sortedData.sort((a, b) => {\n                const aVal = a[field];\n                const bVal = b[field];\n                if (typeof aVal === 'string') {\n                    return aVal.localeCompare(bVal);\n                }\n                return bVal - aVal;\n            });\n            updateTable();\n        }\n       let sortDirection = 'desc';\n        function sortBy(field) {\n            sortDirection = sortDirection === 'desc' ? 'asc' : 'desc';\n            sortedData.sort((a, b) => {\n                const aVal = a[field] ?? '';\n                const bVal = b[field] ?? '';\n                if (typeof aVal === 'string') {\n                    return sortDirection === 'desc' \n                        ? bVal.localeCompare(aVal) \n                        : aVal.localeCompare(bVal);\n                }\n                return sortDirection === 'desc' \n                    ? bVal - aVal \n                    : aVal - bVal;\n            });\n            updateTable();\n        }\n        // Initialize\n        initializeTable();\n    </script>\n</body>\n</html>"
          }
        ],
        "files": [
          {
            "file_name": "paste.txt"
          }
        ]
      }
    },
    {
      "id": "1fec78ef-4639-4ded-a157-039bec98de7d",
      "role": "assistant",
      "content": " I'll help improve the code with those changes. Let me make the modifications:\n\n\n\n<antArtifact identifier=\"data-viewer\" type=\"application/vnd.ant.code\" language=\"html\" title=\"Updated Data Viewer with Toggle Groups\">\n// Add these styles in the <style> section\n.table-container {\n    overflow-x: auto;\n    background: white;\n    border-radius: 8px;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n    margin-top: 20px;\n}\n\n.column-toggle {\n    background: white;\n    padding: 15px;\n    border-radius: 8px;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n}\n\n.toggle-group {\n    margin-bottom: 15px;\n    padding: 10px;\n    border: 1px solid #e2e8f0;\n    border-radius: 6px;\n}\n\n.toggle-group-header {\n    font-weight: bold;\n    margin-bottom: 10px;\n    color: #2d3748;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n}\n\n.toggle-group-content {\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\n    gap: 8px;\n}\n\n.toggle-all-btn {\n    background: #4a5568;\n    color: white;\n    padding: 4px 8px;\n    border-radius: 4px;\n    font-size: 12px;\n    cursor: pointer;\n}\n\n.toggle-all-btn:hover {\n    background: #2d3748;\n}\n</antArtifact>\n\nNow let's add the JavaScript logic for the toggle groups:\n\n<antArtifact identifier=\"toggle-logic\" type=\"application/vnd.ant.code\" language=\"javascript\" title=\"Toggle Groups Logic\">\n// Add this before the initializeTable function\nconst columnGroups = {\n    'Selection Criteria': [\n        'Organizational Capacity',\n        'Experience in Similar Projects',\n        'Alignment with Program Goals',\n        'Ability to Reach Target Audience',\n        'Capacity to Deliver Training',\n        'Willingness & Ability to Collaborate'\n    ],\n    'Key Metrics': [\n        'Total Followers',\n        'Total # Employees',\n        'Num Training Programs(3 years)',\n        'Training Impact Ratio',\n        'Efficiency',\n        'Social Media Reach Per Employee'\n    ],\n    'Basic Info': [\n        'Organization',\n        'Average Score',\n        'Topics Covered',\n        'Areas Operating'\n    ]\n};\n\n// Update the initializeTable function's column toggle creation\nfunction createColumnToggles() {\n    const columnToggle = document.getElementById('columnToggle');\n    columnToggle.innerHTML = ''; // Clear existing content\n\n    // Add master toggle all button\n    const masterToggleDiv = document.createElement('div');\n    masterToggleDiv.className = 'toggle-group';\n    masterToggleDiv.innerHTML = `\n        <div class=\"toggle-group-header\">\n            <span>All Columns</span>\n            <button class=\"toggle-all-btn\" onclick=\"toggleAllColumns()\">Toggle All</button>\n        </div>\n    `;\n    columnToggle.appendChild(masterToggleDiv);\n\n    // Create toggle groups\n    Object.entries(columnGroups).forEach(([groupName, columns]) => {\n        const groupDiv = document.createElement('div');\n        groupDiv.className = 'toggle-group';\n        \n        groupDiv.innerHTML = `\n            <div class=\"toggle-group-header\">\n                <span>${groupName}</span>\n                <button class=\"toggle-all-btn\" onclick=\"toggleGroup('${groupName}')\">Toggle Group</button>\n            </div>\n            <div class=\"toggle-group-content\">\n                ${columns.map(column => `\n                    <label>\n                        <input type=\"checkbox\" \n                               value=\"${column}\" \n                               ${defaultColumns.includes(column) ? 'checked' : ''}\n                               onchange=\"handleColumnToggle(event)\">\n                        ${column}\n                    </label>\n                `).join('')}\n            </div>\n        `;\n        columnToggle.appendChild(groupDiv);\n    });\n}\n\n// Add these new functions\nfunction toggleAllColumns() {\n    const allColumns = [...new Set(Object.values(columnGroups).flat())];\n    const allChecked = allColumns.every(col => activeColumns.includes(col));\n    \n    const checkboxes = document.querySelectorAll('#columnToggle input[type=\"checkbox\"]');\n    checkboxes.forEach(checkbox => {\n        checkbox.checked = !allChecked;\n    });\n    \n    activeColumns = allChecked ? ['Organization', 'Average Score'] : allColumns;\n    updateTableHeader();\n    updateTable();\n}\n\nfunction toggleGroup(groupName) {\n    const columns = columnGroups[groupName];\n    const allChecked = columns.every(col => activeColumns.includes(col));\n    \n    const groupCheckboxes = document.querySelectorAll(`#columnToggle input[type=\"checkbox\"]`);\n    groupCheckboxes.forEach(checkbox => {\n        if (columns.includes(checkbox.value)) {\n            checkbox.checked = !allChecked;\n        }\n    });\n    \n    if (allChecked) {\n        activeColumns = activeColumns.filter(col => !columns.includes(col));\n    } else {\n        activeColumns = [...new Set([...activeColumns, ...columns])];\n    }\n    \n    updateTableHeader();\n    updateTable();\n}\n\n// Replace the column toggle creation in initializeTable with this:\nfunction initializeTable() {\n    createColumnToggles();\n    updateTableHeader();\n    sortedData = [...processedData];\n    updateTable();\n    updateMetricCards();\n}\n</antArtifact>\n\nKey improvements made:\n\n1. Added a proper table container with horizontal scrolling\n2. Organized columns into logical groups:\n   - Basic Info\n   - Key Metrics\n   - Selection Criteria\n3. Added three levels of column toggling:\n   - Toggle All Columns\n   - Toggle Group (for each group)\n   - Individual column toggles\n4. Improved the visual styling of the toggle section with:\n   - Group containers\n   - Clear headers\n   - Responsive grid layout for checkboxes\n5. Fixed the table overflow issue by containing it within a scrollable container\n6. Maintained the fixed Organization column while allowing horizontal scrolling\n7. Kept the base columns (Organization, Average Score) when toggling all off\n\nThe table will now scroll horizontally within its white container instead of extending into the gray background, and users have more organized control over which columns to display.\n\nWould you like me to make any adjustments to the grouping or styling?",
      "created_at": "2024-12-02T08:51:52.755940Z",
      "sequence_order": 5,
      "metadata": {
        "content": [
          {
            "start_timestamp": null,
            "stop_timestamp": null,
            "flags": null,
            "type": "text",
            "text": " I'll help improve the code with those changes. Let me make the modifications:\n\n\n\n<antArtifact identifier=\"data-viewer\" type=\"application/vnd.ant.code\" language=\"html\" title=\"Updated Data Viewer with Toggle Groups\">\n// Add these styles in the <style> section\n.table-container {\n    overflow-x: auto;\n    background: white;\n    border-radius: 8px;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n    margin-top: 20px;\n}\n\n.column-toggle {\n    background: white;\n    padding: 15px;\n    border-radius: 8px;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n}\n\n.toggle-group {\n    margin-bottom: 15px;\n    padding: 10px;\n    border: 1px solid #e2e8f0;\n    border-radius: 6px;\n}\n\n.toggle-group-header {\n    font-weight: bold;\n    margin-bottom: 10px;\n    color: #2d3748;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n}\n\n.toggle-group-content {\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\n    gap: 8px;\n}\n\n.toggle-all-btn {\n    background: #4a5568;\n    color: white;\n    padding: 4px 8px;\n    border-radius: 4px;\n    font-size: 12px;\n    cursor: pointer;\n}\n\n.toggle-all-btn:hover {\n    background: #2d3748;\n}\n</antArtifact>\n\nNow let's add the JavaScript logic for the toggle groups:\n\n<antArtifact identifier=\"toggle-logic\" type=\"application/vnd.ant.code\" language=\"javascript\" title=\"Toggle Groups Logic\">\n// Add this before the initializeTable function\nconst columnGroups = {\n    'Selection Criteria': [\n        'Organizational Capacity',\n        'Experience in Similar Projects',\n        'Alignment with Program Goals',\n        'Ability to Reach Target Audience',\n        'Capacity to Deliver Training',\n        'Willingness & Ability to Collaborate'\n    ],\n    'Key Metrics': [\n        'Total Followers',\n        'Total # Employees',\n        'Num Training Programs(3 years)',\n        'Training Impact Ratio',\n        'Efficiency',\n        'Social Media Reach Per Employee'\n    ],\n    'Basic Info': [\n        'Organization',\n        'Average Score',\n        'Topics Covered',\n        'Areas Operating'\n    ]\n};\n\n// Update the initializeTable function's column toggle creation\nfunction createColumnToggles() {\n    const columnToggle = document.getElementById('columnToggle');\n    columnToggle.innerHTML = ''; // Clear existing content\n\n    // Add master toggle all button\n    const masterToggleDiv = document.createElement('div');\n    masterToggleDiv.className = 'toggle-group';\n    masterToggleDiv.innerHTML = `\n        <div class=\"toggle-group-header\">\n            <span>All Columns</span>\n            <button class=\"toggle-all-btn\" onclick=\"toggleAllColumns()\">Toggle All</button>\n        </div>\n    `;\n    columnToggle.appendChild(masterToggleDiv);\n\n    // Create toggle groups\n    Object.entries(columnGroups).forEach(([groupName, columns]) => {\n        const groupDiv = document.createElement('div');\n        groupDiv.className = 'toggle-group';\n        \n        groupDiv.innerHTML = `\n            <div class=\"toggle-group-header\">\n                <span>${groupName}</span>\n                <button class=\"toggle-all-btn\" onclick=\"toggleGroup('${groupName}')\">Toggle Group</button>\n            </div>\n            <div class=\"toggle-group-content\">\n                ${columns.map(column => `\n                    <label>\n                        <input type=\"checkbox\" \n                               value=\"${column}\" \n                               ${defaultColumns.includes(column) ? 'checked' : ''}\n                               onchange=\"handleColumnToggle(event)\">\n                        ${column}\n                    </label>\n                `).join('')}\n            </div>\n        `;\n        columnToggle.appendChild(groupDiv);\n    });\n}\n\n// Add these new functions\nfunction toggleAllColumns() {\n    const allColumns = [...new Set(Object.values(columnGroups).flat())];\n    const allChecked = allColumns.every(col => activeColumns.includes(col));\n    \n    const checkboxes = document.querySelectorAll('#columnToggle input[type=\"checkbox\"]');\n    checkboxes.forEach(checkbox => {\n        checkbox.checked = !allChecked;\n    });\n    \n    activeColumns = allChecked ? ['Organization', 'Average Score'] : allColumns;\n    updateTableHeader();\n    updateTable();\n}\n\nfunction toggleGroup(groupName) {\n    const columns = columnGroups[groupName];\n    const allChecked = columns.every(col => activeColumns.includes(col));\n    \n    const groupCheckboxes = document.querySelectorAll(`#columnToggle input[type=\"checkbox\"]`);\n    groupCheckboxes.forEach(checkbox => {\n        if (columns.includes(checkbox.value)) {\n            checkbox.checked = !allChecked;\n        }\n    });\n    \n    if (allChecked) {\n        activeColumns = activeColumns.filter(col => !columns.includes(col));\n    } else {\n        activeColumns = [...new Set([...activeColumns, ...columns])];\n    }\n    \n    updateTableHeader();\n    updateTable();\n}\n\n// Replace the column toggle creation in initializeTable with this:\nfunction initializeTable() {\n    createColumnToggles();\n    updateTableHeader();\n    sortedData = [...processedData];\n    updateTable();\n    updateMetricCards();\n}\n</antArtifact>\n\nKey improvements made:\n\n1. Added a proper table container with horizontal scrolling\n2. Organized columns into logical groups:\n   - Basic Info\n   - Key Metrics\n   - Selection Criteria\n3. Added three levels of column toggling:\n   - Toggle All Columns\n   - Toggle Group (for each group)\n   - Individual column toggles\n4. Improved the visual styling of the toggle section with:\n   - Group containers\n   - Clear headers\n   - Responsive grid layout for checkboxes\n5. Fixed the table overflow issue by containing it within a scrollable container\n6. Maintained the fixed Organization column while allowing horizontal scrolling\n7. Kept the base columns (Organization, Average Score) when toggling all off\n\nThe table will now scroll horizontally within its white container instead of extending into the gray background, and users have more organized control over which columns to display.\n\nWould you like me to make any adjustments to the grouping or styling?",
            "citations": []
          }
        ],
        "updated_at": "2024-12-02T08:51:52.755940Z",
        "attachments": [],
        "files": []
      }
    },
    {
      "id": "bad74a87-df64-4632-a7a1-6ec72e4fa72b",
      "role": "human",
      "content": "The organization name should not be toggleable \nnor the average score\n* keep those two as the first two columns \nThe organization column has a white background unlike the blue of the rest and is impossible to see\n\nThe table also still overflows",
      "created_at": "2024-12-02T08:55:41.478487Z",
      "sequence_order": 6,
      "metadata": {
        "content": [
          {
            "start_timestamp": null,
            "stop_timestamp": null,
            "flags": null,
            "type": "text",
            "text": "The organization name should not be toggleable \nnor the average score\n* keep those two as the first two columns \nThe organization column has a white background unlike the blue of the rest and is impossible to see\n\nThe table also still overflows",
            "citations": []
          }
        ],
        "updated_at": "2024-12-02T08:55:41.478487Z",
        "attachments": [
          {
            "file_name": "paste.txt",
            "file_size": 32009,
            "file_type": "txt",
            "extracted_content": "<!DOCTYPE html>\n<html>\n<head>\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.19/lodash.min.js\"></script>\n    <style>\n        /* Previous styles remain */\n        body {\n            font-family: system-ui, -apple-system, sans-serif;\n            margin: 20px;\n            background: #f5f5f5;\n        }\n        .container {\n            background: white;\n            border-radius: 8px;\n            padding: 20px;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n            max-width: 1400px;\n            margin: 0 auto;\n        }\n        .metric-cards {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n            gap: 20px;\n            margin-bottom: 20px;\n        }\n        .metric-card {\n            background: white;\n            padding: 15px;\n            border-radius: 8px;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.05);\n        }\n        .metric-card h3 {\n            margin: 0 0 10px 0;\n            color: #4a5568;\n            font-size: 14px;\n        }\n        .metric-card .value {\n            font-size: 24px;\n            font-weight: bold;\n            color: #2d3748;\n        }\n        .controls {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n            gap: 10px;\n            margin: 20px 0;\n        }\n        select, input, button {\n            padding: 8px 12px;\n            border: 1px solid #e2e8f0;\n            border-radius: 6px;\n            font-size: 14px;\n        }\n        button {\n            background: #4a5568;\n            color: white;\n            border: none;\n            cursor: pointer;\n        }\n        button:hover {\n            background: #2d3748;\n        }\n        .modal {\n            display: none;\n            position: fixed;\n            top: 0;\n            left: 0;\n            right: 0;\n            bottom: 0;\n            background: rgba(0,0,0,0.5);\n            padding: 20px;\n        }\n        .modal-content {\n            background: white;\n            padding: 20px;\n            border-radius: 8px;\n            max-width: 800px;\n            margin: 40px auto;\n            max-height: 80vh;\n            overflow-y: auto;\n        }\n        .close {\n            float: right;\n            font-size: 20px;\n            cursor: pointer;\n        }\n        .column-toggle {\n            display: flex;\n            flex-wrap: wrap;\n            gap: 10px;\n            margin: 10px 0;\n        }\n        .column-toggle label {\n            display: flex;\n            align-items: center;\n            gap: 5px;\n        }\n        table {\n            width: 100%;\n            border-collapse: collapse;\n            margin-top: 20px;\n        }\n        th, td {\n            padding: 12px;\n            text-align: left;\n            border-bottom: 1px solid #e2e8f0;\n        }\n        th {\n            background: #2d3748;\n            color: white;\n            position: sticky;\n            top: 0;\n            cursor: pointer;\n        }\n\n\n        .fixed-column {\n            position: sticky;\n            left: 0;\n            background: white;\n            z-index: 10;\n            border-right: 2px solid #e2e8f0;\n        }\n\n        th[title] {\n            cursor: help;\n        }\n\n        .tooltip:hover::after {\n            content: attr(title);\n            position: absolute;\n            bottom: 100%;\n            left: 50%;\n            transform: translateX(-50%);\n            padding: 8px;\n            background: #2d3748;\n            color: white;\n            border-radius: 4px;\n            font-size: 14px;\n            white-space: nowrap;\n            z-index: 20;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h1>Implementing Partners Overview</h1>\n        \n        <div class=\"metric-cards\">\n            <div class=\"metric-card\">\n                <h3>Total Organizations</h3>\n                <div class=\"value\" id=\"totalOrgs\">-</div>\n            </div>\n            <div class=\"metric-card\">\n                <h3>Average Score</h3>\n                <div class=\"value\" id=\"avgScore\">-</div>\n            </div>\n            <div class=\"metric-card\">\n                <h3>Total Employees</h3>\n                <div class=\"value\" id=\"totalEmployees\">-</div>\n            </div>\n            <div class=\"metric-card\">\n                <h3>Total Trainees</h3>\n                <div class=\"value\" id=\"totalTrainees\">-</div>\n            </div>\n        </div>\n\n        <div class=\"controls\">\n            <input type=\"text\" id=\"search\" placeholder=\"Search organizations...\">\n            <button id=\"exportBtn\">Export to CSV</button>\n            <button id=\"toggleColumns\">Toggle Columns</button>\n        </div>\n\n        <div class=\"column-toggle\" id=\"columnToggle\" style=\"display: none;\">\n            <!-- Will be populated dynamically -->\n        </div>\n\n        <div class=\"table-container\">\n            <table id=\"partnersTable\">\n                <thead>\n                    <!-- Will be populated dynamically -->\n                </thead>\n                <tbody></tbody>\n            </table>\n        </div>\n    </div>\n\n    <div id=\"detailModal\" class=\"modal\">\n        <div class=\"modal-content\">\n            <span class=\"close\">&times;</span>\n            <div id=\"modalContent\"></div>\n        </div>\n    </div>\n\n    <script>\n\nconst rawData = [\n    {\n        // Base Information\n        \"Organization\": \"Mosul Space\",\n        \"Year of Establishment\": 2014,\n        \"Total # Employees\": 14,\n        \"Average Score\": 4.95,\n        \"Topics Covered\": \"Sustainable Construction, Renewable Energy, Financial Literacy, Entrepreneurship, Technical Skills, Soft Skills, Media, Advocacy\",\n        \"Areas Operating\": \"Ninewa Governorate\",\n        \n        // Detailed Metrics\n        \"Number Full-Time Employees\": 12,\n        \"Number Part-Time Employees\": 2,\n        \"Number of Instagram Followers\": 18800,\n        \"Number of LinkedIn Followers\": 2000,\n        \"Total Followers\": 20800,\n        \"Estimated Number of People Reached Social media\": 1500000,\n        \"Percent Youth\": 95,\n        \"Percent Woman\": 40,\n        \"Percent Marginalized\": 15,\n        \"Num Training Programs(3 years)\": 25,\n        \"Estimated Number Trainees\": 3000,\n        \"Key Staff Years Of Experience\": 11,\n        \"Number of Topics\": 8,\n        \"Number of Areas Operating\": 1,\n\n        // Evaluation Scores\n        \"Organizational Capacity\": 4.67,\n        \"Experience in Similar Projects\": 5.00,\n        \"Alignment with Program Goals\": 5.00,\n        \"Ability to Reach Target Audience\": 5.00,\n        \"Capacity to Deliver Training\": 5.00,\n        \"Willingness & Ability to Collaborate\": 4.95,\n        \n        // Calculated Metrics\n        \"Efficiency\": 1.79, // 25 programs / 14 employees\n        \"Social Media Reach Per Employee\": 107142.86, // 1500000 / 14\n        \"Training Impact Ratio\": 214.29, // 3000 / 14\n        \"Youth Engagement Score\": 665.25 // (95 * 14 * 4.95) / 100\n    },\n    {\n        \"Organization\": \"Makers of Baghdad\",\n        \"Year of Establishment\": 2016,\n        \"Total # Employees\": 22,\n        \"Average Score\": 4.84,\n        \"Topics Covered\": \"Sustainable Construction, Renewable Energy, Financial Literacy, Entrepreneurship, Technical Skills, Soft Skills, Graphic Design\",\n        \"Areas Operating\": \"Baghdad, Anbar, Diwaniya, Babil, Karbala, Najaf\",\n        \n        \"Number Full-Time Employees\": 12,\n        \"Number Part-Time Employees\": 10,\n        \"Number of Instagram Followers\": 55400,\n        \"Number of LinkedIn Followers\": 2000,\n        \"Total Followers\": 57400,\n        \"Estimated Number of People Reached Social media\": 3500000,\n        \"Percent Youth\": 100,\n        \"Percent Woman\": 47,\n        \"Percent Marginalized\": 1,\n        \"Num Training Programs(3 years)\": 204,\n        \"Estimated Number Trainees\": 0,\n        \"Key Staff Years Of Experience\": 6,\n        \"Number of Topics\": 11,\n        \"Number of Areas Operating\": 5,\n\n        \"Organizational Capacity\": 4.67,\n        \"Experience in Similar Projects\": 4.67,\n        \"Alignment with Program Goals\": 5.00,\n        \"Ability to Reach Target Audience\": 5.00,\n        \"Capacity to Deliver Training\": 4.67,\n        \"Willingness & Ability to Collaborate\": 4.84,\n        \n        \"Efficiency\": 9.27, // 204 programs / 22 employees\n        \"Social Media Reach Per Employee\": 159090.91, // 3500000 / 22\n        \"Training Impact Ratio\": 0, // No trainees reported\n        \"Youth Engagement Score\": 1064.80 // (100 * 22 * 4.84) / 100\n    },\n        {\n        \"Organization\": \"Mosul Heritage Foundation\",\n        \"Year of Establishment\": 2022,\n        \"Total # Employees\": 13,\n        \"Average Score\": 4.42,\n        \"Topics Covered\": \"Sustainable Construction, Entrepreneurship, Soft Skills\",\n        \"Areas Operating\": \"Ninewa Governorate\",\n        \n        \"Number Full-Time Employees\": 9,\n        \"Number Part-Time Employees\": 4,\n        \"Number of Instagram Followers\": 22100,\n        \"Number of LinkedIn Followers\": 220,\n        \"Total Followers\": 22320,\n        \"Estimated Number of People Reached Social media\": 2000000,\n        \"Percent Youth\": 40,\n        \"Percent Woman\": 45,\n        \"Percent Marginalized\": 5,\n        \"Num Training Programs(3 years)\": 4,\n        \"Estimated Number Trainees\": 50,\n        \"Key Staff Years Of Experience\": 20,\n        \"Number of Topics\": 3,\n        \"Number of Areas Operating\": 1,\n\n        \"Organizational Capacity\": 4.00,\n        \"Experience in Similar Projects\": 3.67,\n        \"Alignment with Program Goals\": 4.50,\n        \"Ability to Reach Target Audience\": 5.00,\n        \"Capacity to Deliver Training\": 4.67,\n        \"Willingness & Ability to Collaborate\": 4.42,\n        \n        \"Efficiency\": 0.31, // 4 programs / 13 employees\n        \"Social Media Reach Per Employee\": 153846.15,\n        \"Training Impact Ratio\": 3.85,\n        \"Youth Engagement Score\": 229.84\n    },\n    {\n        \"Organization\": \"Qaf Lab\",\n        \"Year of Establishment\": 2019,\n        \"Total # Employees\": 38,\n        \"Average Score\": 4.39,\n        \"Topics Covered\": \"Renewable Energy, Entrepreneurship, Technical Skills, Soft Skills, Media production, AC and HVAC systems\",\n        \"Areas Operating\": \"Ninewa Governorate\",\n        \n        \"Number Full-Time Employees\": 32,\n        \"Number Part-Time Employees\": 6,\n        \"Number of Instagram Followers\": 16800,\n        \"Number of LinkedIn Followers\": 3000,\n        \"Total Followers\": 19800,\n        \"Estimated Number of People Reached Social media\": 700000,\n        \"Percent Youth\": 80,\n        \"Percent Woman\": 30,\n        \"Percent Marginalized\": 20,\n        \"Num Training Programs(3 years)\": 20,\n        \"Estimated Number Trainees\": 200,\n        \"Key Staff Years Of Experience\": 6,\n        \"Number of Topics\": 6,\n        \"Number of Areas Operating\": 1,\n\n        \"Organizational Capacity\": 3.67,\n        \"Experience in Similar Projects\": 4.33,\n        \"Alignment with Program Goals\": 5.00,\n        \"Ability to Reach Target Audience\": 4.33,\n        \"Capacity to Deliver Training\": 4.67,\n        \"Willingness & Ability to Collaborate\": 4.39,\n        \n        \"Efficiency\": 0.53,\n        \"Social Media Reach Per Employee\": 18421.05,\n        \"Training Impact Ratio\": 5.26,\n        \"Youth Engagement Score\": 1334.56\n    },\n    {\n        \"Organization\": \"Kapita\",\n        \"Year of Establishment\": 2019,\n        \"Total # Employees\": 30,\n        \"Average Score\": 4.17,\n        \"Topics Covered\": \"N.A.\",\n        \"Areas Operating\": \"N.A.\",\n        \n        \"Number Full-Time Employees\": 30,\n        \"Number Part-Time Employees\": 0,\n        \"Number of Instagram Followers\": 18000,\n        \"Number of LinkedIn Followers\": 10000,\n        \"Total Followers\": 28000,\n        \"Estimated Number of People Reached Social media\": 28000,\n        \"Percent Youth\": 0,\n        \"Percent Woman\": 0,\n        \"Percent Marginalized\": 0,\n        \"Num Training Programs(3 years)\": 0,\n        \"Estimated Number Trainees\": 500,\n        \"Key Staff Years Of Experience\": 0,\n        \"Number of Topics\": 0,\n        \"Number of Areas Operating\": 0,\n\n        \"Organizational Capacity\": 3.67,\n        \"Experience in Similar Projects\": 4.00,\n        \"Alignment with Program Goals\": 5.00,\n        \"Ability to Reach Target Audience\": 3.67,\n        \"Capacity to Deliver Training\": 4.00,\n        \"Willingness & Ability to Collaborate\": 4.17,\n        \n        \"Efficiency\": 0,\n        \"Social Media Reach Per Employee\": 933.33,\n        \"Training Impact Ratio\": 16.67,\n        \"Youth Engagement Score\": 0\n    },\n    {\n        \"Organization\": \"Iraq Green Building Council\",\n        \"Year of Establishment\": 2021,\n        \"Total # Employees\": 3,\n        \"Average Score\": 4.00,\n        \"Topics Covered\": \"N.A.\",\n        \"Areas Operating\": \"N.A.\",\n        \n        \"Number Full-Time Employees\": 0,\n        \"Number Part-Time Employees\": 0,\n        \"Number of Instagram Followers\": 6900,\n        \"Number of LinkedIn Followers\": 172,\n        \"Total Followers\": 7072,\n        \"Estimated Number of People Reached Social media\": 0,\n        \"Percent Youth\": 0,\n        \"Percent Woman\": 0,\n        \"Percent Marginalized\": 0,\n        \"Num Training Programs(3 years)\": 0,\n        \"Estimated Number Trainees\": 0,\n        \"Key Staff Years Of Experience\": 0,\n        \"Number of Topics\": 0,\n        \"Number of Areas Operating\": 0,\n\n        \"Organizational Capacity\": 4.00,\n        \"Experience in Similar Projects\": 4.00,\n        \"Alignment with Program Goals\": 4.00,\n        \"Ability to Reach Target Audience\": 4.00,\n        \"Capacity to Deliver Training\": 4.00,\n        \"Willingness & Ability to Collaborate\": 4.00,\n        \n        \"Efficiency\": 0,\n        \"Social Media Reach Per Employee\": 0,\n        \"Training Impact Ratio\": 0,\n        \"Youth Engagement Score\": 0\n    },\n    {\n        \"Organization\": \"Rwanga Foundation\",\n        \"Year of Establishment\": 2013,\n        \"Total # Employees\": 93,\n        \"Average Score\": 4.00,\n        \"Topics Covered\": \"N.A.\",\n        \"Areas Operating\": \"N.A.\",\n        \n        \"Number Full-Time Employees\": 0,\n        \"Number Part-Time Employees\": 0,\n        \"Number of Instagram Followers\": 64800,\n        \"Number of LinkedIn Followers\": 15000,\n        \"Total Followers\": 79800,\n        \"Estimated Number of People Reached Social media\": 0,\n        \"Percent Youth\": 0,\n        \"Percent Woman\": 0,\n        \"Percent Marginalized\": 0,\n        \"Num Training Programs(3 years)\": 0,\n        \"Estimated Number Trainees\": 0,\n        \"Key Staff Years Of Experience\": 0,\n        \"Number of Topics\": 0,\n        \"Number of Areas Operating\": 0,\n\n        \"Organizational Capacity\": 4.00,\n        \"Experience in Similar Projects\": 4.00,\n        \"Alignment with Program Goals\": 4.00,\n        \"Ability to Reach Target Audience\": 4.00,\n        \"Capacity to Deliver Training\": 4.00,\n        \"Willingness & Ability to Collaborate\": 4.00,\n        \n        \"Efficiency\": 0,\n        \"Social Media Reach Per Employee\": 0,\n        \"Training Impact Ratio\": 0,\n        \"Youth Engagement Score\": 0\n    },\n    {\n        \"Organization\": \"Suli Innovation House\",\n        \"Year of Establishment\": 2022,\n        \"Total # Employees\": 9,\n        \"Average Score\": 3.67,\n        \"Topics Covered\": \"Renewable Energy, Entrepreneurship, Technical Skills, Soft Skills\",\n        \"Areas Operating\": \"Sulaymaniyah\",\n        \n        \"Number Full-Time Employees\": 6,\n        \"Number Part-Time Employees\": 3,\n        \"Number of Instagram Followers\": 9846,\n        \"Number of LinkedIn Followers\": 3421,\n        \"Total Followers\": 13267,\n        \"Estimated Number of People Reached Social media\": 400000,\n        \"Percent Youth\": 99,\n        \"Percent Woman\": 49,\n        \"Percent Marginalized\": 10,\n        \"Num Training Programs(3 years)\": 35,\n        \"Estimated Number Trainees\": 2000,\n        \"Key Staff Years Of Experience\": 10,\n        \"Number of Topics\": 4,\n        \"Number of Areas Operating\": 1,\n\n        \"Organizational Capacity\": 3.67,\n        \"Experience in Similar Projects\": 3.33,\n        \"Alignment with Program Goals\": 3.67,\n        \"Ability to Reach Target Audience\": 3.67,\n        \"Capacity to Deliver Training\": 4.00,\n        \"Willingness & Ability to Collaborate\": 3.67,\n        \n        \"Efficiency\": 3.89,\n        \"Social Media Reach Per Employee\": 44444.44,\n        \"Training Impact Ratio\": 222.22,\n        \"Youth Engagement Score\": 327.03\n    },\n    {\n        \"Organization\": \"The Station\",\n        \"Year of Establishment\": 2018,\n        \"Total # Employees\": 20,\n        \"Average Score\": 3.61,\n        \"Topics Covered\": \"Financial Literacy, Entrepreneurship, Technical Skills, Soft Skills\",\n        \"Areas Operating\": \"Ninewa Governorate, Erbil, Baghdad, Basra\",\n        \n        \"Number Full-Time Employees\": 18,\n        \"Number Part-Time Employees\": 2,\n        \"Number of Instagram Followers\": 111000,\n        \"Number of LinkedIn Followers\": 45000,\n        \"Total Followers\": 156000,\n        \"Estimated Number of People Reached Social media\": 200000,\n        \"Percent Youth\": 50,\n        \"Percent Woman\": 45,\n        \"Percent Marginalized\": 10,\n        \"Num Training Programs(3 years)\": 10,\n        \"Estimated Number Trainees\": 5000,\n        \"Key Staff Years Of Experience\": 0,\n        \"Number of Topics\": 4,\n        \"Number of Areas Operating\": 4,\n\n        \"Organizational Capacity\": 3.67,\n        \"Experience in Similar Projects\": 3.00,\n        \"Alignment with Program Goals\": 3.33,\n        \"Ability to Reach Target Audience\": 4.00,\n        \"Capacity to Deliver Training\": 3.67,\n        \"Willingness & Ability to Collaborate\": 3.61,\n        \n        \"Efficiency\": 0.5,\n        \"Social Media Reach Per Employee\": 10000,\n        \"Training Impact Ratio\": 250,\n        \"Youth Engagement Score\": 361\n    },\n    {\n        \"Organization\": \"51Labs\",\n        \"Year of Establishment\": 2017,\n        \"Total # Employees\": 22,\n        \"Average Score\": 3.50,\n        \"Topics Covered\": \"Financial Literacy, Entrepreneurship, Soft Skills\",\n        \"Areas Operating\": \"Erbil\",\n        \n        \"Number Full-Time Employees\": 20,\n        \"Number Part-Time Employees\": 2,\n        \"Number of Instagram Followers\": 11500,\n        \"Number of LinkedIn Followers\": 10140,\n        \"Total Followers\": 21640,\n        \"Estimated Number of People Reached Social media\": 500,\n        \"Percent Youth\": 70,\n        \"Percent Woman\": 40,\n        \"Percent Marginalized\": 20,\n        \"Num Training Programs(3 years)\": 10,\n        \"Estimated Number Trainees\": 0,\n        \"Key Staff Years Of Experience\": 0,\n        \"Number of Topics\": 3,\n        \"Number of Areas Operating\": 1,\n\n        \"Organizational Capacity\": 3.67,\n        \"Experience in Similar Projects\": 3.33,\n        \"Alignment with Program Goals\": 3.67,\n        \"Ability to Reach Target Audience\": 3.00,\n        \"Capacity to Deliver Training\": 3.67,\n        \"Willingness & Ability to Collaborate\": 3.50,\n        \n        \"Efficiency\": 0.45,\n        \"Social Media Reach Per Employee\": 22.73,\n        \"Training Impact Ratio\": 0,\n        \"Youth Engagement Score\": 539\n    }\n];\n        // Process data and remove Youth Engagement Score\n        const processedData = rawData.map(org => {\n            const processed = {...org};\n            delete processed[\"Youth Engagement Score\"];\n            return {\n                ...processed,\n                \"Efficiency\": isFinite(org[\"Efficiency\"]) ? org[\"Efficiency\"] : 0,\n                \"Social Media Reach Per Employee\": isFinite(org[\"Social Media Reach Per Employee\"]) ? org[\"Social Media Reach Per Employee\"] : 0,\n                \"Training Impact Ratio\": isFinite(org[\"Training Impact Ratio\"]) ? org[\"Training Impact Ratio\"] : 0\n            };\n        });\n\n        // Calculate statistics\n  const stats = {\n            totalEmployees: processedData.reduce((sum, org) => sum + (org[\"Total # Employees\"] || 0), 0),\n            totalTrainees: processedData.reduce((sum, org) => sum + (org[\"Estimated Number Trainees\"] || 0), 0),\n            averageScore: (processedData.reduce((sum, org) => sum + (org[\"Average Score\"] || 0), 0) / processedData.length).toFixed(2)\n        };\n        function formatCell(value) {\n            if (value === null || value === undefined || value === '') return 'N.A.';\n            if (typeof value === 'number') {\n                if (value > 1000) return value.toLocaleString();\n                if (value % 1 !== 0) return value.toFixed(2);\n            }\n            return value;\n        }\n\n        function getScoreClass(score) {\n            if (!score) return '';\n            if (score >= 4.5) return 'high-score';\n            if (score >= 3.5) return 'medium-score';\n            return 'low-score';\n        }\n\n        // Initialize the table when the document is ready\n        document.addEventListener('DOMContentLoaded', () => {\n            initializeTable();\n        });\n\n        // Define which columns to show by default\n        const defaultColumns = [\n            \"Organization\",\n            \"Average Score\",\n            \"Total Followers\",\n            \"Total # Employees\",\n            \"Num Training Programs(3 years)\",\n            \"Training Impact Ratio\",\n            \"Efficiency\",\n            \"Social Media Reach Per Employee\",\n            \"Topics Covered\",\n            \"Areas Operating\"\n        ];\n\n        // Define tooltips for calculated metrics\n        const columnTooltips = {\n            \"Training Impact Ratio\": \"Calculated as: Estimated Number Trainees / Total # Employees\",\n            \"Efficiency\": \"Calculated as: Number of Training Programs / Total # Employees\",\n            \"Social Media Reach Per Employee\": \"Calculated as: Estimated Number of People Reached Social media / Total # Employees\"\n        };\n\n        let activeColumns = [...defaultColumns];\n        let sortedData = [];\n\n        const columnGroups = {\n    'Selection Criteria': [\n        'Organizational Capacity',\n        'Experience in Similar Projects',\n        'Alignment with Program Goals',\n        'Ability to Reach Target Audience',\n        'Capacity to Deliver Training',\n        'Willingness & Ability to Collaborate'\n    ],\n    'Key Metrics': [\n        'Total Followers',\n        'Total # Employees',\n        'Num Training Programs(3 years)',\n        'Training Impact Ratio',\n        'Efficiency',\n        'Social Media Reach Per Employee'\n    ],\n    'Basic Info': [\n        'Organization',\n        'Average Score',\n        'Topics Covered',\n        'Areas Operating'\n    ]\n};\n\n// Update the initializeTable function's column toggle creation\nfunction createColumnToggles() {\n    const columnToggle = document.getElementById('columnToggle');\n    columnToggle.innerHTML = ''; // Clear existing content\n\n    // Add master toggle all button\n    const masterToggleDiv = document.createElement('div');\n    masterToggleDiv.className = 'toggle-group';\n    masterToggleDiv.innerHTML = `\n        <div class=\"toggle-group-header\">\n            <span>All Columns</span>\n            <button class=\"toggle-all-btn\" onclick=\"toggleAllColumns()\">Toggle All</button>\n        </div>\n    `;\n    columnToggle.appendChild(masterToggleDiv);\n\n    // Create toggle groups\n    Object.entries(columnGroups).forEach(([groupName, columns]) => {\n        const groupDiv = document.createElement('div');\n        groupDiv.className = 'toggle-group';\n        \n        groupDiv.innerHTML = `\n            <div class=\"toggle-group-header\">\n                <span>${groupName}</span>\n                <button class=\"toggle-all-btn\" onclick=\"toggleGroup('${groupName}')\">Toggle Group</button>\n            </div>\n            <div class=\"toggle-group-content\">\n                ${columns.map(column => `\n                    <label>\n                        <input type=\"checkbox\" \n                               value=\"${column}\" \n                               ${defaultColumns.includes(column) ? 'checked' : ''}\n                               onchange=\"handleColumnToggle(event)\">\n                        ${column}\n                    </label>\n                `).join('')}\n            </div>\n        `;\n        columnToggle.appendChild(groupDiv);\n    });\n}\n\n// Add these new functions\nfunction toggleAllColumns() {\n    const allColumns = [...new Set(Object.values(columnGroups).flat())];\n    const allChecked = allColumns.every(col => activeColumns.includes(col));\n    \n    const checkboxes = document.querySelectorAll('#columnToggle input[type=\"checkbox\"]');\n    checkboxes.forEach(checkbox => {\n        checkbox.checked = !allChecked;\n    });\n    \n    activeColumns = allChecked ? ['Organization', 'Average Score'] : allColumns;\n    updateTableHeader();\n    updateTable();\n}\n\nfunction toggleGroup(groupName) {\n    const columns = columnGroups[groupName];\n    const allChecked = columns.every(col => activeColumns.includes(col));\n    \n    const groupCheckboxes = document.querySelectorAll(`#columnToggle input[type=\"checkbox\"]`);\n    groupCheckboxes.forEach(checkbox => {\n        if (columns.includes(checkbox.value)) {\n            checkbox.checked = !allChecked;\n        }\n    });\n    \n    if (allChecked) {\n        activeColumns = activeColumns.filter(col => !columns.includes(col));\n    } else {\n        activeColumns = [...new Set([...activeColumns, ...columns])];\n    }\n    \n    updateTableHeader();\n    updateTable();\n}\n\n// Replace the column toggle creation in initializeTable with this:\nfunction initializeTable() {\n    createColumnToggles();\n    updateTableHeader();\n    sortedData = [...processedData];\n    updateTable();\n    updateMetricCards();\n}\n\n        function updateMetricCards() {\n            document.getElementById('totalOrgs').textContent = processedData.length;\n            document.getElementById('avgScore').textContent = stats.averageScore;\n            document.getElementById('totalEmployees').textContent = stats.totalEmployees.toLocaleString();\n            document.getElementById('totalTrainees').textContent = stats.totalTrainees.toLocaleString();\n        }\n\n        function handleColumnToggle(e) {\n            const column = e.target.value;\n            if (e.target.checked) {\n                activeColumns.push(column);\n            } else {\n                activeColumns = activeColumns.filter(col => col !== column);\n            }\n            updateTableHeader();\n            updateTable();\n        }\n\n\n        function updateTableHeader() {\n            const thead = document.querySelector('thead');\n            thead.innerHTML = `\n                <tr>\n                    ${activeColumns.map((col, index) => `\n                        <th \n                            onclick=\"sortBy('${col}')\" \n                            class=\"${col === 'Organization' ? 'fixed-column' : ''} tooltip\"\n                            ${columnTooltips[col] ? `title=\"${columnTooltips[col]}\"` : ''}\n                        >\n                            ${col}\n                        </th>\n                    `).join('')}\n                    <th>Actions</th>\n                </tr>\n            `;\n        }\n\n        function updateTable() {\n            const tbody = document.querySelector('tbody');\n            tbody.innerHTML = '';\n            \n            sortedData.forEach(org => {\n                const row = document.createElement('tr');\n                row.innerHTML = `\n                    ${activeColumns.map((col, index) => `\n                        <td class=\"${col === 'Organization' ? 'fixed-column' : ''} \n                                  ${col === 'Average Score' ? getScoreClass(org[col]) : ''}\">\n                            ${formatCell(org[col])}\n                        </td>\n                    `).join('')}\n                    <td>\n                        <button onclick=\"showDetails('${org.Organization}')\">Details</button>\n                    </td>\n                `;\n                tbody.appendChild(row);\n            });\n        }\n\n\n        function showDetails(orgName) {\n            const org = processedData.find(o => o.Organization === orgName);\n            const modal = document.getElementById('detailModal');\n            const content = document.getElementById('modalContent');\n            \n            content.innerHTML = `\n                <h2>${org.Organization}</h2>\n                <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;\">\n                    ${Object.entries(org)\n                        .map(([key, value]) => `\n                            <div>\n                                <strong>${key}:</strong>\n                                <div>${formatCell(value)}</div>\n                            </div>\n                        `).join('')}\n                </div>\n            `;\n            \n            modal.style.display = 'block';\n        }\n\n        // Event Listeners\n        document.querySelector('.close').onclick = () => {\n            document.getElementById('detailModal').style.display = 'none';\n        };\n\n        document.getElementById('toggleColumns').onclick = () => {\n            const columnToggle = document.getElementById('columnToggle');\n            columnToggle.style.display = columnToggle.style.display === 'none' ? 'flex' : 'none';\n        };\n\n        document.getElementById('filterField').addEventListener('change', (e) => {\n            const filterValue = e.target.value;\n            if (!filterValue) {\n                sortedData = [...processedData];\n            } else {\n                sortedData = processedData.filter(org => {\n                    switch(filterValue) {\n                        case 'hasYouth': return org['Percent Youth'] > 0;\n                        case 'hasWomen': return org['Percent Woman'] > 0;\n                        case 'hasTraining': return org['Num Training Programs(3 years)'] > 0;\n                        default: return true;\n                    }\n                });\n            }\n            updateTable();\n        });\n\n        document.getElementById('search').addEventListener('input', (e) => {\n            const searchTerm = e.target.value.toLowerCase();\n            sortedData = processedData.filter(org => \n                Object.values(org).some(value => \n                    String(value).toLowerCase().includes(searchTerm)\n                )\n            );\n            updateTable();\n        });\n\n        document.getElementById('exportBtn').addEventListener('click', () => {\n            const csv = [\n                activeColumns.join(','),\n                ...sortedData.map(org => \n                    activeColumns.map(col => JSON.stringify(org[col] || '')).join(',')\n                )\n            ].join('\\n');\n\n            const blob = new Blob([csv], { type: 'text/csv' });\n            const url = window.URL.createObjectURL(blob);\n            const a = document.createElement('a');\n            a.setAttribute('hidden', '');\n            a.setAttribute('href', url);\n            a.setAttribute('download', 'partners_data.csv');\n            document.body.appendChild(a);\n            a.click();\n            document.body.removeChild(a);\n        });\n\n        function sortBy(field) {\n            sortedData.sort((a, b) => {\n                const aVal = a[field];\n                const bVal = b[field];\n                if (typeof aVal === 'string') {\n                    return aVal.localeCompare(bVal);\n                }\n                return bVal - aVal;\n            });\n            updateTable();\n        }\n       let sortDirection = 'desc';\n        function sortBy(field) {\n            sortDirection = sortDirection === 'desc' ? 'asc' : 'desc';\n            sortedData.sort((a, b) => {\n                const aVal = a[field] ?? '';\n                const bVal = b[field] ?? '';\n                if (typeof aVal === 'string') {\n                    return sortDirection === 'desc' \n                        ? bVal.localeCompare(aVal) \n                        : aVal.localeCompare(bVal);\n                }\n                return sortDirection === 'desc' \n                    ? bVal - aVal \n                    : aVal - bVal;\n            });\n            updateTable();\n        }\n        // Initialize\n        initializeTable();\n    </script>\n</body>\n</html>"
          }
        ],
        "files": [
          {
            "file_name": "paste.txt"
          }
        ]
      }
    },
    {
      "id": "f1c98713-04b8-41c4-9dff-d42fb56c5ee4",
      "role": "assistant",
      "content": " I'll help fix these issues. Here are the key changes needed:\n\n<antArtifact identifier=\"data-viewer-fixes\" type=\"application/vnd.ant.code\" language=\"css\" title=\"CSS Fixes\">\n/* Add/modify these styles in the style section */\n.table-container {\n    overflow-x: auto;\n    background: white;\n    border-radius: 8px;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n    margin-top: 20px;\n    max-width: 100%;\n}\n\n/* Fixed column styling */\n.fixed-column {\n    position: sticky;\n    left: 0;\n    z-index: 10;\n}\n\nth.fixed-column {\n    background: #2d3748;\n    z-index: 11; /* Higher than td fixed columns */\n    border-right: 2px solid #4a5568;\n}\n\ntd.fixed-column {\n    background: #2d3748;\n    color: white;\n    border-right: 2px solid #4a5568;\n}\n\n/* Toggle groups styling */\n.toggle-group {\n    background: white;\n    padding: 15px;\n    border-radius: 8px;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n    margin-bottom: 10px;\n}\n</antArtifact>\n\nAnd here's the JavaScript modifications:\n\n<antArtifact identifier=\"data-viewer-logic\" type=\"application/vnd.ant.code\" language=\"javascript\" title=\"JavaScript Fixes\">\n// Modify the columnGroups object - remove Organization and Average Score from Basic Info\nconst columnGroups = {\n    'Selection Criteria': [\n        'Organizational Capacity',\n        'Experience in Similar Projects',\n        'Alignment with Program Goals',\n        'Ability to Reach Target Audience',\n        'Capacity to Deliver Training',\n        'Willingness & Ability to Collaborate'\n    ],\n    'Key Metrics': [\n        'Total Followers',\n        'Total # Employees',\n        'Num Training Programs(3 years)',\n        'Training Impact Ratio',\n        'Efficiency',\n        'Social Media Reach Per Employee'\n    ],\n    'Basic Info': [\n        'Topics Covered',\n        'Areas Operating'\n    ]\n};\n\n// Modify the toggleAllColumns function\nfunction toggleAllColumns() {\n    const allColumns = [...new Set(Object.values(columnGroups).flat())];\n    const allChecked = allColumns.every(col => activeColumns.includes(col));\n    \n    const checkboxes = document.querySelectorAll('#columnToggle input[type=\"checkbox\"]');\n    checkboxes.forEach(checkbox => {\n        checkbox.checked = !allChecked;\n    });\n    \n    // Always keep Organization and Average Score\n    activeColumns = allChecked ? ['Organization', 'Average Score'] : ['Organization', 'Average Score', ...allColumns];\n    updateTableHeader();\n    updateTable();\n}\n\n// Modify the handleColumnToggle function\nfunction handleColumnToggle(e) {\n    const column = e.target.value;\n    if (e.target.checked) {\n        activeColumns = ['Organization', 'Average Score', ...activeColumns.filter(col => \n            col !== 'Organization' && col !== 'Average Score'), column];\n    } else {\n        activeColumns = ['Organization', 'Average Score', \n            ...activeColumns.filter(col => col !== column && col !== 'Organization' && col !== 'Average Score')];\n    }\n    updateTableHeader();\n    updateTable();\n}\n\n// Modify the updateTableHeader function\nfunction updateTableHeader() {\n    const thead = document.querySelector('thead');\n    thead.innerHTML = `\n        <tr>\n            <th class=\"fixed-column tooltip\">Organization</th>\n            <th class=\"tooltip\">Average Score</th>\n            ${activeColumns\n                .filter(col => col !== 'Organization' && col !== 'Average Score')\n                .map(col => `\n                    <th class=\"tooltip\" \n                        onclick=\"sortBy('${col}')\"\n                        ${columnTooltips[col] ? `title=\"${columnTooltips[col]}\"` : ''}>\n                        ${col}\n                    </th>\n                `).join('')}\n            <th>Actions</th>\n        </tr>\n    `;\n}\n\n// Modify the updateTable function\nfunction updateTable() {\n    const tbody = document.querySelector('tbody');\n    tbody.innerHTML = '';\n    \n    sortedData.forEach(org => {\n        const row = document.createElement('tr');\n        row.innerHTML = `\n            <td class=\"fixed-column\">${formatCell(org['Organization'])}</td>\n            <td class=\"${getScoreClass(org['Average Score'])}\">${formatCell(org['Average Score'])}</td>\n            ${activeColumns\n                .filter(col => col !== 'Organization' && col !== 'Average Score')\n                .map(col => `\n                    <td>${formatCell(org[col])}</td>\n                `).join('')}\n            <td>\n                <button onclick=\"showDetails('${org.Organization}')\">Details</button>\n            </td>\n        `;\n        tbody.appendChild(row);\n    });\n}\n</antArtifact>\n\nThese changes will:\n1. Fix the table overflow with proper horizontal scrolling\n2. Keep Organization and Average Score as fixed first columns that can't be toggled\n3. Fix the Organization column styling to match the header theme\n4. Ensure proper z-indexing for sticky columns\n5. Remove Organization and Average Score from the toggle groups\n6. Improve the visual separation between the table and background\n\nThe table will now scroll horizontally within its container while keeping the Organization and Average Score columns fixed on the left. The Organization column will have the same dark background as other headers, making it visible and consistent with the design.\n\nWould you like me to make any adjustments to these changes?",
      "created_at": "2024-12-02T08:55:41.478487Z",
      "sequence_order": 7,
      "metadata": {
        "content": [
          {
            "start_timestamp": null,
            "stop_timestamp": null,
            "flags": null,
            "type": "text",
            "text": " I'll help fix these issues. Here are the key changes needed:\n\n<antArtifact identifier=\"data-viewer-fixes\" type=\"application/vnd.ant.code\" language=\"css\" title=\"CSS Fixes\">\n/* Add/modify these styles in the style section */\n.table-container {\n    overflow-x: auto;\n    background: white;\n    border-radius: 8px;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n    margin-top: 20px;\n    max-width: 100%;\n}\n\n/* Fixed column styling */\n.fixed-column {\n    position: sticky;\n    left: 0;\n    z-index: 10;\n}\n\nth.fixed-column {\n    background: #2d3748;\n    z-index: 11; /* Higher than td fixed columns */\n    border-right: 2px solid #4a5568;\n}\n\ntd.fixed-column {\n    background: #2d3748;\n    color: white;\n    border-right: 2px solid #4a5568;\n}\n\n/* Toggle groups styling */\n.toggle-group {\n    background: white;\n    padding: 15px;\n    border-radius: 8px;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n    margin-bottom: 10px;\n}\n</antArtifact>\n\nAnd here's the JavaScript modifications:\n\n<antArtifact identifier=\"data-viewer-logic\" type=\"application/vnd.ant.code\" language=\"javascript\" title=\"JavaScript Fixes\">\n// Modify the columnGroups object - remove Organization and Average Score from Basic Info\nconst columnGroups = {\n    'Selection Criteria': [\n        'Organizational Capacity',\n        'Experience in Similar Projects',\n        'Alignment with Program Goals',\n        'Ability to Reach Target Audience',\n        'Capacity to Deliver Training',\n        'Willingness & Ability to Collaborate'\n    ],\n    'Key Metrics': [\n        'Total Followers',\n        'Total # Employees',\n        'Num Training Programs(3 years)',\n        'Training Impact Ratio',\n        'Efficiency',\n        'Social Media Reach Per Employee'\n    ],\n    'Basic Info': [\n        'Topics Covered',\n        'Areas Operating'\n    ]\n};\n\n// Modify the toggleAllColumns function\nfunction toggleAllColumns() {\n    const allColumns = [...new Set(Object.values(columnGroups).flat())];\n    const allChecked = allColumns.every(col => activeColumns.includes(col));\n    \n    const checkboxes = document.querySelectorAll('#columnToggle input[type=\"checkbox\"]');\n    checkboxes.forEach(checkbox => {\n        checkbox.checked = !allChecked;\n    });\n    \n    // Always keep Organization and Average Score\n    activeColumns = allChecked ? ['Organization', 'Average Score'] : ['Organization', 'Average Score', ...allColumns];\n    updateTableHeader();\n    updateTable();\n}\n\n// Modify the handleColumnToggle function\nfunction handleColumnToggle(e) {\n    const column = e.target.value;\n    if (e.target.checked) {\n        activeColumns = ['Organization', 'Average Score', ...activeColumns.filter(col => \n            col !== 'Organization' && col !== 'Average Score'), column];\n    } else {\n        activeColumns = ['Organization', 'Average Score', \n            ...activeColumns.filter(col => col !== column && col !== 'Organization' && col !== 'Average Score')];\n    }\n    updateTableHeader();\n    updateTable();\n}\n\n// Modify the updateTableHeader function\nfunction updateTableHeader() {\n    const thead = document.querySelector('thead');\n    thead.innerHTML = `\n        <tr>\n            <th class=\"fixed-column tooltip\">Organization</th>\n            <th class=\"tooltip\">Average Score</th>\n            ${activeColumns\n                .filter(col => col !== 'Organization' && col !== 'Average Score')\n                .map(col => `\n                    <th class=\"tooltip\" \n                        onclick=\"sortBy('${col}')\"\n                        ${columnTooltips[col] ? `title=\"${columnTooltips[col]}\"` : ''}>\n                        ${col}\n                    </th>\n                `).join('')}\n            <th>Actions</th>\n        </tr>\n    `;\n}\n\n// Modify the updateTable function\nfunction updateTable() {\n    const tbody = document.querySelector('tbody');\n    tbody.innerHTML = '';\n    \n    sortedData.forEach(org => {\n        const row = document.createElement('tr');\n        row.innerHTML = `\n            <td class=\"fixed-column\">${formatCell(org['Organization'])}</td>\n            <td class=\"${getScoreClass(org['Average Score'])}\">${formatCell(org['Average Score'])}</td>\n            ${activeColumns\n                .filter(col => col !== 'Organization' && col !== 'Average Score')\n                .map(col => `\n                    <td>${formatCell(org[col])}</td>\n                `).join('')}\n            <td>\n                <button onclick=\"showDetails('${org.Organization}')\">Details</button>\n            </td>\n        `;\n        tbody.appendChild(row);\n    });\n}\n</antArtifact>\n\nThese changes will:\n1. Fix the table overflow with proper horizontal scrolling\n2. Keep Organization and Average Score as fixed first columns that can't be toggled\n3. Fix the Organization column styling to match the header theme\n4. Ensure proper z-indexing for sticky columns\n5. Remove Organization and Average Score from the toggle groups\n6. Improve the visual separation between the table and background\n\nThe table will now scroll horizontally within its container while keeping the Organization and Average Score columns fixed on the left. The Organization column will have the same dark background as other headers, making it visible and consistent with the design.\n\nWould you like me to make any adjustments to these changes?",
            "citations": []
          }
        ],
        "updated_at": "2024-12-02T08:55:41.478487Z",
        "attachments": [],
        "files": []
      }
    },
    {
      "id": "53b87bb4-abaa-43d6-bdef-a9bb02457e5c",
      "role": "human",
      "content": "can you give me the entire css section and the entire \"\n    <script>\nconst rawData = [...\" </script> \nSections",
      "created_at": "2024-12-02T08:57:34.195637Z",
      "sequence_order": 8,
      "metadata": {
        "content": [
          {
            "start_timestamp": null,
            "stop_timestamp": null,
            "flags": null,
            "type": "text",
            "text": "can you give me the entire css section and the entire \"\n    <script>\nconst rawData = [...\" </script> \nSections",
            "citations": []
          }
        ],
        "updated_at": "2024-12-02T08:57:34.195637Z",
        "attachments": [],
        "files": []
      }
    },
    {
      "id": "c043d1e6-06a9-4ca3-b7e1-a8bb92ce9301",
      "role": "assistant",
      "content": " I'll help combine all the CSS and JavaScript into complete sections that you can directly replace in your code.\n\n<antArtifact identifier=\"complete-css\" type=\"application/vnd.ant.code\" language=\"css\" title=\"Complete CSS Section\">\n<style>\n    body {\n        font-family: system-ui, -apple-system, sans-serif;\n        margin: 20px;\n        background: #f5f5f5;\n    }\n    .container {\n        background: white;\n        border-radius: 8px;\n        padding: 20px;\n        box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n        max-width: 1400px;\n        margin: 0 auto;\n    }\n    .metric-cards {\n        display: grid;\n        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n        gap: 20px;\n        margin-bottom: 20px;\n    }\n    .metric-card {\n        background: white;\n        padding: 15px;\n        border-radius: 8px;\n        box-shadow: 0 2px 4px rgba(0,0,0,0.05);\n    }\n    .metric-card h3 {\n        margin: 0 0 10px 0;\n        color: #4a5568;\n        font-size: 14px;\n    }\n    .metric-card .value {\n        font-size: 24px;\n        font-weight: bold;\n        color: #2d3748;\n    }\n    .controls {\n        display: grid;\n        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n        gap: 10px;\n        margin: 20px 0;\n    }\n    select, input, button {\n        padding: 8px 12px;\n        border: 1px solid #e2e8f0;\n        border-radius: 6px;\n        font-size: 14px;\n    }\n    button {\n        background: #4a5568;\n        color: white;\n        border: none;\n        cursor: pointer;\n    }\n    button:hover {\n        background: #2d3748;\n    }\n    .modal {\n        display: none;\n        position: fixed;\n        top: 0;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        background: rgba(0,0,0,0.5);\n        padding: 20px;\n    }\n    .modal-content {\n        background: white;\n        padding: 20px;\n        border-radius: 8px;\n        max-width: 800px;\n        margin: 40px auto;\n        max-height: 80vh;\n        overflow-y: auto;\n    }\n    .close {\n        float: right;\n        font-size: 20px;\n        cursor: pointer;\n    }\n    .column-toggle {\n        display: flex;\n        flex-wrap: wrap;\n        gap: 10px;\n        margin: 10px 0;\n    }\n    .column-toggle label {\n        display: flex;\n        align-items: center;\n        gap: 5px;\n    }\n\n    .table-container {\n        overflow-x: auto;\n        background: white;\n        border-radius: 8px;\n        box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n        margin-top: 20px;\n        max-width: 100%;\n    }\n\n    table {\n        width: 100%;\n        border-collapse: collapse;\n        margin-top: 20px;\n    }\n    th, td {\n        padding: 12px;\n        text-align: left;\n        border-bottom: 1px solid #e2e8f0;\n    }\n    th {\n        background: #2d3748;\n        color: white;\n        position: sticky;\n        top: 0;\n        cursor: pointer;\n    }\n\n    .fixed-column {\n        position: sticky;\n        left: 0;\n        z-index: 10;\n    }\n\n    th.fixed-column {\n        background: #2d3748;\n        z-index: 11;\n        border-right: 2px solid #4a5568;\n    }\n\n    td.fixed-column {\n        background: #2d3748;\n        color: white;\n        border-right: 2px solid #4a5568;\n    }\n\n    th[title] {\n        cursor: help;\n    }\n\n    .tooltip:hover::after {\n        content: attr(title);\n        position: absolute;\n        bottom: 100%;\n        left: 50%;\n        transform: translateX(-50%);\n        padding: 8px;\n        background: #2d3748;\n        color: white;\n        border-radius: 4px;\n        font-size: 14px;\n        white-space: nowrap;\n        z-index: 20;\n        box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n    }\n\n    .toggle-group {\n        background: white;\n        padding: 15px;\n        border-radius: 8px;\n        box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n        margin-bottom: 10px;\n    }\n\n    .toggle-group-header {\n        font-weight: bold;\n        margin-bottom: 10px;\n        color: #2d3748;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n    }\n\n    .toggle-group-content {\n        display: grid;\n        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\n        gap: 8px;\n    }\n\n    .toggle-all-btn {\n        background: #4a5568;\n        color: white;\n        padding: 4px 8px;\n        border-radius: 4px;\n        font-size: 12px;\n        cursor: pointer;\n    }\n\n    .toggle-all-btn:hover {\n        background: #2d3748;\n    }\n\n    .high-score {\n        color: #2f855a;\n        font-weight: bold;\n    }\n\n    .medium-score {\n        color: #744210;\n        font-weight: bold;\n    }\n\n    .low-score {\n        color: #9b2c2c;\n        font-weight: bold;\n    }\n</style>\n</antArtifact>\n\n<antArtifact identifier=\"complete-js\" type=\"application/vnd.ant.code\" language=\"javascript\" title=\"Complete JavaScript Section\">\n<script>\nconst rawData = [/* Your existing raw data array */];\n\n// Process data and remove Youth Engagement Score\nconst processedData = rawData.map(org => {\n    const processed = {...org};\n    delete processed[\"Youth Engagement Score\"];\n    return {\n        ...processed,\n        \"Efficiency\": isFinite(org[\"Efficiency\"]) ? org[\"Efficiency\"] : 0,\n        \"Social Media Reach Per Employee\": isFinite(org[\"Social Media Reach Per Employee\"]) ? org[\"Social Media Reach Per Employee\"] : 0,\n        \"Training Impact Ratio\": isFinite(org[\"Training Impact Ratio\"]) ? org[\"Training Impact Ratio\"] : 0\n    };\n});\n\n// Calculate statistics\nconst stats = {\n    totalEmployees: processedData.reduce((sum, org) => sum + (org[\"Total # Employees\"] || 0), 0),\n    totalTrainees: processedData.reduce((sum, org) => sum + (org[\"Estimated Number Trainees\"] || 0), 0),\n    averageScore: (processedData.reduce((sum, org) => sum + (org[\"Average Score\"] || 0), 0) / processedData.length).toFixed(2)\n};\n\n// Column groups definition\nconst columnGroups = {\n    'Selection Criteria': [\n        'Organizational Capacity',\n        'Experience in Similar Projects',\n        'Alignment with Program Goals',\n        'Ability to Reach Target Audience',\n        'Capacity to Deliver Training',\n        'Willingness & Ability to Collaborate'\n    ],\n    'Key Metrics': [\n        'Total Followers',\n        'Total # Employees',\n        'Num Training Programs(3 years)',\n        'Training Impact Ratio',\n        'Efficiency',\n        'Social Media Reach Per Employee'\n    ],\n    'Basic Info': [\n        'Topics Covered',\n        'Areas Operating'\n    ]\n};\n\n// Define tooltips for calculated metrics\nconst columnTooltips = {\n    \"Training Impact Ratio\": \"Calculated as: Estimated Number Trainees / Total # Employees\",\n    \"Efficiency\": \"Calculated as: Number of Training Programs / Total # Employees\",\n    \"Social Media Reach Per Employee\": \"Calculated as: Estimated Number of People Reached Social media / Total # Employees\"\n};\n\nlet activeColumns = [\n    'Organization', \n    'Average Score', \n    'Total Followers',\n    'Total # Employees',\n    'Num Training Programs(3 years)',\n    'Training Impact Ratio',\n    'Efficiency',\n    'Social Media Reach Per Employee',\n    'Topics Covered',\n    'Areas Operating'\n];\n\nlet sortedData = [];\nlet sortDirection = 'desc';\n\nfunction createColumnToggles() {\n    const columnToggle = document.getElementById('columnToggle');\n    columnToggle.innerHTML = '';\n\n    const masterToggleDiv = document.createElement('div');\n    masterToggleDiv.className = 'toggle-group';\n    masterToggleDiv.innerHTML = `\n        <div class=\"toggle-group-header\">\n            <span>All Columns</span>\n            <button class=\"toggle-all-btn\" onclick=\"toggleAllColumns()\">Toggle All</button>\n        </div>\n    `;\n    columnToggle.appendChild(masterToggleDiv);\n\n    Object.entries(columnGroups).forEach(([groupName, columns]) => {\n        const groupDiv = document.createElement('div');\n        groupDiv.className = 'toggle-group';\n        \n        groupDiv.innerHTML = `\n            <div class=\"toggle-group-header\">\n                <span>${groupName}</span>\n                <button class=\"toggle-all-btn\" onclick=\"toggleGroup('${groupName}')\">Toggle Group</button>\n            </div>\n            <div class=\"toggle-group-content\">\n                ${columns.map(column => `\n                    <label>\n                        <input type=\"checkbox\" \n                               value=\"${column}\" \n                               ${activeColumns.includes(column) ? 'checked' : ''}\n                               onchange=\"handleColumnToggle(event)\">\n                        ${column}\n                    </label>\n                `).join('')}\n            </div>\n        `;\n        columnToggle.appendChild(groupDiv);\n    });\n}\n\nfunction toggleAllColumns() {\n    const allColumns = [...new Set(Object.values(columnGroups).flat())];\n    const allChecked = allColumns.every(col => activeColumns.includes(col));\n    \n    const checkboxes = document.querySelectorAll('#columnToggle input[type=\"checkbox\"]');\n    checkboxes.forEach(checkbox => {\n        checkbox.checked = !allChecked;\n    });\n    \n    activeColumns = allChecked ? ['Organization', 'Average Score'] : ['Organization', 'Average Score', ...allColumns];\n    updateTableHeader();\n    updateTable();\n}\n\nfunction toggleGroup(groupName) {\n    const columns = columnGroups[groupName];\n    const allChecked = columns.every(col => activeColumns.includes(col));\n    \n    const groupCheckboxes = document.querySelectorAll(`#columnToggle input[type=\"checkbox\"]`);\n    groupCheckboxes.forEach(checkbox => {\n        if (columns.includes(checkbox.value)) {\n            checkbox.checked = !allChecked;\n        }\n    });\n    \n    if (allChecked) {\n        activeColumns = ['Organization', 'Average Score', \n            ...activeColumns.filter(col => !columns.includes(col) && \n                col !== 'Organization' && col !== 'Average Score')];\n    } else {\n        activeColumns = ['Organization', 'Average Score',\n            ...new Set([...activeColumns.filter(col => \n                col !== 'Organization' && col !== 'Average Score'), ...columns])];\n    }\n    \n    updateTableHeader();\n    updateTable();\n}\n\nfunction handleColumnToggle(e) {\n    const column = e.target.value;\n    if (e.target.checked) {\n        activeColumns = ['Organization', 'Average Score', \n            ...activeColumns.filter(col => col !== 'Organization' && col !== 'Average Score'), column];\n    } else {\n        activeColumns = ['Organization', 'Average Score', \n            ...activeColumns.filter(col => col !== column && col !== 'Organization' && col !== 'Average Score')];\n    }\n    updateTableHeader();\n    updateTable();\n}\n\nfunction updateTableHeader() {\n    const thead = document.querySelector('thead');\n    thead.innerHTML = `\n        <tr>\n            <th class=\"fixed-column tooltip\">Organization</th>\n            <th class=\"tooltip\">Average Score</th>\n            ${activeColumns\n                .filter(col => col !== 'Organization' && col !== 'Average Score')\n                .map(col => `\n                    <th class=\"tooltip\" \n                        onclick=\"sortBy('${col}')\"\n                        ${columnTooltips[col] ? `title=\"${columnTooltips[col]}\"` : ''}>\n                        ${col}\n                    </th>\n                `).join('')}\n            <th>Actions</th>\n        </tr>\n    `;\n}\n\nfunction updateTable() {\n    const tbody = document.querySelector('tbody');\n    tbody.innerHTML = '';\n    \n    sortedData.forEach(org => {\n        const row = document.createElement('tr');\n        row.innerHTML = `\n            <td class=\"fixed-column\">${formatCell(org['Organization'])}</td>\n            <td class=\"${getScoreClass(org['Average Score'])}\">${formatCell(org['Average Score'])}</td>\n            ${activeColumns\n                .filter(col => col !== 'Organization' && col !== 'Average Score')\n                .map(col => `\n                    <td>${formatCell(org[col])}</td>\n                `).join('')}\n            <td>\n                <button onclick=\"showDetails('${org.Organization}')\">Details</button>\n            </td>\n        `;\n        tbody.appendChild(row);\n    });\n}\n\nfunction formatCell(value) {\n    if (value === null || value === undefined || value === '') return 'N.A.';\n    if (typeof value === 'number') {\n        if (value > 1000) return value.toLocaleString();\n        if (value % 1 !== 0) return value.toFixed(2);\n    }\n    return value;\n}\n\nfunction getScoreClass(score) {\n    if (!score) return '';\n    if (score >= 4.5) return 'high-score';\n    if (score >= 3.5) return 'medium-score';\n    return 'low-score';\n}\n\nfunction updateMetricCards() {\n    document.getElementById('totalOrgs').textContent = processedData.length;\n    document.getElementById('avgScore').textContent = stats.averageScore;\n    document.getElementById('totalEmployees').textContent = stats.totalEmployees.toLocaleString();\n    document.getElementById('totalTrainees').textContent = stats.totalTrainees.toLocaleString();\n}\n\nfunction showDetails(orgName) {\n    const org = processedData.find(o => o.Organization === orgName);\n    const modal = document.getElementById('detailModal');\n    const content = document.getElementById('modalContent');\n    \n    content.innerHTML = `\n        <h2>${org.Organization}</h2>\n        <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;\">\n            ${Object.entries(org)\n                .map(([key, value]) => `\n                    <div>\n                        <strong>${key}:</strong>\n                        <div>${formatCell(value)}</div>\n                    </div>\n                `).join('')}\n        </div>\n    `;\n    \n    modal.style.display = 'block';\n}\n\nfunction sortBy(field) {\n    sortDirection = sort",
      "created_at": "2024-12-02T08:57:34.195637Z",
      "sequence_order": 9,
      "metadata": {
        "content": [
          {
            "start_timestamp": null,
            "stop_timestamp": null,
            "flags": null,
            "type": "text",
            "text": " I'll help combine all the CSS and JavaScript into complete sections that you can directly replace in your code.\n\n<antArtifact identifier=\"complete-css\" type=\"application/vnd.ant.code\" language=\"css\" title=\"Complete CSS Section\">\n<style>\n    body {\n        font-family: system-ui, -apple-system, sans-serif;\n        margin: 20px;\n        background: #f5f5f5;\n    }\n    .container {\n        background: white;\n        border-radius: 8px;\n        padding: 20px;\n        box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n        max-width: 1400px;\n        margin: 0 auto;\n    }\n    .metric-cards {\n        display: grid;\n        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n        gap: 20px;\n        margin-bottom: 20px;\n    }\n    .metric-card {\n        background: white;\n        padding: 15px;\n        border-radius: 8px;\n        box-shadow: 0 2px 4px rgba(0,0,0,0.05);\n    }\n    .metric-card h3 {\n        margin: 0 0 10px 0;\n        color: #4a5568;\n        font-size: 14px;\n    }\n    .metric-card .value {\n        font-size: 24px;\n        font-weight: bold;\n        color: #2d3748;\n    }\n    .controls {\n        display: grid;\n        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n        gap: 10px;\n        margin: 20px 0;\n    }\n    select, input, button {\n        padding: 8px 12px;\n        border: 1px solid #e2e8f0;\n        border-radius: 6px;\n        font-size: 14px;\n    }\n    button {\n        background: #4a5568;\n        color: white;\n        border: none;\n        cursor: pointer;\n    }\n    button:hover {\n        background: #2d3748;\n    }\n    .modal {\n        display: none;\n        position: fixed;\n        top: 0;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        background: rgba(0,0,0,0.5);\n        padding: 20px;\n    }\n    .modal-content {\n        background: white;\n        padding: 20px;\n        border-radius: 8px;\n        max-width: 800px;\n        margin: 40px auto;\n        max-height: 80vh;\n        overflow-y: auto;\n    }\n    .close {\n        float: right;\n        font-size: 20px;\n        cursor: pointer;\n    }\n    .column-toggle {\n        display: flex;\n        flex-wrap: wrap;\n        gap: 10px;\n        margin: 10px 0;\n    }\n    .column-toggle label {\n        display: flex;\n        align-items: center;\n        gap: 5px;\n    }\n\n    .table-container {\n        overflow-x: auto;\n        background: white;\n        border-radius: 8px;\n        box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n        margin-top: 20px;\n        max-width: 100%;\n    }\n\n    table {\n        width: 100%;\n        border-collapse: collapse;\n        margin-top: 20px;\n    }\n    th, td {\n        padding: 12px;\n        text-align: left;\n        border-bottom: 1px solid #e2e8f0;\n    }\n    th {\n        background: #2d3748;\n        color: white;\n        position: sticky;\n        top: 0;\n        cursor: pointer;\n    }\n\n    .fixed-column {\n        position: sticky;\n        left: 0;\n        z-index: 10;\n    }\n\n    th.fixed-column {\n        background: #2d3748;\n        z-index: 11;\n        border-right: 2px solid #4a5568;\n    }\n\n    td.fixed-column {\n        background: #2d3748;\n        color: white;\n        border-right: 2px solid #4a5568;\n    }\n\n    th[title] {\n        cursor: help;\n    }\n\n    .tooltip:hover::after {\n        content: attr(title);\n        position: absolute;\n        bottom: 100%;\n        left: 50%;\n        transform: translateX(-50%);\n        padding: 8px;\n        background: #2d3748;\n        color: white;\n        border-radius: 4px;\n        font-size: 14px;\n        white-space: nowrap;\n        z-index: 20;\n        box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n    }\n\n    .toggle-group {\n        background: white;\n        padding: 15px;\n        border-radius: 8px;\n        box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n        margin-bottom: 10px;\n    }\n\n    .toggle-group-header {\n        font-weight: bold;\n        margin-bottom: 10px;\n        color: #2d3748;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n    }\n\n    .toggle-group-content {\n        display: grid;\n        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\n        gap: 8px;\n    }\n\n    .toggle-all-btn {\n        background: #4a5568;\n        color: white;\n        padding: 4px 8px;\n        border-radius: 4px;\n        font-size: 12px;\n        cursor: pointer;\n    }\n\n    .toggle-all-btn:hover {\n        background: #2d3748;\n    }\n\n    .high-score {\n        color: #2f855a;\n        font-weight: bold;\n    }\n\n    .medium-score {\n        color: #744210;\n        font-weight: bold;\n    }\n\n    .low-score {\n        color: #9b2c2c;\n        font-weight: bold;\n    }\n</style>\n</antArtifact>\n\n<antArtifact identifier=\"complete-js\" type=\"application/vnd.ant.code\" language=\"javascript\" title=\"Complete JavaScript Section\">\n<script>\nconst rawData = [/* Your existing raw data array */];\n\n// Process data and remove Youth Engagement Score\nconst processedData = rawData.map(org => {\n    const processed = {...org};\n    delete processed[\"Youth Engagement Score\"];\n    return {\n        ...processed,\n        \"Efficiency\": isFinite(org[\"Efficiency\"]) ? org[\"Efficiency\"] : 0,\n        \"Social Media Reach Per Employee\": isFinite(org[\"Social Media Reach Per Employee\"]) ? org[\"Social Media Reach Per Employee\"] : 0,\n        \"Training Impact Ratio\": isFinite(org[\"Training Impact Ratio\"]) ? org[\"Training Impact Ratio\"] : 0\n    };\n});\n\n// Calculate statistics\nconst stats = {\n    totalEmployees: processedData.reduce((sum, org) => sum + (org[\"Total # Employees\"] || 0), 0),\n    totalTrainees: processedData.reduce((sum, org) => sum + (org[\"Estimated Number Trainees\"] || 0), 0),\n    averageScore: (processedData.reduce((sum, org) => sum + (org[\"Average Score\"] || 0), 0) / processedData.length).toFixed(2)\n};\n\n// Column groups definition\nconst columnGroups = {\n    'Selection Criteria': [\n        'Organizational Capacity',\n        'Experience in Similar Projects',\n        'Alignment with Program Goals',\n        'Ability to Reach Target Audience',\n        'Capacity to Deliver Training',\n        'Willingness & Ability to Collaborate'\n    ],\n    'Key Metrics': [\n        'Total Followers',\n        'Total # Employees',\n        'Num Training Programs(3 years)',\n        'Training Impact Ratio',\n        'Efficiency',\n        'Social Media Reach Per Employee'\n    ],\n    'Basic Info': [\n        'Topics Covered',\n        'Areas Operating'\n    ]\n};\n\n// Define tooltips for calculated metrics\nconst columnTooltips = {\n    \"Training Impact Ratio\": \"Calculated as: Estimated Number Trainees / Total # Employees\",\n    \"Efficiency\": \"Calculated as: Number of Training Programs / Total # Employees\",\n    \"Social Media Reach Per Employee\": \"Calculated as: Estimated Number of People Reached Social media / Total # Employees\"\n};\n\nlet activeColumns = [\n    'Organization', \n    'Average Score', \n    'Total Followers',\n    'Total # Employees',\n    'Num Training Programs(3 years)',\n    'Training Impact Ratio',\n    'Efficiency',\n    'Social Media Reach Per Employee',\n    'Topics Covered',\n    'Areas Operating'\n];\n\nlet sortedData = [];\nlet sortDirection = 'desc';\n\nfunction createColumnToggles() {\n    const columnToggle = document.getElementById('columnToggle');\n    columnToggle.innerHTML = '';\n\n    const masterToggleDiv = document.createElement('div');\n    masterToggleDiv.className = 'toggle-group';\n    masterToggleDiv.innerHTML = `\n        <div class=\"toggle-group-header\">\n            <span>All Columns</span>\n            <button class=\"toggle-all-btn\" onclick=\"toggleAllColumns()\">Toggle All</button>\n        </div>\n    `;\n    columnToggle.appendChild(masterToggleDiv);\n\n    Object.entries(columnGroups).forEach(([groupName, columns]) => {\n        const groupDiv = document.createElement('div');\n        groupDiv.className = 'toggle-group';\n        \n        groupDiv.innerHTML = `\n            <div class=\"toggle-group-header\">\n                <span>${groupName}</span>\n                <button class=\"toggle-all-btn\" onclick=\"toggleGroup('${groupName}')\">Toggle Group</button>\n            </div>\n            <div class=\"toggle-group-content\">\n                ${columns.map(column => `\n                    <label>\n                        <input type=\"checkbox\" \n                               value=\"${column}\" \n                               ${activeColumns.includes(column) ? 'checked' : ''}\n                               onchange=\"handleColumnToggle(event)\">\n                        ${column}\n                    </label>\n                `).join('')}\n            </div>\n        `;\n        columnToggle.appendChild(groupDiv);\n    });\n}\n\nfunction toggleAllColumns() {\n    const allColumns = [...new Set(Object.values(columnGroups).flat())];\n    const allChecked = allColumns.every(col => activeColumns.includes(col));\n    \n    const checkboxes = document.querySelectorAll('#columnToggle input[type=\"checkbox\"]');\n    checkboxes.forEach(checkbox => {\n        checkbox.checked = !allChecked;\n    });\n    \n    activeColumns = allChecked ? ['Organization', 'Average Score'] : ['Organization', 'Average Score', ...allColumns];\n    updateTableHeader();\n    updateTable();\n}\n\nfunction toggleGroup(groupName) {\n    const columns = columnGroups[groupName];\n    const allChecked = columns.every(col => activeColumns.includes(col));\n    \n    const groupCheckboxes = document.querySelectorAll(`#columnToggle input[type=\"checkbox\"]`);\n    groupCheckboxes.forEach(checkbox => {\n        if (columns.includes(checkbox.value)) {\n            checkbox.checked = !allChecked;\n        }\n    });\n    \n    if (allChecked) {\n        activeColumns = ['Organization', 'Average Score', \n            ...activeColumns.filter(col => !columns.includes(col) && \n                col !== 'Organization' && col !== 'Average Score')];\n    } else {\n        activeColumns = ['Organization', 'Average Score',\n            ...new Set([...activeColumns.filter(col => \n                col !== 'Organization' && col !== 'Average Score'), ...columns])];\n    }\n    \n    updateTableHeader();\n    updateTable();\n}\n\nfunction handleColumnToggle(e) {\n    const column = e.target.value;\n    if (e.target.checked) {\n        activeColumns = ['Organization', 'Average Score', \n            ...activeColumns.filter(col => col !== 'Organization' && col !== 'Average Score'), column];\n    } else {\n        activeColumns = ['Organization', 'Average Score', \n            ...activeColumns.filter(col => col !== column && col !== 'Organization' && col !== 'Average Score')];\n    }\n    updateTableHeader();\n    updateTable();\n}\n\nfunction updateTableHeader() {\n    const thead = document.querySelector('thead');\n    thead.innerHTML = `\n        <tr>\n            <th class=\"fixed-column tooltip\">Organization</th>\n            <th class=\"tooltip\">Average Score</th>\n            ${activeColumns\n                .filter(col => col !== 'Organization' && col !== 'Average Score')\n                .map(col => `\n                    <th class=\"tooltip\" \n                        onclick=\"sortBy('${col}')\"\n                        ${columnTooltips[col] ? `title=\"${columnTooltips[col]}\"` : ''}>\n                        ${col}\n                    </th>\n                `).join('')}\n            <th>Actions</th>\n        </tr>\n    `;\n}\n\nfunction updateTable() {\n    const tbody = document.querySelector('tbody');\n    tbody.innerHTML = '';\n    \n    sortedData.forEach(org => {\n        const row = document.createElement('tr');\n        row.innerHTML = `\n            <td class=\"fixed-column\">${formatCell(org['Organization'])}</td>\n            <td class=\"${getScoreClass(org['Average Score'])}\">${formatCell(org['Average Score'])}</td>\n            ${activeColumns\n                .filter(col => col !== 'Organization' && col !== 'Average Score')\n                .map(col => `\n                    <td>${formatCell(org[col])}</td>\n                `).join('')}\n            <td>\n                <button onclick=\"showDetails('${org.Organization}')\">Details</button>\n            </td>\n        `;\n        tbody.appendChild(row);\n    });\n}\n\nfunction formatCell(value) {\n    if (value === null || value === undefined || value === '') return 'N.A.';\n    if (typeof value === 'number') {\n        if (value > 1000) return value.toLocaleString();\n        if (value % 1 !== 0) return value.toFixed(2);\n    }\n    return value;\n}\n\nfunction getScoreClass(score) {\n    if (!score) return '';\n    if (score >= 4.5) return 'high-score';\n    if (score >= 3.5) return 'medium-score';\n    return 'low-score';\n}\n\nfunction updateMetricCards() {\n    document.getElementById('totalOrgs').textContent = processedData.length;\n    document.getElementById('avgScore').textContent = stats.averageScore;\n    document.getElementById('totalEmployees').textContent = stats.totalEmployees.toLocaleString();\n    document.getElementById('totalTrainees').textContent = stats.totalTrainees.toLocaleString();\n}\n\nfunction showDetails(orgName) {\n    const org = processedData.find(o => o.Organization === orgName);\n    const modal = document.getElementById('detailModal');\n    const content = document.getElementById('modalContent');\n    \n    content.innerHTML = `\n        <h2>${org.Organization}</h2>\n        <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;\">\n            ${Object.entries(org)\n                .map(([key, value]) => `\n                    <div>\n                        <strong>${key}:</strong>\n                        <div>${formatCell(value)}</div>\n                    </div>\n                `).join('')}\n        </div>\n    `;\n    \n    modal.style.display = 'block';\n}\n\nfunction sortBy(field) {\n    sortDirection = sort",
            "citations": []
          }
        ],
        "updated_at": "2024-12-02T08:57:34.195637Z",
        "attachments": [],
        "files": []
      }
    },
    {
      "id": "737609e2-6674-4062-a00d-da8fb43edd81",
      "role": "human",
      "content": "continue from this function: \nfunction showDetails(orgName) {\n    const org = processedData.find(o => o.Organization === orgName);\n    const modal = document.getElementById('detailModal');\n    const content = document.getElementById('modalContent');\n    \n    content.innerHTML = `\n        <h2>${org.Organization}</h2>\n        <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;\">\n            ${Object.entries(org)\n                .map(([key, value]) => `\n                    <div>\n                        <strong>${key}:</strong>\n                        <div>${formatCell(value)}</div>\n                    </div>\n                `).join('')}\n        </div>\n    `;\n    \n    modal.style.display = 'block';\n}",
      "created_at": "2024-12-02T08:58:53.013107Z",
      "sequence_order": 10,
      "metadata": {
        "content": [
          {
            "start_timestamp": null,
            "stop_timestamp": null,
            "flags": null,
            "type": "text",
            "text": "continue from this function: \nfunction showDetails(orgName) {\n    const org = processedData.find(o => o.Organization === orgName);\n    const modal = document.getElementById('detailModal');\n    const content = document.getElementById('modalContent');\n    \n    content.innerHTML = `\n        <h2>${org.Organization}</h2>\n        <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;\">\n            ${Object.entries(org)\n                .map(([key, value]) => `\n                    <div>\n                        <strong>${key}:</strong>\n                        <div>${formatCell(value)}</div>\n                    </div>\n                `).join('')}\n        </div>\n    `;\n    \n    modal.style.display = 'block';\n}",
            "citations": []
          }
        ],
        "updated_at": "2024-12-02T08:58:53.013107Z",
        "attachments": [],
        "files": []
      }
    },
    {
      "id": "7758b7da-994d-4261-8411-b3d87d718025",
      "role": "assistant",
      "content": " Here's the rest of the JavaScript code:\n\n<antArtifact identifier=\"complete-js-continued\" type=\"application/vnd.ant.code\" language=\"javascript\" title=\"Complete JavaScript Section (Continued)\">\nfunction sortBy(field) {\n    sortDirection = sortDirection === 'desc' ? 'asc' : 'desc';\n    sortedData.sort((a, b) => {\n        const aVal = a[field] ?? '';\n        const bVal = b[field] ?? '';\n        if (typeof aVal === 'string') {\n            return sortDirection === 'desc' \n                ? bVal.localeCompare(aVal) \n                : aVal.localeCompare(bVal);\n        }\n        return sortDirection === 'desc' \n            ? bVal - aVal \n            : aVal - bVal;\n    });\n    updateTable();\n}\n\n// Event Listeners\ndocument.querySelector('.close').onclick = () => {\n    document.getElementById('detailModal').style.display = 'none';\n};\n\ndocument.getElementById('toggleColumns').onclick = () => {\n    const columnToggle = document.getElementById('columnToggle');\n    columnToggle.style.display = columnToggle.style.display === 'none' ? 'flex' : 'none';\n};\n\ndocument.getElementById('search').addEventListener('input', (e) => {\n    const searchTerm = e.target.value.toLowerCase();\n    sortedData = processedData.filter(org => \n        Object.values(org).some(value => \n            String(value).toLowerCase().includes(searchTerm)\n        )\n    );\n    updateTable();\n});\n\ndocument.getElementById('exportBtn').addEventListener('click', () => {\n    try {\n        const csv = [\n            activeColumns.join(','),\n            ...sortedData.map(org => \n                activeColumns.map(col => {\n                    const value = org[col];\n                    if (typeof value === 'string' && value.includes(',')) {\n                        return `\"${value}\"`;\n                    }\n                    return value ?? '';\n                }).join(',')\n            )\n        ].join('\\n');\n\n        const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });\n        const url = window.URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.setAttribute('hidden', '');\n        a.setAttribute('href', url);\n        a.setAttribute('download', 'partners_data.csv');\n        document.body.appendChild(a);\n        a.click();\n        document.body.removeChild(a);\n        window.URL.revokeObjectURL(url);\n    } catch (error) {\n        console.error('Error exporting CSV:', error);\n        alert('An error occurred while exporting the data. Please try again.');\n    }\n});\n\n// Click outside modal to close\nwindow.onclick = (event) => {\n    const modal = document.getElementById('detailModal');\n    if (event.target === modal) {\n        modal.style.display = 'none';\n    }\n};\n\n// Initialize table when document is ready\ndocument.addEventListener('DOMContentLoaded', () => {\n    initializeTable();\n});\n\nfunction initializeTable() {\n    createColumnToggles();\n    updateTableHeader();\n    sortedData = [...processedData];\n    updateTable();\n    updateMetricCards();\n}\n\n</script>\n</antArtifact>\n\nThis completes the JavaScript code with all the necessary functionality including:\n- Sorting with toggle direction\n- CSV export with proper handling of special characters\n- Modal interactions\n- Search functionality\n- Table initialization\n- Event listeners for all interactive elements\n\nThe code assumes you have the HTML structure and CSS from earlier. Everything should work together to provide a fully functional data table with fixed columns, proper sorting, and all the requested features.",
      "created_at": "2024-12-02T08:58:53.013107Z",
      "sequence_order": 11,
      "metadata": {
        "content": [
          {
            "start_timestamp": null,
            "stop_timestamp": null,
            "flags": null,
            "type": "text",
            "text": " Here's the rest of the JavaScript code:\n\n<antArtifact identifier=\"complete-js-continued\" type=\"application/vnd.ant.code\" language=\"javascript\" title=\"Complete JavaScript Section (Continued)\">\nfunction sortBy(field) {\n    sortDirection = sortDirection === 'desc' ? 'asc' : 'desc';\n    sortedData.sort((a, b) => {\n        const aVal = a[field] ?? '';\n        const bVal = b[field] ?? '';\n        if (typeof aVal === 'string') {\n            return sortDirection === 'desc' \n                ? bVal.localeCompare(aVal) \n                : aVal.localeCompare(bVal);\n        }\n        return sortDirection === 'desc' \n            ? bVal - aVal \n            : aVal - bVal;\n    });\n    updateTable();\n}\n\n// Event Listeners\ndocument.querySelector('.close').onclick = () => {\n    document.getElementById('detailModal').style.display = 'none';\n};\n\ndocument.getElementById('toggleColumns').onclick = () => {\n    const columnToggle = document.getElementById('columnToggle');\n    columnToggle.style.display = columnToggle.style.display === 'none' ? 'flex' : 'none';\n};\n\ndocument.getElementById('search').addEventListener('input', (e) => {\n    const searchTerm = e.target.value.toLowerCase();\n    sortedData = processedData.filter(org => \n        Object.values(org).some(value => \n            String(value).toLowerCase().includes(searchTerm)\n        )\n    );\n    updateTable();\n});\n\ndocument.getElementById('exportBtn').addEventListener('click', () => {\n    try {\n        const csv = [\n            activeColumns.join(','),\n            ...sortedData.map(org => \n                activeColumns.map(col => {\n                    const value = org[col];\n                    if (typeof value === 'string' && value.includes(',')) {\n                        return `\"${value}\"`;\n                    }\n                    return value ?? '';\n                }).join(',')\n            )\n        ].join('\\n');\n\n        const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });\n        const url = window.URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.setAttribute('hidden', '');\n        a.setAttribute('href', url);\n        a.setAttribute('download', 'partners_data.csv');\n        document.body.appendChild(a);\n        a.click();\n        document.body.removeChild(a);\n        window.URL.revokeObjectURL(url);\n    } catch (error) {\n        console.error('Error exporting CSV:', error);\n        alert('An error occurred while exporting the data. Please try again.');\n    }\n});\n\n// Click outside modal to close\nwindow.onclick = (event) => {\n    const modal = document.getElementById('detailModal');\n    if (event.target === modal) {\n        modal.style.display = 'none';\n    }\n};\n\n// Initialize table when document is ready\ndocument.addEventListener('DOMContentLoaded', () => {\n    initializeTable();\n});\n\nfunction initializeTable() {\n    createColumnToggles();\n    updateTableHeader();\n    sortedData = [...processedData];\n    updateTable();\n    updateMetricCards();\n}\n\n</script>\n</antArtifact>\n\nThis completes the JavaScript code with all the necessary functionality including:\n- Sorting with toggle direction\n- CSV export with proper handling of special characters\n- Modal interactions\n- Search functionality\n- Table initialization\n- Event listeners for all interactive elements\n\nThe code assumes you have the HTML structure and CSS from earlier. Everything should work together to provide a fully functional data table with fixed columns, proper sorting, and all the requested features.",
            "citations": []
          }
        ],
        "updated_at": "2024-12-02T08:58:53.013107Z",
        "attachments": [],
        "files": []
      }
    },
    {
      "id": "47543f7e-4acb-43c8-a8dd-9e234a5b21a7",
      "role": "human",
      "content": "The tool-tip gets clipped at the top\ncan we add the rest of the data inside the rawdata to be viewable?\nand can we make the average score be sortable too? - let's add an up/down arrow so people know you can click to sort",
      "created_at": "2024-12-02T09:03:11.137224Z",
      "sequence_order": 12,
      "metadata": {
        "content": [
          {
            "start_timestamp": null,
            "stop_timestamp": null,
            "flags": null,
            "type": "text",
            "text": "The tool-tip gets clipped at the top\ncan we add the rest of the data inside the rawdata to be viewable?\nand can we make the average score be sortable too? - let's add an up/down arrow so people know you can click to sort",
            "citations": []
          }
        ],
        "updated_at": "2024-12-02T09:03:11.137224Z",
        "attachments": [
          {
            "file_name": "paste.txt",
            "file_size": 13640,
            "file_type": "txt",
            "extracted_content": "\nconst rawData = [\n    {\n        // Base Information\n        \"Organization\": \"Mosul Space\",\n        \"Year of Establishment\": 2014,\n        \"Total # Employees\": 14,\n        \"Average Score\": 4.95,\n        \"Topics Covered\": \"Sustainable Construction, Renewable Energy, Financial Literacy, Entrepreneurship, Technical Skills, Soft Skills, Media, Advocacy\",\n        \"Areas Operating\": \"Ninewa Governorate\",\n        \n        // Detailed Metrics\n        \"Number Full-Time Employees\": 12,\n        \"Number Part-Time Employees\": 2,\n        \"Number of Instagram Followers\": 18800,\n        \"Number of LinkedIn Followers\": 2000,\n        \"Total Followers\": 20800,\n        \"Estimated Number of People Reached Social media\": 1500000,\n        \"Percent Youth\": 95,\n        \"Percent Woman\": 40,\n        \"Percent Marginalized\": 15,\n        \"Num Training Programs(3 years)\": 25,\n        \"Estimated Number Trainees\": 3000,\n        \"Key Staff Years Of Experience\": 11,\n        \"Number of Topics\": 8,\n        \"Number of Areas Operating\": 1,\n\n        // Evaluation Scores\n        \"Organizational Capacity\": 4.67,\n        \"Experience in Similar Projects\": 5.00,\n        \"Alignment with Program Goals\": 5.00,\n        \"Ability to Reach Target Audience\": 5.00,\n        \"Capacity to Deliver Training\": 5.00,\n        \"Willingness & Ability to Collaborate\": 4.95,\n        \n        // Calculated Metrics\n        \"Efficiency\": 1.79, // 25 programs / 14 employees\n        \"Social Media Reach Per Employee\": 107142.86, // 1500000 / 14\n        \"Training Impact Ratio\": 214.29, // 3000 / 14\n        \"Youth Engagement Score\": 665.25 // (95 * 14 * 4.95) / 100\n    },\n    {\n        \"Organization\": \"Makers of Baghdad\",\n        \"Year of Establishment\": 2016,\n        \"Total # Employees\": 22,\n        \"Average Score\": 4.84,\n        \"Topics Covered\": \"Sustainable Construction, Renewable Energy, Financial Literacy, Entrepreneurship, Technical Skills, Soft Skills, Graphic Design\",\n        \"Areas Operating\": \"Baghdad, Anbar, Diwaniya, Babil, Karbala, Najaf\",\n        \n        \"Number Full-Time Employees\": 12,\n        \"Number Part-Time Employees\": 10,\n        \"Number of Instagram Followers\": 55400,\n        \"Number of LinkedIn Followers\": 2000,\n        \"Total Followers\": 57400,\n        \"Estimated Number of People Reached Social media\": 3500000,\n        \"Percent Youth\": 100,\n        \"Percent Woman\": 47,\n        \"Percent Marginalized\": 1,\n        \"Num Training Programs(3 years)\": 204,\n        \"Estimated Number Trainees\": 0,\n        \"Key Staff Years Of Experience\": 6,\n        \"Number of Topics\": 11,\n        \"Number of Areas Operating\": 5,\n\n        \"Organizational Capacity\": 4.67,\n        \"Experience in Similar Projects\": 4.67,\n        \"Alignment with Program Goals\": 5.00,\n        \"Ability to Reach Target Audience\": 5.00,\n        \"Capacity to Deliver Training\": 4.67,\n        \"Willingness & Ability to Collaborate\": 4.84,\n        \n        \"Efficiency\": 9.27, // 204 programs / 22 employees\n        \"Social Media Reach Per Employee\": 159090.91, // 3500000 / 22\n        \"Training Impact Ratio\": 0, // No trainees reported\n        \"Youth Engagement Score\": 1064.80 // (100 * 22 * 4.84) / 100\n    },\n        {\n        \"Organization\": \"Mosul Heritage Foundation\",\n        \"Year of Establishment\": 2022,\n        \"Total # Employees\": 13,\n        \"Average Score\": 4.42,\n        \"Topics Covered\": \"Sustainable Construction, Entrepreneurship, Soft Skills\",\n        \"Areas Operating\": \"Ninewa Governorate\",\n        \n        \"Number Full-Time Employees\": 9,\n        \"Number Part-Time Employees\": 4,\n        \"Number of Instagram Followers\": 22100,\n        \"Number of LinkedIn Followers\": 220,\n        \"Total Followers\": 22320,\n        \"Estimated Number of People Reached Social media\": 2000000,\n        \"Percent Youth\": 40,\n        \"Percent Woman\": 45,\n        \"Percent Marginalized\": 5,\n        \"Num Training Programs(3 years)\": 4,\n        \"Estimated Number Trainees\": 50,\n        \"Key Staff Years Of Experience\": 20,\n        \"Number of Topics\": 3,\n        \"Number of Areas Operating\": 1,\n\n        \"Organizational Capacity\": 4.00,\n        \"Experience in Similar Projects\": 3.67,\n        \"Alignment with Program Goals\": 4.50,\n        \"Ability to Reach Target Audience\": 5.00,\n        \"Capacity to Deliver Training\": 4.67,\n        \"Willingness & Ability to Collaborate\": 4.42,\n        \n        \"Efficiency\": 0.31, // 4 programs / 13 employees\n        \"Social Media Reach Per Employee\": 153846.15,\n        \"Training Impact Ratio\": 3.85,\n        \"Youth Engagement Score\": 229.84\n    },\n    {\n        \"Organization\": \"Qaf Lab\",\n        \"Year of Establishment\": 2019,\n        \"Total # Employees\": 38,\n        \"Average Score\": 4.39,\n        \"Topics Covered\": \"Renewable Energy, Entrepreneurship, Technical Skills, Soft Skills, Media production, AC and HVAC systems\",\n        \"Areas Operating\": \"Ninewa Governorate\",\n        \n        \"Number Full-Time Employees\": 32,\n        \"Number Part-Time Employees\": 6,\n        \"Number of Instagram Followers\": 16800,\n        \"Number of LinkedIn Followers\": 3000,\n        \"Total Followers\": 19800,\n        \"Estimated Number of People Reached Social media\": 700000,\n        \"Percent Youth\": 80,\n        \"Percent Woman\": 30,\n        \"Percent Marginalized\": 20,\n        \"Num Training Programs(3 years)\": 20,\n        \"Estimated Number Trainees\": 200,\n        \"Key Staff Years Of Experience\": 6,\n        \"Number of Topics\": 6,\n        \"Number of Areas Operating\": 1,\n\n        \"Organizational Capacity\": 3.67,\n        \"Experience in Similar Projects\": 4.33,\n        \"Alignment with Program Goals\": 5.00,\n        \"Ability to Reach Target Audience\": 4.33,\n        \"Capacity to Deliver Training\": 4.67,\n        \"Willingness & Ability to Collaborate\": 4.39,\n        \n        \"Efficiency\": 0.53,\n        \"Social Media Reach Per Employee\": 18421.05,\n        \"Training Impact Ratio\": 5.26,\n        \"Youth Engagement Score\": 1334.56\n    },\n    {\n        \"Organization\": \"Kapita\",\n        \"Year of Establishment\": 2019,\n        \"Total # Employees\": 30,\n        \"Average Score\": 4.17,\n        \"Topics Covered\": \"N.A.\",\n        \"Areas Operating\": \"N.A.\",\n        \n        \"Number Full-Time Employees\": 30,\n        \"Number Part-Time Employees\": 0,\n        \"Number of Instagram Followers\": 18000,\n        \"Number of LinkedIn Followers\": 10000,\n        \"Total Followers\": 28000,\n        \"Estimated Number of People Reached Social media\": 28000,\n        \"Percent Youth\": 0,\n        \"Percent Woman\": 0,\n        \"Percent Marginalized\": 0,\n        \"Num Training Programs(3 years)\": 0,\n        \"Estimated Number Trainees\": 500,\n        \"Key Staff Years Of Experience\": 0,\n        \"Number of Topics\": 0,\n        \"Number of Areas Operating\": 0,\n\n        \"Organizational Capacity\": 3.67,\n        \"Experience in Similar Projects\": 4.00,\n        \"Alignment with Program Goals\": 5.00,\n        \"Ability to Reach Target Audience\": 3.67,\n        \"Capacity to Deliver Training\": 4.00,\n        \"Willingness & Ability to Collaborate\": 4.17,\n        \n        \"Efficiency\": 0,\n        \"Social Media Reach Per Employee\": 933.33,\n        \"Training Impact Ratio\": 16.67,\n        \"Youth Engagement Score\": 0\n    },\n    {\n        \"Organization\": \"Iraq Green Building Council\",\n        \"Year of Establishment\": 2021,\n        \"Total # Employees\": 0,\n        \"Average Score\": 4.00,\n        \"Topics Covered\": \"N.A.\",\n        \"Areas Operating\": \"N.A.\",\n        \n        \"Number Full-Time Employees\": 0,\n        \"Number Part-Time Employees\": 0,\n        \"Number of Instagram Followers\": 6900,\n        \"Number of LinkedIn Followers\": 172,\n        \"Total Followers\": 7072,\n        \"Estimated Number of People Reached Social media\": 0,\n        \"Percent Youth\": 0,\n        \"Percent Woman\": 0,\n        \"Percent Marginalized\": 0,\n        \"Num Training Programs(3 years)\": 0,\n        \"Estimated Number Trainees\": 0,\n        \"Key Staff Years Of Experience\": 0,\n        \"Number of Topics\": 0,\n        \"Number of Areas Operating\": 0,\n\n        \"Organizational Capacity\": 4.00,\n        \"Experience in Similar Projects\": 4.00,\n        \"Alignment with Program Goals\": 4.00,\n        \"Ability to Reach Target Audience\": 4.00,\n        \"Capacity to Deliver Training\": 4.00,\n        \"Willingness & Ability to Collaborate\": 4.00,\n        \n        \"Efficiency\": 0,\n        \"Social Media Reach Per Employee\": 0,\n        \"Training Impact Ratio\": 0,\n        \"Youth Engagement Score\": 0\n    },\n    {\n        \"Organization\": \"Rwanga Foundation\",\n        \"Year of Establishment\": 2013,\n        \"Total # Employees\": 0,\n        \"Average Score\": 4.00,\n        \"Topics Covered\": \"N.A.\",\n        \"Areas Operating\": \"N.A.\",\n        \n        \"Number Full-Time Employees\": 0,\n        \"Number Part-Time Employees\": 0,\n        \"Number of Instagram Followers\": 64800,\n        \"Number of LinkedIn Followers\": 15000,\n        \"Total Followers\": 79800,\n        \"Estimated Number of People Reached Social media\": 0,\n        \"Percent Youth\": 0,\n        \"Percent Woman\": 0,\n        \"Percent Marginalized\": 0,\n        \"Num Training Programs(3 years)\": 0,\n        \"Estimated Number Trainees\": 0,\n        \"Key Staff Years Of Experience\": 0,\n        \"Number of Topics\": 0,\n        \"Number of Areas Operating\": 0,\n\n        \"Organizational Capacity\": 4.00,\n        \"Experience in Similar Projects\": 4.00,\n        \"Alignment with Program Goals\": 4.00,\n        \"Ability to Reach Target Audience\": 4.00,\n        \"Capacity to Deliver Training\": 4.00,\n        \"Willingness & Ability to Collaborate\": 4.00,\n        \n        \"Efficiency\": 0,\n        \"Social Media Reach Per Employee\": 0,\n        \"Training Impact Ratio\": 0,\n        \"Youth Engagement Score\": 0\n    },\n    {\n        \"Organization\": \"Suli Innovation House\",\n        \"Year of Establishment\": 2022,\n        \"Total # Employees\": 9,\n        \"Average Score\": 3.67,\n        \"Topics Covered\": \"Renewable Energy, Entrepreneurship, Technical Skills, Soft Skills\",\n        \"Areas Operating\": \"Sulaymaniyah\",\n        \n        \"Number Full-Time Employees\": 6,\n        \"Number Part-Time Employees\": 3,\n        \"Number of Instagram Followers\": 9846,\n        \"Number of LinkedIn Followers\": 3421,\n        \"Total Followers\": 13267,\n        \"Estimated Number of People Reached Social media\": 400000,\n        \"Percent Youth\": 99,\n        \"Percent Woman\": 49,\n        \"Percent Marginalized\": 10,\n        \"Num Training Programs(3 years)\": 35,\n        \"Estimated Number Trainees\": 2000,\n        \"Key Staff Years Of Experience\": 10,\n        \"Number of Topics\": 4,\n        \"Number of Areas Operating\": 1,\n\n        \"Organizational Capacity\": 3.67,\n        \"Experience in Similar Projects\": 3.33,\n        \"Alignment with Program Goals\": 3.67,\n        \"Ability to Reach Target Audience\": 3.67,\n        \"Capacity to Deliver Training\": 4.00,\n        \"Willingness & Ability to Collaborate\": 3.67,\n        \n        \"Efficiency\": 3.89,\n        \"Social Media Reach Per Employee\": 44444.44,\n        \"Training Impact Ratio\": 222.22,\n        \"Youth Engagement Score\": 327.03\n    },\n    {\n        \"Organization\": \"The Station\",\n        \"Year of Establishment\": 2018,\n        \"Total # Employees\": 20,\n        \"Average Score\": 3.61,\n        \"Topics Covered\": \"Financial Literacy, Entrepreneurship, Technical Skills, Soft Skills\",\n        \"Areas Operating\": \"Ninewa Governorate, Erbil, Baghdad, Basra\",\n        \n        \"Number Full-Time Employees\": 18,\n        \"Number Part-Time Employees\": 2,\n        \"Number of Instagram Followers\": 111000,\n        \"Number of LinkedIn Followers\": 45000,\n        \"Total Followers\": 156000,\n        \"Estimated Number of People Reached Social media\": 200000,\n        \"Percent Youth\": 50,\n        \"Percent Woman\": 45,\n        \"Percent Marginalized\": 10,\n        \"Num Training Programs(3 years)\": 10,\n        \"Estimated Number Trainees\": 5000,\n        \"Key Staff Years Of Experience\": 0,\n        \"Number of Topics\": 4,\n        \"Number of Areas Operating\": 4,\n\n        \"Organizational Capacity\": 3.67,\n        \"Experience in Similar Projects\": 3.00,\n        \"Alignment with Program Goals\": 3.33,\n        \"Ability to Reach Target Audience\": 4.00,\n        \"Capacity to Deliver Training\": 3.67,\n        \"Willingness & Ability to Collaborate\": 3.61,\n        \n        \"Efficiency\": 0.5,\n        \"Social Media Reach Per Employee\": 10000,\n        \"Training Impact Ratio\": 250,\n        \"Youth Engagement Score\": 361\n    },\n    {\n        \"Organization\": \"51Labs\",\n        \"Year of Establishment\": 2017,\n        \"Total # Employees\": 22,\n        \"Average Score\": 3.50,\n        \"Topics Covered\": \"Financial Literacy, Entrepreneurship, Soft Skills\",\n        \"Areas Operating\": \"Erbil\",\n        \n        \"Number Full-Time Employees\": 20,\n        \"Number Part-Time Employees\": 2,\n        \"Number of Instagram Followers\": 11500,\n        \"Number of LinkedIn Followers\": 10140,\n        \"Total Followers\": 21640,\n        \"Estimated Number of People Reached Social media\": 500,\n        \"Percent Youth\": 70,\n        \"Percent Woman\": 40,\n        \"Percent Marginalized\": 20,\n        \"Num Training Programs(3 years)\": 10,\n        \"Estimated Number Trainees\": 0,\n        \"Key Staff Years Of Experience\": 0,\n        \"Number of Topics\": 3,\n        \"Number of Areas Operating\": 1,\n\n        \"Organizational Capacity\": 3.67,\n        \"Experience in Similar Projects\": 3.33,\n        \"Alignment with Program Goals\": 3.67,\n        \"Ability to Reach Target Audience\": 3.00,\n        \"Capacity to Deliver Training\": 3.67,\n        \"Willingness & Ability to Collaborate\": 3.50,\n        \n        \"Efficiency\": 0.45,\n        \"Social Media Reach Per Employee\": 22.73,\n        \"Training Impact Ratio\": 0,\n        \"Youth Engagement Score\": 539\n    }\n];"
          }
        ],
        "files": [
          {
            "file_name": "paste.txt"
          }
        ]
      }
    },
    {
      "id": "f4015b58-4115-488b-b4bd-920e0f09d0fd",
      "role": "assistant",
      "content": " I'll help with these improvements. Let's update the code:\n\n<antArtifact identifier=\"data-viewer-fixes\" type=\"application/vnd.ant.code\" language=\"css\" title=\"CSS Fixes\">\n/* Modify the tooltip style */\n.tooltip:hover::after {\n    content: attr(title);\n    position: absolute;\n    top: calc(100% + 5px); /* Changed from bottom to top */\n    left: 50%;\n    transform: translateX(-50%);\n    padding: 8px;\n    background: #2d3748;\n    color: white;\n    border-radius: 4px;\n    font-size: 14px;\n    white-space: nowrap;\n    z-index: 20;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n}\n\n/* Add sort indicator styles */\n.sort-header {\n    display: flex;\n    align-items: center;\n    gap: 4px;\n}\n\n.sort-indicator {\n    display: inline-block;\n    margin-left: 4px;\n    opacity: 0.7;\n}\n\n/* Style for the fixed columns when they're sortable */\nth.fixed-column.sortable {\n    cursor: pointer;\n}\n\nth.fixed-column.sortable:hover {\n    background: #4a5568;\n}\n</antArtifact>\n\nNow let's update the table header creation to include sort indicators and make the Average Score sortable:\n\n<antArtifact identifier=\"data-viewer-logic\" type=\"application/vnd.ant.code\" language=\"javascript\" title=\"JavaScript Updates\">\nfunction getSortIndicator() {\n    return `<span class=\"sort-indicator\"></span>`;\n}\n\nfunction updateTableHeader() {\n    const thead = document.querySelector('thead');\n    thead.innerHTML = `\n        <tr>\n            <th class=\"fixed-column tooltip sortable\" onclick=\"sortBy('Organization')\">\n                <div class=\"sort-header\">\n                    Organization${getSortIndicator()}\n                </div>\n            </th>\n            <th class=\"tooltip sortable\" onclick=\"sortBy('Average Score')\">\n                <div class=\"sort-header\">\n                    Average Score${getSortIndicator()}\n                </div>\n            </th>\n            ${activeColumns\n                .filter(col => col !== 'Organization' && col !== 'Average Score')\n                .map(col => `\n                    <th class=\"tooltip sortable\" \n                        onclick=\"sortBy('${col}')\"\n                        ${columnTooltips[col] ? `title=\"${columnTooltips[col]}\"` : ''}>\n                        <div class=\"sort-header\">\n                            ${col}${getSortIndicator()}\n                        </div>\n                    </th>\n                `).join('')}\n            <th>Actions</th>\n        </tr>\n    `;\n}\n\n// Update showDetails to display all data in organized groups\nfunction showDetails(orgName) {\n    const org = processedData.find(o => o.Organization === orgName);\n    const modal = document.getElementById('detailModal');\n    const content = document.getElementById('modalContent');\n    \n    // Group the data for better organization\n    const groups = {\n        'Basic Information': [\n            'Organization', 'Year of Establishment', 'Total # Employees', \n            'Average Score', 'Topics Covered', 'Areas Operating'\n        ],\n        'Employee Details': [\n            'Number Full-Time Employees', 'Number Part-Time Employees',\n            'Key Staff Years Of Experience'\n        ],\n        'Social Media Metrics': [\n            'Number of Instagram Followers', 'Number of LinkedIn Followers',\n            'Total Followers', 'Estimated Number of People Reached Social media'\n        ],\n        'Program Statistics': [\n            'Num Training Programs(3 years)', 'Estimated Number Trainees',\n            'Number of Topics', 'Number of Areas Operating'\n        ],\n        'Demographics': [\n            'Percent Youth', 'Percent Woman', 'Percent Marginalized'\n        ],\n        'Evaluation Scores': [\n            'Organizational Capacity', 'Experience in Similar Projects',\n            'Alignment with Program Goals', 'Ability to Reach Target Audience',\n            'Capacity to Deliver Training', 'Willingness & Ability to Collaborate'\n        ],\n        'Performance Metrics': [\n            'Efficiency', 'Social Media Reach Per Employee', 'Training Impact Ratio'\n        ]\n    };\n    \n    content.innerHTML = `\n        <h2>${org.Organization}</h2>\n        <div style=\"display: grid; gap: 24px;\">\n            ${Object.entries(groups).map(([groupName, fields]) => `\n                <div class=\"detail-group\">\n                    <h3 style=\"color: #2d3748; margin-bottom: 12px; padding-bottom: 8px; border-bottom: 2px solid #e2e8f0;\">\n                        ${groupName}\n                    </h3>\n                    <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px;\">\n                        ${fields.map(field => `\n                            <div style=\"padding: 8px; background: #f7fafc; border-radius: 4px;\">\n                                <strong style=\"color: #4a5568;\">${field}:</strong>\n                                <div style=\"margin-top: 4px;\">${formatCell(org[field])}</div>\n                            </div>\n                        `).join('')}\n                    </div>\n                </div>\n            `).join('')}\n        </div>\n    `;\n    \n    modal.style.display = 'block';\n}\n</antArtifact>\n\nThese changes will:\n1. Fix the tooltip positioning so it appears below the header instead of above\n2. Add sort indicators () to all sortable columns, including Organization and Average Score\n3. Organize the details modal into logical groups with better styling\n4. Make all column headers clearly indicate they're sortable\n5. Improve the visibility of the sort functionality\n\nThe details modal now shows all data in organized groups with improved styling for better readability. Would you like me to make any adjustments to the grouping or styling?",
      "created_at": "2024-12-02T09:03:11.137224Z",
      "sequence_order": 13,
      "metadata": {
        "content": [
          {
            "start_timestamp": null,
            "stop_timestamp": null,
            "flags": null,
            "type": "text",
            "text": " I'll help with these improvements. Let's update the code:\n\n<antArtifact identifier=\"data-viewer-fixes\" type=\"application/vnd.ant.code\" language=\"css\" title=\"CSS Fixes\">\n/* Modify the tooltip style */\n.tooltip:hover::after {\n    content: attr(title);\n    position: absolute;\n    top: calc(100% + 5px); /* Changed from bottom to top */\n    left: 50%;\n    transform: translateX(-50%);\n    padding: 8px;\n    background: #2d3748;\n    color: white;\n    border-radius: 4px;\n    font-size: 14px;\n    white-space: nowrap;\n    z-index: 20;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n}\n\n/* Add sort indicator styles */\n.sort-header {\n    display: flex;\n    align-items: center;\n    gap: 4px;\n}\n\n.sort-indicator {\n    display: inline-block;\n    margin-left: 4px;\n    opacity: 0.7;\n}\n\n/* Style for the fixed columns when they're sortable */\nth.fixed-column.sortable {\n    cursor: pointer;\n}\n\nth.fixed-column.sortable:hover {\n    background: #4a5568;\n}\n</antArtifact>\n\nNow let's update the table header creation to include sort indicators and make the Average Score sortable:\n\n<antArtifact identifier=\"data-viewer-logic\" type=\"application/vnd.ant.code\" language=\"javascript\" title=\"JavaScript Updates\">\nfunction getSortIndicator() {\n    return `<span class=\"sort-indicator\"></span>`;\n}\n\nfunction updateTableHeader() {\n    const thead = document.querySelector('thead');\n    thead.innerHTML = `\n        <tr>\n            <th class=\"fixed-column tooltip sortable\" onclick=\"sortBy('Organization')\">\n                <div class=\"sort-header\">\n                    Organization${getSortIndicator()}\n                </div>\n            </th>\n            <th class=\"tooltip sortable\" onclick=\"sortBy('Average Score')\">\n                <div class=\"sort-header\">\n                    Average Score${getSortIndicator()}\n                </div>\n            </th>\n            ${activeColumns\n                .filter(col => col !== 'Organization' && col !== 'Average Score')\n                .map(col => `\n                    <th class=\"tooltip sortable\" \n                        onclick=\"sortBy('${col}')\"\n                        ${columnTooltips[col] ? `title=\"${columnTooltips[col]}\"` : ''}>\n                        <div class=\"sort-header\">\n                            ${col}${getSortIndicator()}\n                        </div>\n                    </th>\n                `).join('')}\n            <th>Actions</th>\n        </tr>\n    `;\n}\n\n// Update showDetails to display all data in organized groups\nfunction showDetails(orgName) {\n    const org = processedData.find(o => o.Organization === orgName);\n    const modal = document.getElementById('detailModal');\n    const content = document.getElementById('modalContent');\n    \n    // Group the data for better organization\n    const groups = {\n        'Basic Information': [\n            'Organization', 'Year of Establishment', 'Total # Employees', \n            'Average Score', 'Topics Covered', 'Areas Operating'\n        ],\n        'Employee Details': [\n            'Number Full-Time Employees', 'Number Part-Time Employees',\n            'Key Staff Years Of Experience'\n        ],\n        'Social Media Metrics': [\n            'Number of Instagram Followers', 'Number of LinkedIn Followers',\n            'Total Followers', 'Estimated Number of People Reached Social media'\n        ],\n        'Program Statistics': [\n            'Num Training Programs(3 years)', 'Estimated Number Trainees',\n            'Number of Topics', 'Number of Areas Operating'\n        ],\n        'Demographics': [\n            'Percent Youth', 'Percent Woman', 'Percent Marginalized'\n        ],\n        'Evaluation Scores': [\n            'Organizational Capacity', 'Experience in Similar Projects',\n            'Alignment with Program Goals', 'Ability to Reach Target Audience',\n            'Capacity to Deliver Training', 'Willingness & Ability to Collaborate'\n        ],\n        'Performance Metrics': [\n            'Efficiency', 'Social Media Reach Per Employee', 'Training Impact Ratio'\n        ]\n    };\n    \n    content.innerHTML = `\n        <h2>${org.Organization}</h2>\n        <div style=\"display: grid; gap: 24px;\">\n            ${Object.entries(groups).map(([groupName, fields]) => `\n                <div class=\"detail-group\">\n                    <h3 style=\"color: #2d3748; margin-bottom: 12px; padding-bottom: 8px; border-bottom: 2px solid #e2e8f0;\">\n                        ${groupName}\n                    </h3>\n                    <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px;\">\n                        ${fields.map(field => `\n                            <div style=\"padding: 8px; background: #f7fafc; border-radius: 4px;\">\n                                <strong style=\"color: #4a5568;\">${field}:</strong>\n                                <div style=\"margin-top: 4px;\">${formatCell(org[field])}</div>\n                            </div>\n                        `).join('')}\n                    </div>\n                </div>\n            `).join('')}\n        </div>\n    `;\n    \n    modal.style.display = 'block';\n}\n</antArtifact>\n\nThese changes will:\n1. Fix the tooltip positioning so it appears below the header instead of above\n2. Add sort indicators () to all sortable columns, including Organization and Average Score\n3. Organize the details modal into logical groups with better styling\n4. Make all column headers clearly indicate they're sortable\n5. Improve the visibility of the sort functionality\n\nThe details modal now shows all data in organized groups with improved styling for better readability. Would you like me to make any adjustments to the grouping or styling?",
            "citations": []
          }
        ],
        "updated_at": "2024-12-02T09:03:11.137224Z",
        "attachments": [],
        "files": []
      }
    }
  ]
}