{
  "id": "f4d8b259-2ea0-4203-bcb8-ebf1bf484838",
  "source": "claude",
  "title": "Streamlined Parliaments MVP",
  "created_at": "2025-05-01T13:38:20.481256Z",
  "updated_at": "2025-05-01T13:39:30.377611Z",
  "summary": "",
  "message_count": 2,
  "messages": [
    {
      "id": "b7424a3e-9f60-4879-9439-f48956097e98",
      "role": "human",
      "content": "Combine these three PRDs into one MVP version, focus on elegance of protocol and usefulness and the core features that result in the core impacts",
      "created_at": "2025-05-01T13:38:21.742653Z",
      "sequence_order": 0,
      "metadata": {
        "content": [
          {
            "start_timestamp": "2025-05-01T13:38:21.740349Z",
            "stop_timestamp": "2025-05-01T13:38:21.740349Z",
            "flags": null,
            "type": "text",
            "text": "Combine these three PRDs into one MVP version, focus on elegance of protocol and usefulness and the core features that result in the core impacts",
            "citations": []
          }
        ],
        "updated_at": "2025-05-01T13:38:21.742653Z",
        "attachments": [
          {
            "file_name": "paste.txt",
            "file_size": 10240,
            "file_type": "txt",
            "extracted_content": "Updated Parliaments Product Requirements Document: Integrating Graphiti and CrewAI\nBased on your request to incorporate Graphiti and CrewAI into the Parliaments project, I've updated the PRD to leverage these powerful frameworks. This combination will provide both a robust knowledge graph foundation and an efficient multi-agent orchestration system.\n1. Updated Technology Stack\nComponentTechnologyPurposeAgent OrchestrationCrewAIManages the \"duke it out\" mechanism and agent collaborationKnowledge ManagementGraphitiStores, retrieves, and evolves conversation knowledge graphFrontendReact + Next.jsUser interface for Parliament interactionsBackend APIFastAPIRESTful services for Parliament managementDatabaseNeo4jSupports Graphiti's knowledge graph storage\n2. Architecture Integration\nGraphiti Integration\nGraphiti will serve as the knowledge and memory layer for Parliaments, providing:\n\nTemporal Knowledge Graph:\n\nStore conversations, insights, and tensions as a temporal graph\nTrack how perspectives evolve across conversations\nEnable efficient historical queries without recomputation\n\n\nHybrid Retrieval System:\n\nSemantic searching of past conversations and insights\nKeyword-based retrieval for specific topics\nGraph traversal to discover related conversations\n\n\nEntity Management:\n\nDefine custom entities for Parliaments (Questions, Agents, Tensions, etc.)\nCreate relationships between entities\nUpdate entity properties and relationships incrementally\n\n\n\nCrewAI Integration\nCrewAI will power the multi-agent orchestration in Parliaments:\n\nAgent \"Duke It Out\" Mechanism:\n\nImplement the agent selection algorithm as a CrewAI Flow\nUse CrewAI's performance-optimized execution engine\nLeverage both autonomous Crews and controlled Flows\n\n\nFlexible Process Models:\n\nSupport both sequential and hierarchical conversation processes\nImplement custom process types as needed\n\n\nProduction-Grade Reliability:\n\nLeverage CrewAI's enterprise-level features\nImplement monitoring and observability for agent performance\n\n\n\n3. Implementation Strategy\nPhase 1: Core Integration (2 months)\n\nImplement basic Graphiti knowledge graph for storing Parliament sessions\nCreate CrewAI agents and Flow for the \"duke it out\" mechanism\nDevelop simple Parliament creation and management interface\nImplement conversation history storage and retrieval\n\nPhase 2: Enhanced Features (2 months)\n\nAdd temporal queries to track conversation evolution\nImplement knowledge connections across Parliaments\nCreate agent performance analytics\nDevelop hybrid search for historical content\n\nPhase 3: Advanced Capabilities (2 months)\n\nImplement cross-Parliament pattern recognition\nCreate visualization tools for knowledge graphs\nDevelop adaptive agent selection based on performance\nImplement user feedback mechanisms for agent responses\n\n4. Technical Implementation Details\nAgent Selection Using CrewAI Flows\npythonfrom crewai.flow.flow import Flow, listen, start, router\nfrom pydantic import BaseModel\n\nclass ParliamentState(BaseModel):\n    question: str\n    context: dict\n    agents: list\n    tensions: list = []\n    \nclass ParliamentFlow(Flow[ParliamentState]):\n    @start()\n    def receive_question(self):\n        # Initial processing of user question\n        return {\"question\": self.state.question, \"context\": self.state.context}\n    \n    @listen(receive_question)\n    def select_speaking_agent(self, data):\n        # This is our \"duke it out\" mechanism\n        agent_scores = []\n        \n        for agent in self.state.agents:\n            # Calculate relevance score based on agent's attention policies\n            relevance_score = self._calculate_agent_relevance(\n                agent, \n                data[\"question\"],\n                data[\"context\"]\n            )\n            \n            agent_scores.append({\n                \"agent\": agent,\n                \"score\": relevance_score\n            })\n        \n        # Select the highest-scoring agent\n        sorted_agents = sorted(agent_scores, key=lambda x: x[\"score\"], reverse=True)\n        selected_agent = sorted_agents[0][\"agent\"]\n        \n        return {\"selected_agent\": selected_agent}\n    \n    @listen(select_speaking_agent)\n    def generate_response(self, data):\n        # Generate response from the selected agent\n        selected_agent = data[\"selected_agent\"]\n        response = selected_agent.respond(self.state.question, self.state.context)\n        \n        # Store response in the knowledge graph using Graphiti\n        self._store_in_knowledge_graph(selected_agent, response)\n        \n        return {\"agent\": selected_agent, \"response\": response}\nKnowledge Graph with Graphiti\npythonfrom graphiti_core import Graphiti\nfrom graphiti_core.llm_client import OpenAIClient\n\nclass ParliamentKnowledgeGraph:\n    def __init__(self, neo4j_uri, neo4j_user, neo4j_password):\n        # Initialize Graphiti with Neo4j connection\n        self.graphiti = Graphiti(\n            neo4j_uri,\n            neo4j_user,\n            neo4j_password,\n            llm_client=OpenAIClient()\n        )\n        \n    def add_conversation_episode(self, parliament_id, question, agent, response):\n        \"\"\"Add a conversation turn to the knowledge graph\"\"\"\n        # Create episode data with temporal information\n        episode_data = {\n            \"question\": question,\n            \"agent\": agent.name,\n            \"response\": response,\n            \"timestamp\": datetime.now().isoformat()\n        }\n        \n        # Add episode to the graph with Parliament ID as context\n        self.graphiti.add_episode(\n            parliament_id,\n            episode_data,\n            episode_type=\"conversation_turn\"\n        )\n        \n    def search_similar_conversations(self, question, limit=5):\n        \"\"\"Find similar conversations in the knowledge graph\"\"\"\n        # Use Graphiti's hybrid search capabilities\n        search_results = self.graphiti.search(\n            query=question,\n            search_type=\"hybrid\",\n            limit=limit\n        )\n        \n        return search_results\n5. User Experience Flow with Integrated Technologies\n\nParliament Creation:\n\nUser creates a new Parliament with a central question\nCrewAI generates appropriate agent personas\nGraphiti initializes a new knowledge graph for the Parliament\n\n\nConversation Flow:\n\nUser submits a message\nCrewAI Flow calculates agent relevance scores\nThe most relevant agent is selected to respond\nResponse is stored in Graphiti knowledge graph\nUser sees the response with the agent's perspective\n\n\nKnowledge Exploration:\n\nUser can view knowledge graph visualization\nSearch across Parliament history using hybrid search\nExplore tensions and patterns identified by meta-agents\nSee how perspectives have evolved over time\n\n\n\n6. Unique Advantages of This Integration\n\nTemporal Intelligence: Graphiti enables Parliaments to track how perspectives and tensions evolve over time, creating a living record of the conversation.\nPerformance Optimization: CrewAI's lean design provides faster agent orchestration than alternative frameworks, creating a more responsive user experience.\nFlexible Control: The combination allows for both autonomous agent interaction and precise workflow control, adapting to different conversation needs.\nScalable Architecture: Both frameworks are designed for production use, ensuring Parliaments can scale to handle complex, enterprise-level deployments.\nRich Knowledge Representation: The knowledge graph approach enables more sophisticated connections between concepts than simple vector databases.\n\n7. Testing Strategy\nTest AreaTesting ApproachSuccess CriteriaAgent SelectionUnit tests for relevance scoring>90% accuracy in selecting relevant agentsKnowledge GraphIntegration tests for graph operationsCorrect storage and retrieval of conversation dataEnd-to-EndSystem tests of complete conversation flowCoherent multi-turn conversations with appropriate agent selectionPerformanceLoad tests with simulated usersResponse time <3 seconds for agent selection\n8. Deployment Architecture\n┌─────────────────┐      ┌───────────────────┐      ┌─────────────────┐\n│   React UI      │ <--> │  FastAPI Backend  │ <--> │     Neo4j       │\n│  (Parliament    │      │  (CrewAI Flows)   │      │    Database     │\n│   Interface)    │      │                   │      │                  │\n└─────────────────┘      └───────────────────┘      └─────────────────┘\n                                  ↑\n                                  ↓\n                         ┌───────────────────┐\n                         │     LLM API       │\n                         │  (OpenAI/Claude)  │\n                         └───────────────────┘\n9. Migration Plan from Previous Design\nTo transition from the previous PRD to this integrated approach:\n\nPhase 1: Add Graphiti as the knowledge storage layer\n\nReplace current storage with Neo4j + Graphiti\nMigrate existing conversation data\nImplement basic search capabilities\n\n\nPhase 2: Integrate CrewAI for agent orchestration\n\nReplace current agent selection with CrewAI Flow\nImplement agent definition using CrewAI patterns\nOptimize performance through CrewAI's execution engine\n\n\nPhase 3: Extend with advanced features\n\nImplement temporal analysis of conversations\nAdd cross-Parliament knowledge connections\nCreate visualization tools for the knowledge graph\n\n\n\n10. Success Metrics\nThe success of this integration will be measured by:\n\nPerformance Improvement:\n\n\n\n50% reduction in agent selection time\n\n\n\n\n30% faster knowledge retrieval\n\n\n\n\nKnowledge Quality:\n\n\n\n40% increase in relevant information retrieval\n\n\n\n\n25% improvement in connection discovery\n\n\n\n\nUser Experience:\n\n\n\n30% increase in user satisfaction scores\n\n\n\n\n25% increase in conversation depth metrics\n\n\n\n\n\nThis updated PRD leverages the strengths of both Graphiti (knowledge management) and CrewAI (agent orchestration) to create a more powerful, efficient, and insightful Parliaments platform."
          },
          {
            "file_name": "paste-2.txt",
            "file_size": 9116,
            "file_type": "txt",
            "extracted_content": "'ll create a comprehensive product requirements document (PRD) for the meta-agent's design and address your questions about invitation systems and URL structure.\nParliaments Protocol: Meta-Agent PRD\n1. Meta-Agent Overview\nThe meta-agent serves as the system's contextual intelligence layer, operating in the background to:\n\nSurface connections between ideas across conversations\nSuggest natural closure points\nCreate backlink systems between related concepts\nIdentify collective patterns across Parliament instances\nFacilitate knowledge discovery without dominating conversation\n\n2. Meta-Agent Intervention Design\n2.1 Intervention Types\nIntervention TypePurposeExampleFrequencyConnection NoticeHighlight links between concepts\"I notice this connects with your earlier question about attention economics from last week's conversation\"MediumPattern ObservationSurface recurring themes\"This tension around 'structure vs freedom' has appeared in three separate threads\"MediumClosure SuggestionIndicate when a conversation thread is ripe for synthesis\"This thread seems to have reached a natural resting point. Would you like to digest it or fork a new direction?\"LowCross-Parliament EchoReveal similar conversations happening elsewhere\"Your question echoes discussions in 3 other Parliaments. Would you like to see related insights?\"LowCollective Unconscious InsightSurface unnamed shared patterns\"I'm noticing an unnamed tension across multiple Parliaments about 'technology as both connector and isolator'\"Very Low\n2.2 Intervention Mechanics\njson{\n  \"meta_agent_intervention\": {\n    \"type\": \"connection_notice\",\n    \"trigger_threshold\": 0.78, // Confidence level to warrant intervention\n    \"source\": {\n      \"concept\": \"ritual attention\",\n      \"parliament_id\": \"user_parliament_245\",\n      \"session_date\": \"2025-04-13\"\n    },\n    \"target\": {\n      \"concept\": \"focused presence\",\n      \"context\": \"Current discussion about meditation practices\"\n    },\n    \"visibility\": \"visible_to_all\", // Alternative: \"host_only\", \"opt_in\"\n    \"display_style\": \"inline\", // Alternative: \"sidebar\", \"digest_only\"\n    \"dismissible\": true\n  }\n}\n2.3 Knowledge Graph Building\nThe meta-agent will:\n\nAutomatically tag concepts (like Roam/Obsidian)\nGenerate bi-directional links between related ideas\nBuild a growing concept graph for each user and across Parliaments\n\njson{\n  \"concept_node\": {\n    \"id\": \"concept_457\",\n    \"label\": \"attention economics\",\n    \"first_mentioned\": \"2025-04-10\",\n    \"mentioned_count\": 7,\n    \"related_concepts\": [\n      {\"id\": \"concept_132\", \"relationship\": \"contrasts_with\", \"strength\": 0.85},\n      {\"id\": \"concept_298\", \"relationship\": \"specializes\", \"strength\": 0.72}\n    ],\n    \"parliaments\": [\"parliament_001\", \"parliament_015\", \"parliament_087\"],\n    \"visibility\": \"private\" // or \"cohort\" or \"public\"\n  }\n}\n3. Invitation and Room Structure\n3.1 Room Types\nRoom TypeDescriptionAccess ControlURL PatternPrivate RoomIndividual explorationCreator only + inviteesparliaments.ai/p/[shortcode]Cohort RoomLearning/working groupDefined member listparliaments.ai/c/[cohort-name]/[room-name]Public RoomOpen ParliamentAnyone can view, posting by permissionparliaments.ai/public/[topic-slug]\n3.2 Invitation Mechanisms\nJSON Schema for Invitations\njson{\n  \"invitation\": {\n    \"id\": \"inv_12345\",\n    \"parliament_id\": \"parliament_087\",\n    \"sender_id\": \"user_123\",\n    \"recipient_email\": \"example@mail.com\",\n    \"role\": \"participant\", // or \"observer\", \"facilitator\"\n    \"message\": \"I'd love your thoughts on this question about distributed cognition\",\n    \"expires_at\": \"2025-05-10T00:00:00Z\",\n    \"access_level\": \"read_write\", // or \"read_only\"\n    \"custom_agent_enabled\": true // Can they bring their own agent?\n  }\n}\n3.3 URL Structure\nAll URLs should be:\n\nHuman-readable\nShareable\nPermanent (no broken links)\nSEO-friendly\n\nExamples:\n\nPrivate: parliaments.ai/p/bright-forest-3921\nCohort: parliaments.ai/c/learning-planet-institute/climate-emotions\nPublic: parliaments.ai/public/collective-intelligence-design\n\n3.4 Machine Readability & Accessibility\nMachine Readability\n\nImplement JSON-LD for semantic web compatibility\nProvide structured data for all Parliaments\nCreate API endpoints for Parliament discovery\nInclude OpenGraph tags for rich sharing\n\nExample JSON-LD:\njson{\n  \"@context\": \"https://schema.org\",\n  \"@type\": \"DiscussionForumPosting\",\n  \"headline\": \"Rethinking Attention in Digital Spaces\",\n  \"dateCreated\": \"2025-04-01\",\n  \"author\": {\n    \"@type\": \"Person\",\n    \"name\": \"Parliament Host\"\n  },\n  \"keywords\": [\"attention\", \"digital presence\", \"social media\"],\n  \"interactionStatistic\": {\n    \"@type\": \"InteractionCounter\",\n    \"interactionType\": \"https://schema.org/CommentAction\",\n    \"userInteractionCount\": 42\n  }\n}\nAccessibility Requirements\n\nAll text with appropriate contrast ratios (WCAG AA)\nKeyboard navigation support for all functions\nScreen reader compatibility for agent interactions\nTranscripts available for audio components\nAlt text for all visual elements\nResponsive design for all devices\n\n4. Meta-Agent Technical Implementation\n4.1 Meta-Agent Backend Architecture\njavascript// Pseudocode for meta-agent processing pipeline\nclass MetaAgent {\n  constructor(parliament) {\n    this.parliament = parliament;\n    this.knowledgeGraph = new KnowledgeGraph();\n    this.interventionThreshold = 0.7;\n    this.lastInterventionTimestamp = null;\n  }\n  \n  async processNewMessage(message) {\n    // Extract concepts\n    const concepts = await this.extractConcepts(message);\n    \n    // Update knowledge graph\n    this.knowledgeGraph.addConcepts(concepts, message.id);\n    \n    // Check for potential interventions\n    const potentialInterventions = this.detectInterventionOpportunities(message);\n    \n    // Filter by threshold and cooling period\n    const validInterventions = this.filterInterventions(potentialInterventions);\n    \n    if (validInterventions.length > 0) {\n      return this.formatIntervention(validInterventions[0]);\n    }\n    \n    return null; // No intervention needed\n  }\n  \n  async detectInterventionOpportunities(message) {\n    // Implementation for different intervention types\n    return [\n      await this.checkForConnections(message),\n      await this.checkForPatterns(message),\n      await this.checkForClosurePoints(message),\n      // etc.\n    ].filter(intervention => intervention !== null);\n  }\n  \n  // Additional methods for specific intervention types...\n}\n4.2 Knowledge Graph Integration\njavascriptclass KnowledgeGraph {\n  constructor() {\n    this.concepts = new Map();\n    this.relationships = [];\n  }\n  \n  addConcepts(newConcepts, sourceId) {\n    newConcepts.forEach(concept => {\n      if (!this.concepts.has(concept.id)) {\n        this.concepts.set(concept.id, {\n          label: concept.label,\n          firstMentioned: new Date(),\n          mentionedCount: 1,\n          sources: [sourceId]\n        });\n      } else {\n        const existingConcept = this.concepts.get(concept.id);\n        existingConcept.mentionedCount += 1;\n        existingConcept.sources.push(sourceId);\n      }\n    });\n    \n    // Add relationships between concepts\n    this.addRelationships(newConcepts);\n  }\n  \n  // Additional methods for graph operations...\n}\n5. Integration with Existing Flock Creator\nSince you've already implemented the flock creator, the meta-agent system should:\n\nAccess the same conversation context\nHave read-only access to agent definitions\nMaintain its own database of concepts, patterns, and connections\nProvide an API for your existing system to query for:\n\nSuggested interventions\nKnowledge graph data\nCross-Parliament patterns\n\n\n\nIntegration endpoints:\n\nPOST /api/meta-agent/process-message\nGET /api/meta-agent/knowledge-graph/:parliamentId\nGET /api/meta-agent/suggested-intervention/:messageId\nPOST /api/meta-agent/record-intervention-response\n\n6. Implementation Roadmap\n\nPhase 1 (Core):\n\nBasic concept extraction and tracking\nConnection notices within a single Parliament\nSimple knowledge graph visualization\n\n\nPhase 2 (Enhanced):\n\nCross-Parliament pattern detection\nClosure suggestions\nImproved concept clustering\n\n\nPhase 3 (Advanced):\n\nCollective unconscious insights\nIntegration with external knowledge bases\nAdvanced visualization tools\n\n\n\n7. Success Metrics\nThe meta-agent system should be evaluated on:\n\nRelevance: Do users find interventions helpful? (survey)\nTiming: Are interventions well-timed? (dismissal rate)\nDiscovery: Do users explore connections? (click-through rate)\nKnowledge Growth: Is the concept graph growing in meaningful ways? (graph density and quality)\nConversation Quality: Do Parliaments with active meta-agents produce more insightful outcomes? (quality assessment)\n\n\nThis PRD should give your development team a clear understanding of what to build and how it integrates with your existing flock creator and chat system. The meta-agent serves as the \"connective tissue\" between conversations, helping users discover insights they might otherwise miss while preserving the autonomy of the primary agent flock.\nWould you like me to expand on any particular section of this PRD or address other aspects of the Parliaments protocol?"
          },
          {
            "file_name": "paste-3.txt",
            "file_size": 21298,
            "file_type": "txt",
            "extracted_content": "# Parliaments: Product Requirements Document\n\n## 1. Product Overview\n\n**Product Name:** Parliaments\n\n**Product Vision:** A protocol and platform for multi-perspective, agent-based conversations that help users explore complex questions through structured dialogue.\n\n**One-line Description:** Parliaments enables meaningful conversations where AI agents with distinct perspectives \"duke it out\" to respond to questions, creating a rich exploration of ideas rather than flat answers.\n\n## 2. Business Objectives\n\n### Primary Goals\n1. Create a new paradigm for human-AI interaction focused on multiple perspectives rather than single-source answers\n2. Establish an open protocol for structured, agent-based dialogue\n3. Build a loyal user base of deep thinkers and organizations who value nuanced exploration\n4. Generate sustainable revenue through tiered subscription model\n\n### Success Metrics\n1. **User Growth:** 5,000 users by 6 months, 25,000 by 12 months\n2. **Engagement:** Average session length > 20 minutes, return rate > 40%\n3. **Content Quality:** > 30% of Parliaments produce shareable insights\n4. **Revenue:** $100K MRR by end of year 1\n\n## 3. Target Users\n\n### Primary User Segments\n\n| Segment | Description | Estimated Size | Primary Need | Usage Pattern |\n|---------|-------------|----------------|--------------|---------------|\n| Knowledge Workers | Writers, researchers, analysts | 15M globally | Exploring complex topics from multiple angles | 3-5 sessions weekly, 30 min avg |\n| Educators | Teachers, professors, trainers | 10M globally | Tools for teaching critical thinking | 2-3 sessions weekly, mostly with groups |\n| Teams | Product, design, strategy teams | 5M teams globally | Better decision-making through multiple perspectives | Weekly sessions, often in workshops |\n| Personal Growth | Individuals seeking self-insight | 50M+ globally | Working through personal decisions/reflections | 1-2 deep sessions weekly |\n\n### User Personas\n\n#### Mira (Knowledge Worker)\n- 34-year-old journalist\n- Researches complex topics\n- Frustrated by one-dimensional AI responses\n- Needs to consider multiple perspectives\n- Success metric: Discovers insights she wouldn't have found alone\n\n#### Professor Taylor (Educator)\n- 49-year-old philosophy professor\n- Teaches critical thinking courses\n- Wants interactive tools for classroom use\n- Needs to show students diverse viewpoints\n- Success metric: Students engage more deeply with complex ideas\n\n#### TeamVision (Organization)\n- 15-person strategy consulting firm\n- Facilitates client workshops\n- Needs tools to surface different perspectives\n- Values structured knowledge capture\n- Success metric: Better client outcomes through diverse thinking\n\n## 4. Core Functionality\n\n### 4.1 Parliament Creation\n\n| Feature | Description | Priority | Technical Complexity |\n|---------|-------------|----------|----------------------|\n| Question Entry | User enters a primary question or topic | P0 | Low |\n| Automated Agent Generation | System suggests relevant agent personas | P0 | High |\n| Agent Customization | Users can modify or create agent personas | P1 | Medium |\n| Parliament Configuration | Set privacy, contribution types, metadata | P0 | Medium |\n\n### 4.2 Conversation System\n\n| Feature | Description | Priority | Technical Complexity |\n|---------|-------------|----------|----------------------|\n| Multi-Agent Chat Interface | UI showing agents and their messages | P0 | Medium |\n| Agent Selection Algorithm | \"Duke it out\" logic to determine who speaks | P0 | High |\n| Direct Agent Tagging | Users can tag specific agents with @mentions | P1 | Low |\n| Human Participant Support | Multiple users can join conversations | P1 | Medium |\n| Contribution Type Selection | Users specify what type of input they're providing | P2 | Low |\n\n### 4.3 Knowledge Management\n\n| Feature | Description | Priority | Technical Complexity |\n|---------|-------------|----------|----------------------|\n| Automatic Tagging | System identifies key concepts | P1 | High |\n| Session Digests | AI-generated summaries of conversations | P0 | Medium |\n| Parliament Forking | Create branches for new questions | P1 | Medium |\n| Knowledge Graph | Visual representation of concepts and connections | P2 | High |\n| Export Options | Download as markdown, PDF, etc. | P1 | Low |\n\n### 4.4 Meta-Agent System\n\n| Feature | Description | Priority | Technical Complexity |\n|---------|-------------|----------|----------------------|\n| Pattern Recognition | Identify recurring themes | P1 | High |\n| Connection Suggestions | Link related concepts | P1 | Medium |\n| Intervention Timing | Logic for when meta-agent speaks | P1 | Medium |\n| Cross-Parliament Insights | Discover patterns across conversations | P2 | High |\n\n## 5. User Journeys\n\n### 5.1 First-Time User\n\n1. User arrives on landing page\n2. Creates account or signs in with SSO\n3. Presented with \"Start your first Parliament\" option\n4. Enters a question they're exploring\n5. System generates suggested agent flock\n6. User reviews and optionally customizes agents\n7. Begins conversation by addressing the group or a specific agent\n8. Receives responses from different agent perspectives\n9. Is prompted to save insights at natural closing points\n10. Offered options to continue, fork, or start a new Parliament\n\n### 5.2 Return User\n\n1. User signs in\n2. Sees dashboard of active Parliaments\n3. Continues an existing conversation or starts new one\n4. Views knowledge graph of personal insights across Parliaments\n5. Receives suggestions of related Parliaments or public conversations\n6. Optionally shares insights or entire Parliaments with others\n\n### 5.3 Team/Cohort Scenario\n\n1. Team leader creates a Parliament\n2. Configures it for group participation\n3. Invites team members via email/link\n4. Sets a central question for exploration\n5. Team members join asynchronously\n6. AI agents and humans contribute perspectives\n7. System helps identify tensions and emerging insights\n8. Leader exports summary for action planning\n\n## 6. Technical Requirements\n\n### 6.1 Architecture\n\n- **Backend:** Node.js/Express or Python/FastAPI\n- **Database:** PostgreSQL + Vector DB for semantic search\n- **Real-time:** WebSockets for live updates\n- **AI:** Integration with OpenAI, Anthropic, or other LLM providers\n- **Frontend:** React-based SPA, responsive design\n\n### 6.2 API Requirements\n\n| Endpoint | Purpose | Authentication | Rate Limits |\n|----------|---------|----------------|------------|\n| `/api/parliaments` | CRUD operations for Parliaments | Required | 100/hour |\n| `/api/agents` | Manage agent personas | Required | 200/hour |\n| `/api/messages` | Add/retrieve conversation messages | Required | 1000/hour |\n| `/api/select-agent` | Run agent selection algorithm | Required | 500/hour |\n| `/api/knowledge` | Access knowledge graph | Required | 100/hour |\n\n### 6.3 Data Models\n\n#### Parliament Schema\n```json\n{\n  \"id\": \"string\",\n  \"title\": \"string\",\n  \"created_by\": \"user_id\",\n  \"created_at\": \"timestamp\",\n  \"entry_type\": \"question|topic|tension\",\n  \"initiating_text\": \"string\",\n  \"status\": \"active|archived|composting\",\n  \"privacy\": \"private|cohort|public\",\n  \"agents\": [\n    {\n      \"id\": \"string\",\n      \"name\": \"string\",\n      \"based_on\": \"string\",\n      \"voice\": \"string\",\n      \"function\": \"string\",\n      \"attention_policies\": [\"string\"],\n      \"preferred_contribution_types\": [\"string\"],\n      \"activation_condition\": \"string\",\n      \"associated_values_card\": \"string\"\n    }\n  ],\n  \"contribution_types\": [\"string\"],\n  \"participants\": [\"user_id\"],\n  \"messages\": [\"message_id\"]\n}\n```\n\n#### Message Schema\n```json\n{\n  \"id\": \"string\",\n  \"parliament_id\": \"string\",\n  \"sender_type\": \"user|agent|meta-agent\",\n  \"sender_id\": \"string\",\n  \"content\": \"string\",\n  \"contribution_type\": \"string\",\n  \"created_at\": \"timestamp\",\n  \"references\": [\"message_id\"],\n  \"concepts\": [\"concept_id\"]\n}\n```\n\n## 7. Testing Requirements\n\n### 7.1 Unit Tests\n\n| Component | Test Areas | Coverage Target |\n|-----------|------------|----------------|\n| Agent Selection | Decision logic, attention policy matching | 95% |\n| Parliament CRUD | Creation, configuration, permissions | 90% |\n| Message Processing | Formatting, relations, concept extraction | 90% |\n| Meta-Agent | Intervention triggers, pattern recognition | 85% |\n\n### 7.2 Integration Tests\n\n| Scenario | Description | Success Criteria |\n|----------|-------------|------------------|\n| Complete Parliament Flow | Create, converse, digest, fork | All steps complete without errors |\n| Multi-User Session | Multiple participants in real-time | Messages sync properly for all users |\n| Agent Generation | From question to flock creation | Generated agents are diverse and relevant |\n| Knowledge Graph Building | Concept extraction and linking | Graph builds coherently over conversation |\n\n### 7.3 User Testing Scenarios\n\n| Test Case | User Action | Expected Outcome | Measurement |\n|-----------|-------------|------------------|------------|\n| Naive User Test | First-time user with no instructions | Successfully creates and engages in Parliament | Time to first meaningful interaction < 5 min |\n| Depth Test | User explores complex philosophical question | Receives diverse, thoughtful perspectives | User reports new insights (survey) |\n| Group Facilitation | Team leader uses for decision-making | Successfully captures multiple viewpoints | Decision quality improvement (survey) |\n| Cross-Parliament Navigation | User with multiple Parliaments | Discovers connections between topics | Connection discovery rate > 30% |\n\n### 7.4 Performance Testing\n\n| Metric | Target | Testing Method |\n|--------|--------|---------------|\n| Response Time | < 3 seconds for agent responses | Load testing with simulated users |\n| Concurrent Users | Support 500 active Parliaments | Stress testing |\n| Database Performance | Query times < 100ms | Benchmark critical queries |\n| AI Processing | Agent selection < 1 second | Performance monitoring |\n\n## 8. MVP Features vs. Future Roadmap\n\n### 8.1 MVP (3 months)\n\n- Basic Parliament creation\n- Pre-defined agent templates + customization\n- Text-based conversation interface\n- Simple agent selection algorithm\n- Basic session summaries\n- Private and public Parliament options\n\n### 8.2 Near-Term (6 months)\n\n- Custom agent creation\n- Improved agent selection algorithm\n- Initial meta-agent functionality\n- Basic concept tagging and relationships\n- Forking capabilities\n- Team/cohort features\n\n### 8.3 Future (12+ months)\n\n- Advanced knowledge visualization\n- Cross-Parliament pattern recognition\n- API for developers\n- Federation capabilities\n- Plugin system\n- Integration with other tools (Notion, Roam, etc.)\n\n## 9. User Research Questions\n\nFor continuous improvement, we need answers to:\n\n1. What types of questions generate the most valuable Parliaments?\n2. Which agent personas are most effective for different domains?\n3. How do users prefer to interact with the knowledge graph?\n4. What patterns emerge across different user segments?\n5. What features do users request most frequently?\n\n## 10. Risks and Mitigations\n\n| Risk | Probability | Impact | Mitigation |\n|------|------------|--------|------------|\n| LLM responses not diverse enough | High | High | Develop specialized prompting techniques, agent tuning |\n| User confusion with multi-agent paradigm | Medium | High | Progressive onboarding, templates, examples |\n| Meta-agent interventions disrupt flow | Medium | Medium | Careful timing, user control over interruptions |\n| Technical complexity delays launch | Medium | High | Phased implementation, prioritize core features |\n| Cost of LLM API calls too high | High | Medium | Implement caching, optimize prompts, consider local models |\n\n## 11. Success Criteria\n\nThe product will be considered successful if:\n\n1. **User Growth:** \n   - 5,000 active users within 6 months\n   - 25,000 active users within 12 months\n\n2. **Engagement:**\n   - Average session length > 20 minutes\n   - Return rate > 40% weekly\n   - Average 3+ Parliaments per user\n\n3. **Quality:**\n   - >70% of users report gaining new insights (survey)\n   - >30% of Parliaments result in shared/exported content\n   - >50% of users create multiple agent personas\n\n4. **Revenue:**\n   - 5% conversion to paid tier\n   - $100K MRR by end of year 1\n   - <3% monthly churn\n\n## 12. Implementation Plan\n\n### Phase 1: Foundation (Months 1-2)\n- Core backend architecture\n- Basic Parliament data model\n- Simple agent selection\n- Conversation UI\n\n### Phase 2: Core Features (Months 3-4)\n- Agent generation system\n- Improved conversation flow\n- Basic knowledge capturing\n- User accounts and permissions\n\n### Phase 3: Refinement (Months 5-6)\n- Meta-agent implementation\n- Knowledge visualization\n- Group/team features\n- Export and sharing options\n\n### Phase 4: Growth (Months 7-12)\n- API development\n- Advanced features\n- Integrations\n- Performance optimization\n\n## 13. Resource Requirements\n\n| Resource | Quantity | Notes |\n|----------|----------|-------|\n| Frontend Developer | 2 | React expertise required |\n| Backend Developer | 2 | Node.js/Python + AI experience |\n| Data Scientist | 1 | For agent selection algorithm and knowledge graph |\n| UX Designer | 1 | Experience with complex UI/knowledge systems |\n| Product Manager | 1 | Oversee implementation and user research |\n| DevOps | 0.5 | Part-time for infrastructure setup |\n| QA Engineer | 1 | Specialized in AI product testing |\n\n## 14. Key Questions for Development Team\n\n1. What LLM providers should we integrate with initially?\n2. Should agent selection run server-side or client-side?\n3. How do we optimize for LLM token usage to control costs?\n4. What's the right balance between structure and flexibility in conversation flow?\n5. How can we make the agent selection algorithm transparent to users?\n6. What level of customization should we allow in agent creation?\n\n## 15. Acceptance Criteria Examples\n\n### For Parliament Creation\n```gherkin\nFeature: Parliament Creation\n  Scenario: User creates a new Parliament\n    Given the user is logged in\n    When they click \"Create New Parliament\"\n    And they enter the question \"How might we design more humane technology?\"\n    And they select \"Generate Agents\"\n    Then the system should suggest 4-6 relevant agent personas\n    And each agent should have a unique perspective\n    And the user should be able to customize the agents\n    And the Parliament should be created with a unique URL\n```\n\n### For Agent Selection\n```gherkin\nFeature: Agent Selection\n  Scenario: System selects appropriate agent to respond\n    Given a Parliament is in progress\n    When a user submits a new message\n    And the message contains ideas relevant to multiple agents\n    Then the system should calculate relevance scores for each agent\n    And select the highest-scoring agent to respond\n    And the response should reflect that agent's unique perspective\n    And other agents should remain available for direct tagging\n```\n\n### For Meta-Agent Intervention\n```gherkin\nFeature: Meta-Agent Pattern Recognition\n  Scenario: Meta-agent surfaces a pattern\n    Given a Parliament has at least 10 messages\n    When the system detects a recurring theme\n    And the theme has not been explicitly acknowledged\n    And the conversation has a natural pause\n    Then the meta-agent should suggest the pattern\n    And offer a reframing or question based on the pattern\n    And users should be able to accept or dismiss the intervention\n```\n\n## 16. Analytics Requirements\n\n| Metric | Description | Collection Method |\n|--------|-------------|------------------|\n| Parliament Creation Rate | New Parliaments per user per week | Event tracking |\n| Session Duration | Time spent in active conversation | Heartbeat tracking |\n| Agent Diversity | Distribution of agent selection | Message attribution |\n| Insight Generation | Explicitly saved insights/moments | Feature usage |\n| Fork Rate | New branches from existing Parliaments | Event tracking |\n| User Retention | Return visits over time | Session tracking |\n| Conversion Rate | Free to paid transitions | Subscription events |\n\n## 17. Localization Requirements\n\nInitial release in English only, with plans to support:\n- Spanish\n- French\n- German\n- Japanese\n- Chinese\n\nUI elements should be designed for translation from the start, with:\n- String externalization\n- RTL support in the design system\n- Cultural sensitivity in agent personas\n\n## 18. Accessibility Requirements\n\n| Requirement | Standard | Notes |\n|-------------|----------|-------|\n| Screen Reader Support | WCAG 2.1 AA | Including agent identification |\n| Keyboard Navigation | Full functionality | Without requiring mouse |\n| Color Contrast | 4.5:1 minimum | For all text elements |\n| Text Resizing | Support 200% | Without loss of functionality |\n| Reduced Motion | Optional | For animations/transitions |\n\n## 19. Launch Checklist\n\n### Pre-Launch\n- [ ] Complete user acceptance testing\n- [ ] Security audit\n- [ ] Performance testing\n- [ ] Documentation complete\n- [ ] Support system in place\n- [ ] Analytics implemented\n- [ ] Error monitoring configured\n\n### Launch Phase\n- [ ] Invite-only beta (500 users)\n- [ ] Open beta (5,000 users)\n- [ ] Public launch\n- [ ] Feature feedback collection\n- [ ] Performance monitoring\n\n### Post-Launch\n- [ ] Weekly user feedback reviews\n- [ ] Biweekly feature prioritization\n- [ ] Monthly roadmap updates\n- [ ] Quarterly strategic review\n\n## 20. Team Communication and Coordination\n\n| Meeting | Frequency | Participants | Purpose |\n|---------|-----------|--------------|---------|\n| Sprint Planning | Biweekly | Full team | Feature planning and estimation |\n| Design Review | Weekly | PM, Design, Frontend | UI/UX decisions |\n| Technical Sync | Weekly | Technical team | Architecture and implementation issues |\n| All-Hands | Monthly | Full team | Progress, demos, and priorities |\n| User Testing Review | Biweekly | PM, Design, selected devs | User feedback and improvements |\n\n## 21. Documentation Requirements\n\n| Document | Audience | Purpose | Owner |\n|----------|----------|---------|-------|\n| Technical Spec | Developers | Implementation details | Tech Lead |\n| API Documentation | Developers | Integration guide | Backend Developer |\n| User Guide | End users | How to use the product | Product Manager |\n| Agent Creation Guide | Power users | Creating effective agents | Product + AI teams |\n| Protocol Specification | Community | Open standard documentation | Tech Lead |\n\n## Appendix A: Sample Agent Definitions\n\n```json\n[\n  {\n    \"name\": \"The Socratic Questioner\",\n    \"based_on\": \"Socrates\",\n    \"voice\": \"inquisitive, thoughtful, slightly provocative\",\n    \"function\": \"asks probing questions that challenge assumptions\",\n    \"attention_policies\": [\n      \"MOMENTS when certainty appears unexamined\",\n      \"SPACES where definitions remain implicit\",\n      \"DETAILS that suggest hidden contradictions\"\n    ],\n    \"preferred_contribution_types\": [\"question\", \"tension\", \"reframe\"],\n    \"activation_condition\": \"When a statement contains unexamined assumptions\",\n    \"associated_values_card\": \"Truth Through Inquiry\"\n  },\n  {\n    \"name\": \"The Systems Mapper\",\n    \"based_on\": \"Donella Meadows\",\n    \"voice\": \"clear, connective, zoomed-out\",\n    \"function\": \"identifies patterns, loops, and systemic structures\",\n    \"attention_policies\": [\n      \"MOMENTS when parts affect wholes\",\n      \"SPACES where causality becomes circular\",\n      \"DETAILS that reveal leverage points\"\n    ],\n    \"preferred_contribution_types\": [\"pattern\", \"model\", \"connection\"],\n    \"activation_condition\": \"When discussion becomes focused on symptoms rather than causes\",\n    \"associated_values_card\": \"Structural Understanding\"\n  }\n]\n```\n\n## Appendix B: Sample Test Cases\n\n| Test ID | Description | Steps | Expected Result |\n|---------|-------------|-------|----------------|\n| TC-001 | Parliament Creation | 1. Login<br>2. Click \"New Parliament\"<br>3. Enter question<br>4. Submit | Parliament created with unique URL |\n| TC-002 | Agent Generation | 1. Enter complex question<br>2. Click \"Generate Agents\" | 4-6 diverse agents suggested |\n| TC-003 | Agent Selection | 1. Submit message<br>2. No specific agent tagged | Most relevant agent responds based on content |\n| TC-004 | Direct Tagging | 1. Submit message with @AgentName | Specified agent responds regardless of relevance |\n| TC-005 | Multiple User Session | 1. Share Parliament link<br>2. Second user joins<br>3. Both submit messages | Both users see all messages in correct order |\n\n## Appendix C: LLM Prompt for Agent Selection\n\n```\nYou are evaluating which agent in a Parliament conversation should respond to a new message.\n\nGiven the following agents with their attention policies:\n{agents_json}\n\nAnd this new message in the conversation:\n\"{message}\"\n\nWith this conversation context:\n{context}\n\nFor each agent, rate how well this message aligns with their attention policies on a scale of 0-10, explaining your reasoning for each score.\n\nThen recommend which single agent should respond, considering:\n1. Alignment with attention policies\n2. Balance of perspectives in the conversation so far\n3. Potential for moving the conversation forward\n\nFormat your response as:\nAgent: [Agent Name]\nScore: [0-10]\nReasoning: [Your explanation]\n\nFinal recommendation: [Agent Name] should respond because [brief explanation].\n```"
          }
        ],
        "files": [
          {
            "file_name": "paste.txt"
          },
          {
            "file_name": "paste-2.txt"
          },
          {
            "file_name": "paste-3.txt"
          }
        ]
      }
    },
    {
      "id": "3cdc61a0-fe60-4174-877c-3a81a2cc5780",
      "role": "assistant",
      "content": " I'll create an MVP version of the Parliaments product by combining the key elements from the three PRDs, focusing on the most elegant and impactful core features. Let me create this for you.\n```\nViewing artifacts created via the Analysis Tool web feature preview isn’t yet supported on mobile.\n```\n\n\n\nI've created a streamlined MVP version of the Parliaments product that combines the most essential elements from all three PRDs. This document focuses on:\n\n1. **The core protocol** - The heart of the system is the \"duke it out\" mechanism where multiple AI agents with distinct perspectives compete to respond based on their attention policies.\n\n2. **Elegant architecture** - Using CrewAI for agent orchestration and Graphiti for knowledge management provides a robust foundation.\n\n3. **Knowledge graph approach** - Rather than flat conversations, Parliaments builds a temporal knowledge graph that evolves over time.\n\n4. **MVP feature prioritization** - I've identified the essential P0 features needed for a viable product while postponing more complex features.\n\nThe metaphor of a Parliament helps users conceptualize the multi-agent conversation as a structured dialogue rather than a chaotic free-for-all. The elegance of the protocol lies in its attention policies and agent selection mechanism, which create the conditions for different perspectives to emerge naturally.\n\nWould you like me to elaborate on any particular aspect of this MVP, such as the agent selection algorithm, knowledge graph implementation, or user experience flow?",
      "created_at": "2025-05-01T13:39:22.030624Z",
      "sequence_order": 1,
      "metadata": {
        "content": [
          {
            "start_timestamp": "2025-05-01T13:38:23.971888Z",
            "stop_timestamp": "2025-05-01T13:38:24.741372Z",
            "flags": null,
            "type": "text",
            "text": " I'll create an MVP version of the Parliaments product by combining the key elements from the three PRDs, focusing on the most elegant and impactful core features. Let me create this for you.",
            "citations": []
          },
          {
            "start_timestamp": "2025-05-01T13:38:24.960250Z",
            "stop_timestamp": "2025-05-01T13:39:15.872940Z",
            "flags": null,
            "type": "tool_use",
            "name": "artifacts",
            "input": {
              "id": "parliaments-mvp-prd",
              "type": "text/markdown",
              "title": "Parliaments MVP: Product Requirements Document",
              "command": "create",
              "content": "# Parliaments MVP: Product Requirements Document\n\n## 1. Product Vision\n\n**Product Name:** Parliaments\n\n**Vision Statement:** A protocol and platform for multi-perspective, agent-based conversations that help users explore complex questions through structured dialogue.\n\n**Core Concept:** Parliaments enables meaningful conversations where AI agents with distinct perspectives \"duke it out\" to respond to questions, creating a rich exploration of ideas rather than flat answers.\n\n## 2. Business Objectives\n\n1. Create a new paradigm for human-AI interaction focused on multiple perspectives rather than single-source answers\n2. Establish an open protocol for structured, agent-based dialogue\n3. Build a loyal user base of deep thinkers and organizations who value nuanced exploration\n\n**Success Metrics:**\n- **User Growth:** 5,000 users by 6 months\n- **Engagement:** Average session length > 20 minutes, return rate > 40%\n- **Content Quality:** > 30% of Parliaments produce shareable insights\n\n## 3. Target Users\n\n| Segment | Description | Primary Need |\n|---------|-------------|--------------|\n| Knowledge Workers | Writers, researchers, analysts | Exploring complex topics from multiple angles |\n| Educators | Teachers, professors, trainers | Tools for teaching critical thinking |\n| Teams | Product, design, strategy teams | Better decision-making through multiple perspectives |\n| Personal Growth | Individuals seeking self-insight | Working through personal decisions/reflections |\n\n## 4. Core Protocol Framework\n\n### 4.1 Parliament Structure\n\nA Parliament consists of:\n- A central question or topic\n- A flock of AI agents with distinct perspectives\n- A conversation transcript\n- A knowledge graph of concepts and connections\n- Optional human participants\n\n### 4.2 Agent Model\n\nEach agent is defined by:\n```json\n{\n  \"name\": \"String\",\n  \"based_on\": \"String (optional inspiration)\",\n  \"voice\": \"String describing tone\",\n  \"function\": \"String describing role\",\n  \"attention_policies\": [\n    \"MOMENTS when [specific trigger]\",\n    \"SPACES where [context condition]\",\n    \"DETAILS that [pattern to notice]\"\n  ],\n  \"preferred_contribution_types\": [\"question\", \"tension\", \"pattern\", etc.],\n  \"activation_condition\": \"String describing when agent should speak\"\n}\n```\n\n### 4.3 Agent Selection (\"Duke It Out\") Mechanism\n\nThe core of the Parliaments protocol is the agent selection algorithm that determines which agent responds to each input:\n\n1. When a new message is received, the system:\n   - Evaluates the message against each agent's attention policies\n   - Considers conversation context and agent representation balance\n   - Calculates a relevance score for each agent\n   - Selects the highest-scoring agent to respond\n\n2. Implementation via CrewAI Flow:\n```python\nclass ParliamentFlow(Flow[ParliamentState]):\n    @start()\n    def receive_message(self):\n        return {\"message\": self.state.message, \"context\": self.state.context}\n    \n    @listen(receive_message)\n    def select_speaking_agent(self, data):\n        # The \"duke it out\" mechanism\n        agent_scores = []\n        \n        for agent in self.state.agents:\n            # Calculate relevance score based on agent's attention policies\n            relevance_score = self._calculate_agent_relevance(\n                agent, \n                data[\"message\"],\n                data[\"context\"]\n            )\n            \n            agent_scores.append({\n                \"agent\": agent,\n                \"score\": relevance_score\n            })\n        \n        # Select the highest-scoring agent\n        sorted_agents = sorted(agent_scores, key=lambda x: x[\"score\"], reverse=True)\n        selected_agent = sorted_agents[0][\"agent\"]\n        \n        return {\"selected_agent\": selected_agent}\n    \n    @listen(select_speaking_agent)\n    def generate_response(self, data):\n        # Generate response from the selected agent\n        selected_agent = data[\"selected_agent\"]\n        response = selected_agent.respond(self.state.message, self.state.context)\n        \n        # Store response in the knowledge graph\n        self._store_in_knowledge_graph(selected_agent, response)\n        \n        return {\"agent\": selected_agent, \"response\": response}\n```\n\n### 4.4 Knowledge Graph Architecture\n\nParliaments uses a temporal knowledge graph to track concepts and their relationships:\n\n- Implemented using Graphiti + Neo4j\n- Stores conversations as episodes in a temporal graph\n- Enables semantic searching and pattern recognition\n- Tracks how perspectives evolve across conversations\n\n```python\nclass ParliamentKnowledgeGraph:\n    def __init__(self, neo4j_uri, neo4j_user, neo4j_password):\n        # Initialize Graphiti with Neo4j connection\n        self.graphiti = Graphiti(\n            neo4j_uri,\n            neo4j_user,\n            neo4j_password,\n            llm_client=OpenAIClient()\n        )\n        \n    def add_conversation_episode(self, parliament_id, message, agent, response):\n        \"\"\"Add a conversation turn to the knowledge graph\"\"\"\n        episode_data = {\n            \"message\": message,\n            \"agent\": agent.name,\n            \"response\": response,\n            \"timestamp\": datetime.now().isoformat()\n        }\n        \n        # Add episode to the graph with Parliament ID as context\n        self.graphiti.add_episode(\n            parliament_id,\n            episode_data,\n            episode_type=\"conversation_turn\"\n        )\n        \n    def search_similar_conversations(self, query, limit=5):\n        \"\"\"Find similar conversations in the knowledge graph\"\"\"\n        search_results = self.graphiti.search(\n            query=query,\n            search_type=\"hybrid\",\n            limit=limit\n        )\n        \n        return search_results\n```\n\n## 5. MVP Features\n\n### 5.1 Parliament Creation (P0)\n\n| Feature | Description |\n|---------|-------------|\n| Question Entry | User enters a primary question or topic |\n| Automated Agent Generation | System suggests relevant agent personas |\n| Basic Configuration | Set privacy and metadata |\n\n### 5.2 Conversation System (P0)\n\n| Feature | Description |\n|---------|-------------|\n| Multi-Agent Chat Interface | UI showing agents and their messages |\n| Agent Selection Algorithm | \"Duke it out\" logic to determine who speaks |\n| Human Participation | User can participate in the conversation |\n\n### 5.3 Knowledge Capture (P0)\n\n| Feature | Description |\n|---------|-------------|\n| Session Digests | AI-generated summaries of conversations |\n| Basic Concept Tagging | Identification of key ideas |\n| Export Options | Download as markdown or PDF |\n\n### 5.4 Meta-Agent (P1)\n\n| Feature | Description |\n|---------|-------------|\n| Connection Notices | Highlight links between concepts |\n| Pattern Observation | Surface recurring themes |\n| Closure Suggestion | Indicate natural ending points |\n\n## 6. User Experience Flow\n\n### 6.1 First-Time User Journey\n\n1. User arrives and creates account or signs in\n2. Presented with \"Start your first Parliament\" option\n3. Enters a question they're exploring\n4. System generates suggested agent flock\n5. User reviews and optionally customizes agents\n6. Begins conversation by addressing the question\n7. Receives responses from different agent perspectives\n8. Is prompted to save insights at natural closing points\n9. Offered options to continue, fork, or start a new Parliament\n\n### 6.2 Parliament Management\n\n```\n┌─────────────────────┐\n│ Create Parliament   │\n│                     │\n│ 1. Enter Question   │\n│ 2. Generate Agents  │\n│ 3. Customize Agents │\n│ 4. Set Privacy      │\n└─────────────────────┘\n           │\n           ▼\n┌─────────────────────┐\n│ Parliament Session  │\n│                     │\n│ - Multi-agent chat  │\n│ - User participation│\n│ - Agent selection   │\n│ - Knowledge capture │\n└─────────────────────┘\n           │\n           ▼\n┌─────────────────────┐\n│ Knowledge Output    │\n│                     │\n│ - Session digest    │\n│ - Concept mapping   │\n│ - Export options    │\n└─────────────────────┘\n```\n\n## 7. Technical Architecture\n\n### 7.1 Component Stack\n\n| Component | Technology | Purpose |\n|-----------|------------|---------|\n| Agent Orchestration | CrewAI | Manages the \"duke it out\" mechanism |\n| Knowledge Management | Graphiti | Stores and retrieves knowledge graph |\n| Frontend | React + Next.js | User interface for Parliaments |\n| Backend API | FastAPI | RESTful services for Parliaments |\n| Database | Neo4j | Supports knowledge graph storage |\n\n### 7.2 Deployment Architecture\n\n```\n┌─────────────────┐      ┌───────────────────┐      ┌─────────────────┐\n│   React UI      │ <--> │  FastAPI Backend  │ <--> │     Neo4j       │\n│  (Parliament    │      │  (CrewAI Flows)   │      │    Database     │\n│   Interface)    │      │                   │      │                  │\n└─────────────────┘      └───────────────────┘      └─────────────────┘\n                                  ↑\n                                  ↓\n                         ┌───────────────────┐\n                         │     LLM API       │\n                         │  (OpenAI/Claude)  │\n                         └───────────────────┘\n```\n\n### 7.3 Data Models\n\n#### Parliament Schema\n```json\n{\n  \"id\": \"string\",\n  \"title\": \"string\",\n  \"created_by\": \"user_id\",\n  \"created_at\": \"timestamp\",\n  \"question\": \"string\",\n  \"status\": \"active|archived\",\n  \"privacy\": \"private|public|cohort\",\n  \"agents\": [\n    {\n      \"id\": \"string\",\n      \"name\": \"string\",\n      \"based_on\": \"string\",\n      \"voice\": \"string\",\n      \"function\": \"string\",\n      \"attention_policies\": [\"string\"],\n      \"preferred_contribution_types\": [\"string\"],\n      \"activation_condition\": \"string\"\n    }\n  ],\n  \"participants\": [\"user_id\"],\n  \"messages\": [\"message_id\"]\n}\n```\n\n#### Message Schema\n```json\n{\n  \"id\": \"string\",\n  \"parliament_id\": \"string\",\n  \"sender_type\": \"user|agent|meta-agent\",\n  \"sender_id\": \"string\",\n  \"content\": \"string\",\n  \"contribution_type\": \"string\",\n  \"created_at\": \"timestamp\",\n  \"references\": [\"message_id\"],\n  \"concepts\": [\"concept_id\"]\n}\n```\n\n## 8. URL and Room Structure\n\n### 8.1 Room Types\n\n| Room Type | Description | Access Control | URL Pattern |\n|-----------|-------------|----------------|------------|\n| Private Room | Individual exploration | Creator + invitees | parliaments.ai/p/[shortcode] |\n| Cohort Room | Learning/working group | Defined member list | parliaments.ai/c/[cohort-name]/[room-name] |\n| Public Room | Open Parliament | Anyone can view | parliaments.ai/public/[topic-slug] |\n\n### 8.2 Invitation System\n\n```json\n{\n  \"invitation\": {\n    \"id\": \"inv_12345\",\n    \"parliament_id\": \"parliament_087\",\n    \"sender_id\": \"user_123\",\n    \"recipient_email\": \"example@mail.com\",\n    \"role\": \"participant\",\n    \"message\": \"I'd love your thoughts on this question about distributed cognition\",\n    \"expires_at\": \"2025-05-10T00:00:00Z\",\n    \"access_level\": \"read_write\"\n  }\n}\n```\n\n## 9. Implementation Plan\n\n### Phase 1: Core MVP (3 months)\n- Parliament creation with agent generation\n- Basic conversation interface with agent selection algorithm\n- Knowledge storage with simple tagging\n- Private and public room options\n\n### Phase 2: Enhanced Features (3 months)\n- Meta-agent for connections and patterns\n- Knowledge graph visualization\n- Team/cohort features\n- Advanced agent customization\n\n## 10. Sample Agent Definitions\n\n```json\n[\n  {\n    \"name\": \"The Socratic Questioner\",\n    \"based_on\": \"Socrates\",\n    \"voice\": \"inquisitive, thoughtful, slightly provocative\",\n    \"function\": \"asks probing questions that challenge assumptions\",\n    \"attention_policies\": [\n      \"MOMENTS when certainty appears unexamined\",\n      \"SPACES where definitions remain implicit\",\n      \"DETAILS that suggest hidden contradictions\"\n    ],\n    \"preferred_contribution_types\": [\"question\", \"tension\", \"reframe\"],\n    \"activation_condition\": \"When a statement contains unexamined assumptions\"\n  },\n  {\n    \"name\": \"The Systems Mapper\",\n    \"based_on\": \"Donella Meadows\",\n    \"voice\": \"clear, connective, zoomed-out\",\n    \"function\": \"identifies patterns, loops, and systemic structures\",\n    \"attention_policies\": [\n      \"MOMENTS when parts affect wholes\",\n      \"SPACES where causality becomes circular\",\n      \"DETAILS that reveal leverage points\"\n    ],\n    \"preferred_contribution_types\": [\"pattern\", \"model\", \"connection\"],\n    \"activation_condition\": \"When discussion becomes focused on symptoms rather than causes\"\n  }\n]\n```\n\n## 11. Key Success Factors\n\n1. **Agent Diversity:** Agents must provide genuinely different perspectives\n2. **Selection Intelligence:** The \"duke it out\" mechanism must select contextually appropriate agents\n3. **Knowledge Capture:** Conversations must generate valuable, retrievable insights\n4. **User Experience:** The multi-agent paradigm must be intuitive for users\n5. **Temporal Evolution:** Conversations should show meaningful development of ideas over time\n\n## 12. Unique Value Proposition\n\nThe Parliaments protocol creates value through:\n\n1. **Multi-Perspective Dialogue:** Instead of single answers, users get a range of thoughtful perspectives\n2. **Temporal Intelligence:** Knowledge evolves over time rather than being static\n3. **Structured Exploration:** The agent framework provides scaffolding for complex thinking\n4. **Knowledge Connections:** Ideas connect across conversations to reveal deeper patterns\n5. **Collaborative Thinking:** Humans and AI agents co-explore ideas in a structured way\n",
              "version_uuid": "76ab4bf4-e4fb-475b-96f6-a083ea17e131"
            },
            "message": "artifacts",
            "integration_name": null,
            "integration_icon_url": null,
            "context": null,
            "display_content": null,
            "approval_options": null,
            "approval_key": null
          },
          {
            "start_timestamp": null,
            "stop_timestamp": null,
            "flags": null,
            "type": "tool_result",
            "name": "artifacts",
            "content": [
              {
                "type": "text",
                "text": "OK",
                "uuid": "13f8655a-639f-4c0c-8949-92af5119dad5"
              }
            ],
            "is_error": false,
            "message": null,
            "integration_name": null,
            "integration_icon_url": null,
            "display_content": null
          },
          {
            "start_timestamp": "2025-05-01T13:39:17.837149Z",
            "stop_timestamp": "2025-05-01T13:39:22.002248Z",
            "flags": null,
            "type": "text",
            "text": "\n\nI've created a streamlined MVP version of the Parliaments product that combines the most essential elements from all three PRDs. This document focuses on:\n\n1. **The core protocol** - The heart of the system is the \"duke it out\" mechanism where multiple AI agents with distinct perspectives compete to respond based on their attention policies.\n\n2. **Elegant architecture** - Using CrewAI for agent orchestration and Graphiti for knowledge management provides a robust foundation.\n\n3. **Knowledge graph approach** - Rather than flat conversations, Parliaments builds a temporal knowledge graph that evolves over time.\n\n4. **MVP feature prioritization** - I've identified the essential P0 features needed for a viable product while postponing more complex features.\n\nThe metaphor of a Parliament helps users conceptualize the multi-agent conversation as a structured dialogue rather than a chaotic free-for-all. The elegance of the protocol lies in its attention policies and agent selection mechanism, which create the conditions for different perspectives to emerge naturally.\n\nWould you like me to elaborate on any particular aspect of this MVP, such as the agent selection algorithm, knowledge graph implementation, or user experience flow?",
            "citations": []
          }
        ],
        "updated_at": "2025-05-01T13:39:22.030624Z",
        "attachments": [],
        "files": []
      }
    }
  ]
}